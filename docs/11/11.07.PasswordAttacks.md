---
lang: zh-CN
title: Section 11.7 Password Attacks
description: some description
---

As you study this section, answer the following questions:

<ul>
    <li>
     Where would an attacker gather information to guess a user's password?
    </li>
    <li>
     What social engineering technique involves looking through trash?
    </li>
    <li>
     What does password spraying help the attacker avoid?
    </li>
    <li>
     What is the best defense against password cracking attempts?
    </li>
    <li>
     What is a rainbow attack?
    </li>
</ul>

In this section, you will learn to:

<ul>
    <li>
     Crack a password using rainbow tables.
    </li>
    <li>
     Crack a password with John the Ripper.
    </li>
</ul>

The key terms for this section include:

<table class="terms">
   <thead>
    <tr><th class_="firstTableHeader" scope="col" class="fw-bold">
     Term
    </th>
    <th scope="col" class="fw-bold">
     Definition
    </th>
   </tr></thead>
   <tbody>
    <tr>
     <td>
      Social engineering
     </td>
     <td>
      Social engineering uses manipulation of people or situations to gain access to sensitive
          information.
     </td>
    </tr>
    <tr>
     <td>
      Dumpster diving
     </td>
     <td>
      A social engineering attack in which an attacker goes through the trash to find important documents
          or information that has been thrown out.
     </td>
    </tr>
    <tr>
     <td>
      Shoulder surfing
     </td>
     <td>
      A eavesdropping technique where the listener obtains passwords or other confidential information by
          looking over the shoulder of the target.
     </td>
    </tr>
    <tr>
     <td>
      Brute force attack
     </td>
     <td>
      Password attack in which the attacker uses a cracking tool that submits every possible letter,
          number, and symbol combination in a short amount of time.
     </td>
    </tr>
    <tr>
     <td>
      Password spraying
     </td>
     <td>
      Brute force password attack that uses the same password with multiple user accounts instead of
          different passwords for the same account.
     </td>
    </tr>
    <tr>
     <td>
      Dictionary attack
     </td>
     <td>
      Brute force password attack in which the hacker uses a list of words and phrases to try to guess the
          password.
     </td>
    </tr>
    <tr>
     <td>
      Rainbow attack
     </td>
     <td>
      Similar to dictionary attacks, but a rainbow attack uses special tables called rainbow tables that
          have common passwords and the generated hash of each password.
     </td>
    </tr>
   </tbody>
</table>

This section helps you prepare for the following certification exam objectives:

<table class="objectives">
   <thead>
    <tr><th class_="firstTableHeader" scope="col" class="fw-bold">
     Exam
    </th>
    <th scope="col" class="fw-bold">
     Objective
    </th>
   </tr></thead>
   <tbody>
    <tr>
     <td>
      TestOut Security Pro
     </td>
     <td>
      5.0 Audit and Security Assessment
      <p>
       5.2 Assessment Techniques
      </p>
      <ul>
       <li>
        Analyze Password Attacks
       </li>
      </ul>
     </td>
    </tr>
    <tr>
     <td>
      CompTIA Security+ SY0-601
     </td>
     <td>
      1.1 Compare and contrast different types of social engineering techniques.
      <ul>
       <li>
        Dumpster diving
       </li>
       <li>
        Shoulder surfing
       </li>
       <li>
        Impersonation
       </li>
      </ul>
      <p>
       1.2 Given a scenario, analyze potential indicators to determine the type of attack.
      </p>
      <ul>
       <li>
        Password attacks
        <ul>
         <li>
          Spraying
         </li>
         <li>
          Dictionary
         </li>
         <li>
          Brute force
         </li>
         <li>
          Offline
         </li>
         <li>
          Online
         </li>
         <li>
          Rainbow tables
         </li>
         <li>
          Plaintext/unencrypted
         </li>
        </ul>
       </li>
      </ul>
      <p>
       2.8 Summarize the basics of cryptographic concepts.
      </p>
      <ul>
       <li>
        Salting
       </li>
      </ul>
      <p>
       4.1 Given a scenario, use the appropriate tool to assess 
			organizational security.
      </p>
      <ul>
       <li>
        Password crackers
       </li>
      </ul>
     </td>
    </tr>
   </tbody>
</table>

## 11.7.1 Password Attacks

### Password Attacks 00:00-00:27

Passwords are oftentimes the main defense against unauthorized access to a computer system or sensitive data, and attackers have a variety of methods they can use to crack users' passwords. Some of the more common methods are social engineering, brute force attacks, and rainbow attacks. In this lesson, I'll go over how these attacks work and how you can defend against them.

### Social Engineering 00:27-00:42

Social engineering is the art of manipulating the weakest link in network security, which is the human element. A skilled attacker can use social engineering to learn a user's password through password guessing, user manipulation, or shoulder surfing.

### Password Guessing 00:42-02:36

Guessing a user's password can be difficult, but there are techniques that an attacker can use to make this simpler. The first thing an attacker might do is try default logins and common passwords like password123. An attacker might also use social media to gather personal information such as pet names, family, first car, birthday, and more. Then the attacker uses this information to answer security questions and reset the password itself.

An attacker might also try to interact with a user to trick them into revealing their password. For example, they might call the user pretending to be a technician with an urgent problem for which they need the user's password to resolve. Attackers continue to use this method because, surprisingly, it's still very easy.

An attacker might also use social engineering to gain physical access to an office building. Once inside, they look around for login information that users have written down. Unfortunately, many users write their login information on a sticky pad and put it on their monitor or under their mouse pad. This makes it fairly easy for an attacker to find.

Attackers also go dumpster diving to find these notes that might've been inadvertently thrown away. These people aren't above searching through your trash to gain access to your personal information.

Shoulder surfing is a passive technique where the attacker simply watches a user's keystrokes as they type in their password. This requires access to the user, but it can be accomplished with social engineering.

Your best defense against these kinds of password attacks is education. You must be trained on how to handle these situations. You should know emphatically that no one will ever need to ask for your passwords, and that you should never carelessly write your login information down. With proper user training, attackers have to resort to more technical means to crack passwords.

### Brute Force Attacks: 02:36-02:54

A brute force password attack can be a very time-consuming proposition. The attacker attempts to guess passwords by using a cracking tool that submits every possible letter, number, and symbol combination in a short amount of time. These attacks can be carried out online or offline.

### Online Brute Force Attacks 02:54-03:27

An online brute force attack requires the attacker to submit passwords with the same user interface while the target is up and running. If the attacker targets a website, they keep submitting logins to the site interface. If the attacker targets a computer, they submit the logins to the login screen.

The best defense against online brute force attacks is to implement lockout policies. This means that if someone enters an incorrect password multiple times in a short period, the system locks them out for a certain amount of time.

### Offline Brute Force Attacks 03:27-03:44

An offline brute force attack requires the attacker to somehow steal the password file and then run their attacks on it. This potentially gives the attacker unlimited attempts to run their attack, but it's much more difficult to pull off because they have to first get that password file.

### Password Spraying 03:44-04:09

Password spraying is another type of brute force attack that someone can use to get around lockout policies. Instead of attacking one account, the attacker submits a password to multiple user accounts. If none of those work, the attacker submits a different password to multiple accounts. Because there's a delay between submitting passwords on each account, the lockout policy is essentially circumvented.

### Dictionary Attacks 04:09-04:39

A dictionary attack is yet another type of brute force attack. In this attack, the hacker compiles a huge list of words and phrases that can be used to guess the password. Weak and common passwords, such as password123, are extremely vulnerable to dictionary attacks.

Brute force attacks require a lot of time and computing power to be effective. This is why hackers use programs like John the Ripper, hashcat, Medusa, and Cain & Abel to facilitate the process.

### Password Cracking Defense 04:39-05:07

Implementing proper password protocols is your best defense in these scenarios. A strong password should be at least 8 characters, but more is always better. It should also contain upper and lowercase letters, numbers, and symbols. It shouldn't contain common words and phrases. The longer and more complex your password is, the more time and effort it takes to brute-force it. Also, strongly consider using passphrases instead of passwords.

### Rainbow Attacks: 05:07-06:18

When you store a plaintext password, it's encrypted and generates a hash. Rainbow attacks are similar to dictionary attacks, but instead of trying to match up words and phrases, a rainbow attack uses tables that are already filled with word lists and their hashes. Rainbow attacks require less computing power and are much faster than brute force and dictionary attacks.

A rainbow table is a table of passwords and generated hashes. The hacker uses this table to match the password's hash instead of the password itself.

For example, let's say that a user's password is TestOut, and this is the generated hash. In the hacker's rainbow table, the password SecurityPro generates the same hash value. This is a hash collision, and the hacker could gain access to the system by sending the hash value without having the actual password itself.

The biggest drawback to rainbow tables is their size. Since different systems use different hashing algorithms, a table needs to be created for each target system. The necessary character sets also greatly increase the tables' sizes. A single table can range from 30 gigabytes to over 300.

### Salting the Hash 06:18-06:38

The best way to defend against rainbow attacks is to salt your hashes. Salting the hash just means that some random characters are added at the beginning or end of the password, which ends up generating a completely different hash. The login server knows which part of the hash is salted, but anyone who intercepts the hash has no idea.

### Rainbow Attack Programs 06:38-06:49

People use programs like rtgen, winrtgen, and RainbowCrack to create rainbow tables and tools like ophcrack to crack passwords using these tables.

### Summary 06:49-07:26

That'll wrap up this lesson. In this lesson, we looked at different password attacks you might encounter. We first looked at social engineering methods, which target the users themselves. Then we covered brute force and dictionary attacks. These methods are essentially attempts at guessing passwords. Remember that these methods take quite a long time and usually require sophisticated computing power and knowledge to pull off. Finally, we looked at rainbow attacks. These attacks attempt to match password hashes instead of having to guess the actual password.

## 11.7.2 Password Attack Facts

Passwords are quite often the main defense against unauthorized access to computer systems and sensitive data. This makes passwords a prime target for attackers. A variety of attack methods have been developed to retrieve passwords.

This lesson covers the following topics:

<ul>
   <li>
    Social engineering
   </li>
   <li>
    Brute force attacks
   </li>
   <li>
    Rainbow attacks
   </li>
   <li>
    Cracking passwords using rainbow tables
   </li>
</ul>

### Social Engineering

Social engineering is the art of manipulation. In most networks, the weakest link is the human element. Hackers can take advantage of this to gain access to sensitive information, including passwords.

The following table explains some social engineering techniques to be aware of and protect against.

<table>
   <thead>
    <tr><th class_="firstTableHeader" scope="col" class="fw-bold">
     Social Engineering Technique
    </th>
    <th scope="col" class="fw-bold">
     Description
    </th>
   </tr></thead>
   <tbody>
    <tr>
     <td>
      Password guessing
     </td>
     <td>
      Password guessing is usually not a very efficient method to crack a password. An attacker may first attempt to use
          default login information, such as admin/admin or simple passwords like password123.
      <p>
       If these don't work, the attacker can use publicly available information, such as on a target's social media,
          to make the process easier. Information such as the following can be used to guess a password or answer security
          questions and reset a user's password:
      </p>
      <ul>
       <li>
        Birthday
       </li>
       <li>
        First car
       </li>
       <li>
        Family information
        <ul>
         <li>
          Spouse's name
         </li>
         <li>
          Child's name
         </li>
         <li>
          Important dates
         </li>
        </ul>
       </li>
       <li>
        Important locations
       </li>
      </ul>
     </td>
    </tr>
    <tr>
     <td>
      User manipulation
     </td>
     <td>
      A common social engineering technique is user manipulation. This involves the attacker interacting with the user to trick
          the user into revealing the username and password. For example, the attacker may call the target pretending to be from
          tech support with a urgent problem. The attacker asks for the target's login information to remote in to resolve the
          issue.
      <p>
       User manipulation is a very successful technique and is still used quite often. User training is the best prevention
          method.
      </p>
     </td>
    </tr>
    <tr>
     <td>
      Physical access
     </td>
     <td>
      An attacker can use social engineering to gain physical access to an office building. Once inside, the attacker can look
          around for login information that users have written down.
      <p>
       Many users have a tendency to write login information on sticky notes and stick the notes on the monitor or place them
          under the mouse pad.
      </p>
     </td>
    </tr>
    <tr>
     <td>
      Dumpster diving
     </td>
     <td>
      An attacker may dumpster dive (go through the trash) to find important documents or information that has been thrown out.
          Many users will throw out papers without realizing the importance of the information.
      <p>
       Documents should always be shredded to prevent data loss due to dumpster diving.
      </p>
     </td>
    </tr>
    <tr>
     <td>
      Shoulder surfing
     </td>
     <td>
      Shoulder surfing is an eavesdropping technique in which the attacker obtains passwords or other
        confidential information by looking over the shoulder of a user typing a password.
     </td>
    </tr>
   </tbody>
</table>

User education is the best defense against any form of social engineering. Users should be trained that no one will ever ask for their login information and to always be aware of their surroundings.

### Brute Force Attacks

In a brute force attack, the attacker attempts to guess the password by using a cracking tool that submits every possible letter, number, and symbol combination in a short amount of time. A brute force password attack can be a very time-consuming attack.

The following table describes some of the brute force attack methods.

<table>
   <thead>
    <tr><th class_="firstTableHeader" scope="col" class="fw-bold">
     Brute Force Attack Method
    </th>
    <th scope="col" class="fw-bold">
     Description
    </th>
   </tr></thead>
   <tbody>
    <tr>
     <td>
      Online attack
     </td>
     <td>
      An online brute force attack requires the attacker to submit the passwords using the same user login interface while the
          target is up and running. For example:
      <ul>
       <li>
        An attacker targeting a website will submit login attempts to the site interface.
       </li>
       <li>
        An attacker targeting a computer will submit login attempts to the login screen.
       </li>
      </ul>
      <p>
       The best defense against this method is to implement lock out policies. This means if the incorrect password is
          entered multiple times in a short period of time, the account will be locked for a specified amount of time.
      </p>
     </td>
    </tr>
    <tr>
     <td>
      Offline attack
     </td>
     <td>
      Offline attacks require the attacker to somehow steal the password file. The attacker can then run attacks against that
          file with no limitations, such as lock out policies.
      <p>
       This is the ideal method for the attacker, but is more difficult because it requires the attacker to somehow steal the
          password file.
      </p>
     </td>
    </tr>
    <tr>
     <td>
      Password spraying
     </td>
     <td>
      Password spraying is another method that allows the attacker to avoid lock out policies.
      <ul>
       <li>
        Instead of attempting multiple logins using a single user account and different passwords, the attacker will use
            the same password with multiple user accounts.
       </li>
       <li>
        The attacker will continue cycling through the user accounts submitting passwords until a match is found.
       </li>
       <li>
        Because there is a delay between submitting a password on each account, the lock out policy can be avoided.
       </li>
      </ul>
     </td>
    </tr>
    <tr>
     <td>
      Dictionary attack
     </td>
     <td>
      In a dictionary attack, the hacker uses a list of words and phrases to try to guess the password.
      <ul>
       <li>
        Dictionary attacks work well if weak passwords are used.
       </li>
       <li>
        Using longer and uncommon passphrases is the best way to secure data against these attacks
       </li>
      </ul>
     </td>
    </tr>
   </tbody>
</table>

Some common password cracking tools that can be used to carry out brute force attacks are:

<ul>
   <li>
    John the Ripper
   </li>
   <li>
    Hashcat
   </li>
   <li>
    Medusa
   </li>
   <li>
    Cain and Abel
   </li>
</ul>

Implementing proper password protocols is the best defense against password cracking attempts. A strong password should:

<ul>
   <li>
    Be at least 8 characters; more is better.
   </li>
   <li>
    Contain upper and lower case letters.
   </li>
   <li>
    Contain numbers.
   </li>
   <li>
    Contain symbols.
   </li>
   <li>
    Not use common words or phrases.
   </li>
</ul>

A passphrase is the best option to use instead of a password.

### Rainbow Attacks

When a plaintext password is stored, it is encrypted and a hash is generated.

Rainbow attacks are similar to dictionary attacks, but instead of trying to match the words and phrases, a rainbow attack uses special tables called rainbow tables that are already filled with common passwords and their generated hashes. The attacker uses this table to match the hashes instead of the password itself. Rainbow attacks require less computing power and are much faster than brute force attacks.

Storing rainbow tables requires a lot of storage. A single rainbow table can range anywhere from 30GB to over 300GB. The character set (lower and/or upper case letters, numbers, symbols) being used will greatly increase the size. A different rainbow table needs to be generated for each encryption algorithm.

The best defense against rainbow attacks is salting the hashes. Salting the hash means that random characters are added at the beginning or end of the password. This generates a completely different hash. The login server is programmed to identify the part of the hash that is salted, but anyone intercepting the hash will have no idea; so, the hash canâ€™t be decrypted.

### Cracking Passwords Using Rainbow Tables

An encrypted plaintext password stored in a hash file can be cracked using rainbow tables. There are several types of programs that can be used to create and crack these types of passwords, such as:

<ul>
   <li>
    Rtgen
   </li>
   <li>
    Winrtgen
   </li>
   <li>
    RainbowCrack
   </li>
   <li>
    Ophcrack
   </li>
</ul>

As an example, the following table lists a few examples of the commands needed to create and sort a rainbow crack table:

<table>
    <thead>
    <tr>
        <th class_="firstTableHeader" scope="col" class="fw-bold">Command</th>
        <th scope="col" class="fw-bold">Description</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>rtgen</td>
        <td>
        This command generates a rainbow table based on the parameters
        specified by the user.
        <br />
        The parameters are: rtgen
        <b class="fw-bold">
            <i class="fs-italicize">
            hash_algorithm charset plaintext_len_min
            <br />
            plaintext_len_max table_index chain_len chain_num part_index
            </i>
        </b>
        <h2 class="fw-bold">rtgen md5 ascii-32-95 1 7 0 1000 1000 0</h2>
        <ul>
            <li>
            <i class="fs-italicize"> hash_algorithm </i>
            - A hashing algorithm is a mathematical algorithm which can
            convert an input data array of a certain type and arbitrary
            length to an output bit string of a fixed length. A rainbow
            table must be generated for the type of hash algorithm used.
            Although there are many hash algorithms that can be use, some of
            the more common are; ntlm, md5, and sha1.
            </li>
            <li>
            <i class="fs-italicize"> charset </i>
            - A charset specifies all the possible characters for the
            plaintext. Some of the possible charset that can be used
            include:
            <ul>
                <li>Numeric = [0123456789]</li>
                <li>alpha = [ABCDEFGHIJKLMNOPQRSTUVWXYZ]</li>
                <li>
                alpha-numeric = [ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789]
                </li>
                <li>loweralpha = [abcdefghijklmnopqrstuvwxyz]</li>
                <li>
                loweralpha-numeric = [abcdefghijklmnopqrstuvwxyz0123456789]
                </li>
                <li>
                ascii-32-95 = ascii-32-95 = [
                !"#$%&amp;'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_'abcdefghijklmngpqrstuvwxyz{|}~]
                </li>
            </ul>
            </li>
            <li>
            <i class="fs-italicize"> plaintext_len_min </i>
            and
            <i class="fs-italicize"> plaintext_len_max </i>
            - These two values, such as 1 7, specifies length of the
            plaintext.
            </li>
        </ul>
        <blockquote>
            <p>
            The next four parameters are advanced values and are beyond the
            scope of this lesson. Therefore, only a brief explanation is
            given here:
            </p>
        </blockquote>
        <ul>
            <li>
            <i class="fs-italicize"> table_index </i>
            - Specifies the reduction function. Examples are: 0, 1, 2, 3, 4.
            Zero is often used as the default.
            </li>
            <li>
            <i class="fs-italicize"> chain_len </i>
            - This specifies the rainbow chain length.
            </li>
            <li>
            <i class="fs-italicize"> chain_num </i>
            - This specifies the number of rainbow chains to generate.
            </li>
            <li>
            <i class="fs-italicize"> part_index </i>
            - The number of files used to store the rainbow table. If a
            value greater than zero is use, the rainbow table is saved in
            the number of smaller files specified by the value.
            </li>
        </ul>
        <blockquote>
            <h2 class="fw-bold">0 1000 1000 0</h2>
        </blockquote>
        </td>
    </tr>
    <tr>
        <td>rtsort</td>
        <td>
        A rainbow table is an array of rainbow chains. Each rainbow chain
        has a start point and an end point. The rtsort program sorts the
        rainbow chains by end point to make binary search possible. To sort
        a rainbow table, use the following command (the period at the end is
        part of the command):
        <h2 class="fw-bold">rtsort .</h2>
        </td>
    </tr>
    </tbody>
</table>

### rcrack

<table>
   <thead>
    <tr><th class_="firstTableHeader" scope="col" class="fw-bold">
     Command
    </th>
    <th scope="col" class="fw-bold">
     Description
    </th>
   </tr></thead>
   <tbody><tr>
    <td>
     <b class="fw-bold">
      rcrack . -l /root/hashes.txt
     </b>
    </td>
    <td>
     The
     <b class="fw-bold">
      -l
     </b>
     parameter loads the hashes from a file and each hash is shown on its own line. The hash is shown followed by
        the cracked password.
     <p>
      Example output:
      <br>
      plaintext of  590cb9bZaC590/5b9b4b0/152d2321117  P@ssw0rd
      <br>
      plaintext of  400238780e6c41f8f790161e6ed4aafc21  Test_Out@11_Last
      <br>
      plaintext of  89BF04763BF91C9EE2DDBE23D735C73OBDD41FF2  NeverLAnd5
     </p>
    </td>
   </tr>
   <tr>
    <td>
     <b class="fw-bold">
      rcrack . -h
      <i class="fs-italicize">
       hash_value
      </i>
     </b>
    </td>
    <td>
     The
     <b class="fw-bold">
      -h
     </b>
     parameter loads and displays the results for a single hash.
     <h2 class="fw-bold">
      rcrack . -h 590cb9bZaC590/5b9b4b0/152d2321117
     </h2>
    </td>
   </tr>
</tbody></table>

## 11.7.3 Using Rainbow Tables

### Use Rainbow Tables 00:00-00:49

Nearly every computer system that requires password authentication must contain a password database. Because the information in databases is vulnerable to theft, storing passwords in plain text isn't a very good idea. Therefore, passwords are usually stored with a cryptographic hash.

When they want to crack a password, hackers often use rainbow tables to speed up the process. So, what is a rainbow table, exactly? A rainbow table is basically a table of passwords and the computed matching hashes. The advantage of using rainbow tables is that they save computation time compared to typical brute forcing. The disadvantage is that rainbow tables can take up a lot of storage space. Here, we can look at the website called RainbowCrack, and you can see that some of these are quite large, over half a terabyte in size.

### Create a Rainbow Table 00:49-02:28

In this demo, we're going to generate our own rainbow table using the RainbowCrack collection. We're going to use Kail Linux and RainbowCrack, which comes pre-installed.

To open the program, we just type 'rtgen', and it starts. Down here, we have a couple of examples. In the example, the first part is the hashing algorithm. Here, they have MD5. Next, we need to specify the character set. They've specified loweralpha numeric, which is the letters A to Z and numbers 0 to 9. 1 and 7 are the length of the passwords, so they're going to be between one and seven characters long. The rest of this information is some advanced configuration settings that aren't in the scope of what we're covering in this demo. You can find more information about the advanced features on the RainbowCrack website.

I'm going to go ahead and create our table. I'll do that by typing 'rtgen md5' numeric for our character set and 1 through 9 for our password length along with the rest of the parameters. Let's press Enter. When I do that, my rainbow table is created. Now, if I want to see where this was located, I can type in 'cd /usr/share/rainbowcrack' and press Enter. From here, I'll type in 'ls', and you can see my rainbow table file.

I'll clear the screen.

Now we have to sort our rainbow table. To do that, I'll type in 'rtsort .' and press Enter. Each rainbow chain has a start point and an end point. The rtsort program sorts the rainbow chains by end point to make binary searches possible. It's very important that you don't interrupt the sorting process.

All right. That's done, and now we're ready to crack a hash with our new table. I'll clear the screen again.

### Crack a Hash 02:28-03:16

To crack a hash, I'll type in './rcrack .-h'. The dot is to specify our rainbow tables, and the -h is for hash. Now, we need to put in our hash. To do this, I'm going to go to this website, md5 hash generator. I can generate a hash by entering '123' and clicking Generate. I'll copy this hash, minimize this window, go back to my terminal, paste, and press Enter.

My results pop up very quickly. Here, I've found one of one plaintext. It only took a fraction of a second to run. And down here, I have the hash that I typed in. You can see the numbers I used, 123. So, we successfully cracked this hash with our rainbow table.

### Summary 03:16-03:34

That's it for this demo. In this demo, we used the command line version of RainbowCrack to create a rainbow table. Then we sorted the table and used an online hash generator to create a hash that we were able to crack with the rainbow table we created.

## 11.7.5 Crack Passwords

### Crack Passwords 00:00-00:11

All penetration testers and ethical hackers need the ability to crack passwords. In this demo, we're going to cover some ways to crack passwords in Linux and Windows.

### John the Ripper 00:11-01:44

One of the most popular password cracking programs is John the Ripper. It combines a number of password crackers into one package, autodetects password hash types, and includes a customizable cracker. You can run it against many encrypted password formats, including several password hash types commonly found in Linux and Windows. You can also run John the Ripper against access passwords for compressed ZIP files and documents.

John the Ripper is a command line tool. There's also a GUI-based version called Johnny, which uses the underlying features of the command line version. Both are included with Kali Linux. We're going to use the command line version.

First, we need to open up a terminal. Now I want to point out the password file. When we do a dictionary attack, our cracking program needs a wordlist (a list of potential passwords) to refer to. So we need to switch to the folder where that password list is stored. By default, on Kali Linux, the wordlist is located in the /usr/share/john folder. To get there, I need to switch to that directory by typing 'cd /usr/share/john' and press Enter. Now, if I type 'ls', I'll be able to see the contents of this folder. I'm looking for this file, the password.lst file.

Now we're going to go back to the root directory. I can do that by just typing in 'cd'. I like to keep my terminal screen cleared off, so I'll 'clear' the screen.

Next, if I type in 'john', I get a list list some of the different options that I can use with John the Ripper. If you need to know something about a command's syntax, this page might help you out.

### Crack Linux Passwords 01:44-02:31

We're ready to crack our password. You might think that passwords would be stored in a folder called Passwords, but they're not. Linux passwords are kept in the /etc/shadow file. So, to crack the passwords on this system, I just need to type in 'john /etc/shadow' and press Enter. And that only took a few seconds to crack. It says it loaded two different passwords from two different salts. (If you remember, if a hash is salted, that means that there's extra data added to the hashes because there are two identical passwords being used here. Hashes are salted to make passwords unique in the system.)

Down here, we can see that it found the password for the root user.

Depending on your system, this process could take a lot longer. My password just happens to be toward the top of the list in my password.lst file.

### Crack Passwords from a Windows Machine 02:31-02:51

Now we're going to jump over to a Windows system and crack a few passwords from there. We're going to look at dictionary attacks, which use a dictionary file, and brute force attacks, which use every potential combination of letters, numbers, and special characters. And remember, there are many hybrid attacks that mix these techniques in various ways, but we're just covering the basics here.

### Dictionary Attack 02:51-05:48

Let's start with a dictionary attack. We're going to use Cain, a popular program that's also known as Cain and Abel. When you install Cain and Abel, Windows will give you all types of warning messages. You'll have to disable your Windows Firewall and your antivirus software. Your antivirus will most likely recognize Cain and Abel as malicious software and quarantine the files required for it to run.

Once you launch Cain and Abel, you'll see all your password cracking tools. We're going to go to the Cracker tab, up here. We're interested in the LM & NTLM hashes. Next, let's go up here and click on this plus sign to import hashes from our computer. Here, under Add NT Hashes, we can add hashes from our local system. We can also check this box to include password history hashes so that if users are required to change passwords every 30 or 45 days, previous password hashes are included during the import.

You can also import hashes from a text file. So, if you have access to another system, you could potentially collect hashes from that system, dump them into a text file, copy them to a USB device, and then load them here and attempt to crack the passwords. You can also import from a SAM database by checking this, here.

Right now, we're just going to import hashes from our local system. You can see that it just loaded all the local accounts I have on this system. If you see "empty" under NT passwords, that means that there's no password for that account. If that field is blank, that means that a password is assigned to the account.

We're going to use a dictionary attack to see if we can retrieve the password for the Mrs. Worley account. I'm going to right-click on that account, hover over Dictionary Attack, and go to NTLM Hashes. Now I'm going to go up into this white space, right-click, and select Add to list.

Before I started this demo, I downloaded a list of passwords from the internet. This file is a list of ten thousand common passwords. It's estimated that thirty percent of all passwords are included in this list. If you look down here, you can see that it's going to scan for passwords.

If we check this box, here, it will look for the exact password. So, if my password is cat, that's what it's going to look for.

Below that, it will reverse that password--so, instead of c-a-t, it would look for t-a-c.

Double passwords are just a password typed in twice. You can also have it search for all-lowercase passwords, search for all-uppercase passwords, or even have it put in numbers that commonly replace letters in passwords. With all these combinations, we're really going to use a variation of tens of thousands of different passwords.

Let's click on Start. Depending on your computer's processor, memory, and capability, this process can take a very long time. To save time, I actually edited that file and deleted most of the passwords with this scan. You can see that the scan did finish, but it didn't find that password. That's a good thing; it means my password isn't a dictionary word. Since that didn't work, let's exit and try a brute force attack.

### Brute Force Attack 05:48-07:39

We'll right-click on Mrs. Worley's account, hover over Brute-Force Attack, and select NTLM Hashes. Here's a predefined attack. You can see that if I click here, we can add to our options. We only have lowercase letters and numbers. We also have lowercase with numbers and special characters. I have lowercase, uppercase, numbers, and special characters.

I'm going to brute force from one to sixteen characters. This system is a virtual machine with a single processor and not much memory, so it's going to take a long time. Let's click Start and see what happens. Down here, on the left, you can see it's going to take years to cycle through every variation and crack this password. We don't have years and years to wait, so let's stop this process and try something else.

To crack the password faster, we need to customize our attack. I'll get rid of these characters. Let's say I was doing some shoulder surfing and happened to see that Mrs. Worley was typing in a password, and I noticed three things: I saw that she typed 'teache' and that she didn't use any letters from u to z. I also saw that her password wasn't very long. So, we're going to brute force with these letters and use 6 or 7 characters. We also know the first several letters of our password. Of course, you probably wouldn't have all this information. But to save time, I've made these adjustments. I'll go ahead and click Start, and it will attempt to crack this password. You can see it's going to take a few minutes to complete, so I'll pause the demo and let the attack run.

Okay, our scan has completed in just under three minutes. You can see that the password it found was the word "teacher." Of course, knowing the first several letters of the password, like we did here, isn't common. I simplified the attack for time's sake. But it's often possible to gather enough information to brute force a password in a few days or even hours.

### Summary 07:39-08:03

Okay, that's it for this demo. In this demo, we introduced John the Ripper and used it to crack a Linux password. Then we switched over to a Windows system and used Cain and Abel to crack a Windows-based password. You can see how, if users leak a little information or use easy passwords, hacking tools can get you into restricted systems and files in no time.

## 11.7.6 Crack Password Protected Files

### Introduction 00:00-00:33

Password-protected files are extremely common, but they're not 100 percent secure. Some files natively support password protection, like PDFs. Other types of files are easy to store in a password-protected zip archive. Today, we're going to extract the password hash from these kinds of files and use John the Ripper to crack the hash. As a reminder, John the Ripper only works with hashes. It doesn't natively know how to work directly with password-protected files, so we need to extract the hash from the file we're interested in.

### Crack a Zip Password 00:33-02:23

The process of extracting a hash is similar for most files. The toolkit provided with John the Ripper provides many scripts, but some of them aren't included on Kali Linux by default. We can obtain these tools by cloning the project from GitHub, but I've already downloaded the tools we need. Let's extract the hashes from the zip file we're interested in.

I'll open a terminal and go to the Documents directory. I'll list the folder contents to see what we have in there. I have a file called protected.zip. This is the zip file we'll attempt to crack the password on. We also have a wordlist that we'll use called words.txt.

Most tools that exist to help us extract hashes from files follow the standard for file type, in this case, zip followed by the number 2 and the word "john". So, I'll type, 'zip2john'. This makes it easier to remember what command we need. These tools output the hash straight to the screen, so we use the angle bracket to redirect that output to a file. We will finish our command with 'protected.zip > ziphash'.

Now that we have the hash for the zip file, we can crack it with John the Ripper. We need to specify the format of the hash, the file name, and the wordlist we want to facilitate cracking the hash. So, I'll type, 'john - -format=pkzip ziphash - -wordlist=words.txt'. We have the password. It's a variation of the word password. Now, let's extract the zipped file with that password!

I'll do that from the command line by typing 'unzip protected.zip'. It prompts for the password, so I'll type in the password that we just cracked. I get a message that the file is inflating. Let's list the folder contents. Now I see another file called password.pdf.

This is a PDF file that's also password-protected, so whoever set this up was really concerned about this document's security.

### Crack a PDF Password 02:23-03:06

If this PDF's password is just as weak as the first one, we can crack it, too. Let's go ahead and do that now.

Getting the hash from the PDF is pretty much the same process as getting the hash from the zipped file. Let's type `pdf2john password.pdf > pdfhash` and press Enter.

Now let's crack the password, just like we did for the zipped file password, by typing `john - -format=pdf pdfhash - -wordlist=words.txt` and pressing Enter. There's the password! It's the word 'secret". Let's try it to make sure it works.

I'll go to my Documents folder and open the PDF. It prompts me for a password, so I'll type in 'secret', and my file opens up.

### Summary 03:06-03:23

And that's all there is to it. In this demo, we talked about extracting hashes from password-protected files. We extracted hashes from a zip file and then a PDF file. Then we used John the Ripper to crack those hashes.
