---
lang: zh-CN
title: Section 4.2 Windows System Hardening
description: some description
---

As you study this section, answer the following questions:

- What is hardening? How does it benefit security?
- How do you reduce the attack surface of a device?
- Why should you install only software that you need?
- What is a security baseline?
- What is the difference between a hotfix and a patch? Why would you use one instead of the other?

In this section, you will learn to:

- Harden an operating system.
- Manage automatic updates.
- Configure automatic updates.
- Configure Microsoft Defender Firewall.
- Configure Windows Defender with Firewall Advanced Security.

Key terms for this section include the following:

<table class="terms">
   <thead>
    <tr><th class_="firstTableHeader" scope="col" class="fw-bold">
     Term
    </th>
    <th scope="col" class="fw-bold">
     Definition
    </th>
   </tr></thead>
   <tbody>
    <tr>
     <td>
      Hardening
     </td>
     <td>
      The process of securing devices and software by reducing the security exposure and tightening
          security controls.
     </td>
    </tr>
    <tr>
     <td>
      Hotfix
     </td>
     <td>
      A quick fix for a specific software problem.
     </td>
    </tr>
    <tr>
     <td>
      Patch
     </td>
     <td>
      A fix that is more thoroughly tested than a hotfix and designed for a wider deployment.
     </td>
    </tr>
    <tr>
     <td>
      Service pack
     </td>
     <td>
      A collection of patches, hotfixes, and system enhancements that have been tested by the manufacturer
          for wide deployment.
     </td>
    </tr>
   </tbody>
  </table>

This section helps you prepare for the following certification exam objectives:

<table class="objectives">
   <thead>
    <tr><th class_="firstTableHeader" scope="col" class="fw-bold">
     Exam
    </th>
    <th scope="col" class="fw-bold">
     Objective
    </th>
   </tr></thead>
   <tbody>
    <tr>
     <td>
      TestOut Security Pro
     </td>
     <td>
      3.1 Harden Computer Systems
      <blockquote>
       3.1.2 Configure Antivirus Protection
       <br>
       3.1.4 Configure Windows Update
      </blockquote>
     </td>
    </tr>
    <tr>
     <td>
      CompTIA Security+ SY0-601
     </td>
     <td>
      3.2 Given a scenario, implement host or application security solutions.
      <ul>
       <li>
        Endpoint protection
        <ul>
         <li>
          Antivirus
         </li>
         <li>
          Anti-malware
         </li>
         <li>
          Endpoint detection and response (EDR)
         </li>
         <li>
          DLP
         </li>
         <li>
          Next-generation firewall
         </li>
         <li>
          Host intrusion prevention system (HIPS)
         </li>
         <li>
          Host intrusion detection system (HIDS)
         </li>
         <li>
          Host-based firewall
         </li>
        </ul>
       </li>
       <li>
        Boot integrity
        <ul>
         <li>
          Boot security/Unified Extensible Firmware Interface (UEFI)
         </li>
         <li>
          Measured boot
         </li>
         <li>
          Boot attestation
         </li>
        </ul>
       </li>
       <li>
        Hardening
        <ul>
         <li>
          Open ports and services
         </li>
         <li>
          Registry
         </li>
         <li>
          Disk encryption
         </li>
         <li>
          OS
         </li>
         <li>
          Patch management
          <ul>
           <li>
            Third-party updates
           </li>
           <li>
            Auto-update
           </li>
          </ul>
         </li>
        </ul>
       </li>
       <li>
        Self-encrypting drive (SED)/full disk encryption (FDE)
        <ul>
         <li>
          Opal
         </li>
        </ul>
       </li>
       <li>
        Hardware root of trust
       </li>
       <li>
        Trusted Platform Module (TPM)
       </li>
       <li>
        Sandboxing
       </li>
      </ul>
      <p>
       3.3 Given a scenario, implement secure network designs.
      </p>
      <ul>
       <li>
        Monitoring services
       </li>
       <li>
        File integrity monitors
       </li>
      </ul>
     </td>
    </tr>
   </tbody>
  </table>

## 4.2.1 Operating System Hardening

## 4.2.2 Hardening Facts

This lesson covers the following topics:

- Harden the system
- Manage updates

### Harden the System

Hardening is the process of increasing the security of devices and software. You can harden a network and reduce your security exposure by tightening security controls. Improved performance may result from the hardening process, but it is not the primary goal.

The first step should always be to improve the security of the most foundational elements. You can harden specific hardware devices as well as the software running on the device. The following table describes recommendations for hardening systems.

<table>
   <thead>
    <tr><th class_="firstTableHeader" scope="col" class="fw-bold">
     Recommendation
    </th>
    <th scope="col" class="fw-bold">
     Description
    </th>
   </tr></thead>
   <tbody>
    <tr>
     <td>
      Use a Trusted Operating System (TOS)
     </td>
     <td>
      A TOS is an operating system that comes hardened
            and validated to a specific security level as defined in the Common
            Criteria for Information Technology Security Evaluation (CC). Many
            TOSs provide sufficient support for
      <i class="fs-italicize">
       multilevel security
      </i>
      , a
            system in which multiple levels of classified data reside within the
            same system, but users are not permitted to access data at different
            classification levels. Additionally, all personnel must have access
            approval on a need-to-know basis.
     </td>
    </tr>
    <tr>
     <td>
      Control login
     </td>
     <td>
      To control login and access to a system, you can:
      <ul>
       <li>
        Limit privileges, especially administrative privileges.
       </li>
       <li>
        Change default passwords
       </li>
       <li>
        Require complex passwords
       </li>
       <li>
        Require multi-factor authentication
       </li>
       <li>
        Use smart cards, finger print readers, text services, or other
                apps that send verification codes
       </li>
      </ul>
     </td>
    </tr>
    <tr>
     <td>
      Use configuration baselines
     </td>
     <td>
      A
      <i class="fs-italicize">
       configuration baseline
      </i>
      is a set of
            consistent requirements for a workstation or server. A
      <i class="fs-italicize">
       security
              baseline
      </i>
      is a component of the configuration baseline that
            ensures that all workstations and servers comply with the security
            goals of the organization. Use configuration baselines as follows:
      <ul>
       <li>
        Identify common configuration baselines that should be applied
                to all, or a group, of systems.
       </li>
       <li>
        Use security templates to quickly apply security baseline
                settings. A
        <i class="fs-italicize">
         security template
        </i>
        is a saved set of
                configuration values that produce the system configuration as
                specified in the configuration baseline. When you apply the
                security template to a system, the settings within the template
                are applied to the system. Use security templates to:
       </li>
       <ul>
        <li>
         Quickly apply settings to one or more computers.
        </li>
        <li>
         Configure consistent security settings between devices.
        </li>
        <li>
         Quickly restore security settings to the baseline.
        </li>
        <li>
         Compare the actual settings on a device to the settings
                  required by the configuration baseline.
        </li>
       </ul>
      </ul>
      Microsoft operating systems include the following tools for managing
            security templates:
      <ul>
       <li>
        The Security Templates snap-in, which creates and edits
                templates. You can obtain security templates from various
                sources, including the NSA, which has predefined settings it
                believes are appropriate for Windows operating systems.
       </li>
       <li>
        The Security Configuration and Analysis snap-in, which
                compares the existing settings with the template or applies a
                template to a single device..
       </li>
       <li>
        The Group Policy Editor, which imports a template into Group
                Policy and applies the template to multiple computers.
       </li>
      </ul>
     </td>
    </tr>
    <tr>
     <td>
      Manage software
     </td>
     <td>
      Tips for managing software include:
      <ul>
       <li>
        Check that all software has up-to-date licenses. A license
                compliance violation may open your organization to legal actions
                and may cause a vital application to cease its functions.
       </li>
       <li>
        Install security software such as anti-virus, anti-spyware,
                anti-rootkit, and firewall.
       </li>
       <li>
        Install only needed software.
       </li>
       <li>
        Avoid installing freeware or software from untrusted
                publishers.
       </li>
       <li>
        Reduce the attack surface of the device by limiting
                applications and services running on the device and removing
                unnecessary software, features, and non-essential services.
       </li>
       <ul>
        <li>
         Use role separation by installing services on separate
                  physical systems. If a single system is compromised, only the
                  few services on that system will be affected.
        </li>
        <li>
         Remove unnecessary services, protocols, and applications
                  following installation. Unnecessary services are often
                  installed in new systems by default.
        </li>
        <li>
         Determine the dependencies of services you are using before
                  removing existing services. Examples of non-essential services
                  are TFTP, Telnet, and SNMP. DNS, ICMP, and NNTP are generally
                  considered essential protocols and services; however, consider
                  the function of your system before leaving them on the system.
        </li>
       </ul>
      </ul>
     </td>
    </tr>
    <tr>
     <td>
      Use a Standard Operating Environment (SOE)
     </td>
     <td>
      Most organizations maintain a Standard Operating
            Environment which is implemented as a standard disk image or master
            image. This disk image is used when deploying new computers to the
            network. Automation is used when deploying the master image and when
            running configuration scripts, to give the computer a name, to join
            a domain, and during any other customizations.
      <p>
       The use of a master image and automation can reduces security
              risks by ensuring that security standards are consistent
              throughout the network. Master images should be based on a TOS and
              be fully patched.
      </p>
     </td>
    </tr>
   </tbody>
  </table>

### Managing Updates

Keep the operating system and applications at the most current levels by applying updates. The following table describes the three types of updates

<table>
   <thead>
    <tr><th class_="firstTableHeader" scope="col" class="fw-bold">
     Update Type
    </th>
    <th scope="col" class="fw-bold">
     Description
    </th>
   </tr></thead>
   <tbody>
    <tr>
     <td>
      Hotfix
     </td>
     <td>
      A
      <i class="fs-italicize">
       hotfix
      </i>
      is a quick fix for a problem.
            Normally, you install a hotfix only if you have the specific problem
            it is intended to fix. Hotfixes are:
      <ul>
       <li>
        Typically made to address a specific customer situation and
                possibly may not be distributed outside that customer
                organization.
       </li>
       <li>
        Commonly used to address freshly discovered security holes.
       </li>
      </ul>
     </td>
    </tr>
    <tr>
     <td>
      Patch
     </td>
     <td>
      A
      <i class="fs-italicize">
       patch
      </i>
      is also a quick fix, but generally
            more thoroughly tested than a hotfix and designed for a wider
            deployment. Patches:
      <ul>
       <li>
        Include previous hotfixes that the manufacturer has thoroughly
                tested for mass deployment.
       </li>
       <li>
        Include fixes that should be applied to wider audiences, such
                as patching security holes.
       </li>
      </ul>
      <div class="info" data-block="
       The best place to obtain updates is from
              the manufacturer's website.
      "><div class="to-info-box"><div class="to-info-box-body"><span class="to-icon large" aria-hidden="true"><svg aria-hidden="true" focusable="false" data-prefix="fal" data-icon="circle-info" class="svg-inline--fa fa-circle-info " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 32a224 224 0 1 1 0 448 224 224 0 1 1 0-448zm0 480A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM208 352c-8.8 0-16 7.2-16 16s7.2 16 16 16l96 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0 0-112c0-8.8-7.2-16-16-16l-40 0c-8.8 0-16 7.2-16 16s7.2 16 16 16l24 0 0 96-32 0zm48-168a24 24 0 1 0 0-48 24 24 0 1 0 0 48z"></path></svg></span><div class="to-info-box-body-content"><span>
       The best place to obtain updates is from
              the manufacturer's website.
      </span></div></div></div></div>
     </td>
    </tr>
    <tr>
     <td>
      Service pack (SP)
     </td>
     <td>
      A
      <i class="fs-italicize">
       service pack
      </i>
      (SP) is a collection of
            patches, hotfixes, and other system enhancements that have been
            tested by the manufacturer for wide deployment. A service pack
            includes all previously released bug fixes. If you install the
            service pack, you do not need to install individual patches.
            Installing a service pack also includes all previous service packs.
     </td>
    </tr>
   </tbody>
  </table>

You do not necessarily need to install every hotfix, patch, or service pack that is released. For example, if a hotfix applies to a service that you have disabled on your servers, applying that hotfix is not required. Or if a patch applies to browser security and the browser on the server is not used, you don't need to install the patch.

When using a patch, follow the recommendations in the following table:

<table>
   <thead>
    <tr><th class_="firstTableHeader" scope="col" class="fw-bold">
     Recommendation
    </th>
    <th scope="col" class="fw-bold">
     Description
    </th>
   </tr></thead>
   <tbody>
    <tr>
     <td>
      Use patch management activities
     </td>
     <td>
      Patch management activities include:
      <ul>
       <li>
        Determining the patches that are needed on the system.
       </li>
       <li>
        Testing patches in a lab environment to identify the effects
                of applying the fixes.
       </li>
       <li>
        Applying the patches.
       </li>
       <li>
        Auditing for successful application of patches.
       </li>
      </ul>
     </td>
    </tr>
    <tr>
     <td>
      Use patch management software
     </td>
     <td>
      Use patch management software to simplify the
            patch distribution and management process. Windows Software Update
            Services (WSUS) is a patch management tool that allows clients on a
            network to download software updates from a WSUS server internal to
            their organization.
      <ul>
       <li>
        The WSUS server receives a list of available updates from
                Microsoft.
       </li>
       <li>
        On the WSUS server, you identify allowed or required patches
                for your organization.
       </li>
       <li>
        Clients download only approved patches from an internal WSUS
                server or directly from Microsoft.
       </li>
      </ul>
      You can also use Group Policy to distribute and automatically
            install patches. You must use Group Policy to install updates to
            non-Microsoft software that is not supported by WSUS.
     </td>
    </tr>
    <tr>
     <td>
      Test patches
     </td>
     <td>
      Be sure to test patches before applying patches
            within your organization. A common strategy is to:
      <ol>
       <li>
        Apply and test patches in a lab environment.
       </li>
       <li>
        Deploy patches to a set of systems, such as a single
                department.
       </li>
       <li>
        Deploy patches system-wide.
       </li>
      </ol>
     </td>
    </tr>
   </tbody>
  </table>

## 4.2.3 Hardening an Operating System

### Hardening an Operating System 00:00-00:28

Let's take a look at some general strategies for hardening an operating system. Here we are on a domain controller running Windows Server. Let's go to Tools and go to Active Directory Users and Computers. There are a lot of options here for locking things down. The default user is the administrative user, and that's a very well-known account. It's built into the system, so a lot of people understand what it is and what it does.

### Administrator Account 00:28-01:15

One thing you might consider doing is renaming the account in Properties, or you could create a new account for the administrator. Be aware that the Administrator account has many groups assigned to it, such as domain admins. The groups are required for group policy management. By default, a general administrator doesn't have access to group policy management.

For example, we have this account, right here. We can go to Properties, Member Of, and then Add. Type ‘administrators' and hit OK. We've just added this as an administrative user. If this is the only administrator for the system, please be sure to add additional groups such as domain admins. Then you can disable the administrative account and just use this account, which won't be well known to people outside of your system.

### Disabling Administrator 01:15-01:29

If you do disable the administrative account, be aware that it's the original admin account, and it's the only one that you can't lock with account lockout. So be careful about disabling it. You don't want to get locked out of your system or your server.

### Change Passwords 01:29-01:49

You'll also want to change passwords. Windows Server requires you to enter a complex password right after you've installed the operating system. You'll need to change any default account names and passwords and use complex passwords. To change your password, you just right-click on the account and go to Reset Password. That's relatively simple.

### Built-in Groups 01:49-02:10

You'll also notice that there are a lot of built-in groups in Active Directory. This container here, on the left, contains all of the built-in groups that come on your server by default. These groups can help you control what users can access and what they can do. For example, when you add somebody to the Backup Operators group, that user has the power to back up and restore files.

### Group Policies 02:10-02:37

Let's go ahead and go to our Group Policy in Group Policy Manager. Go to Tools, and then we'll go to Group Policy Management. We're going to go to Domain Controllers and the Domain Controller default policy. Right-click. Edit. These are all the Group Policies that affect our domain controller. Over here, under Computer Configuration, we're going to go to Policies > Windows Settings > Security Settings.

### Domain Controller Behavior 02:37-03:30

You can see settings that you've enabled to lock down the domain controller behavior. We're going to take a look under Security Settings. We're going to look at Local Policies, specifically User Rights Management. Under here, on the right-hand side, we're going to go to Back Up Files and Directories, and you can see that right here. This is basically the built-in groups that can back up files and do backups in the directories.

We have administrators, backup operators, and server operators. We can add users to this group if we want to. Let's also go down to Restore Files and Directories. Here are the same groups. They all have that same access. All three of these, administrators, backup operators, and server operators, have the ability to back up and restore files on your system. That's something to be aware of. If I give someone Backup Operator rights, they'll be able to restore and back up any files on the system.

### Security Options 03:30-04:20

On the left side, there are also security options. For security options, we don't care who's logged on. They affect everyone. Scroll down to Interactive Logon. Let's do Interactive Logon. Don't require Ctrl + Alt + Del right here. This option actually reduces your security posture because the malware can take advantage of the fact that the Ctrl + Alt + Del box isn't there.

Having Ctrl + Alt + Del can prevent some malware. If this is enabled, it could open up your system to some problems. But you can only set this across the board for every user. You can't define which user can do this; this setting applies to everyone. In this case, we don't want to do this. We're going to hit Cancel. Notice that it didn't ask us which user or which group to apply this to, since it affects everyone.

### Server Roles 04:20-05:34

Other hardening strategies include installing only required software on the systems. With Windows Server, we have the concept of roles. Here, we're going to go to Manage. This is a little different from older versions of Microsoft Server. Server Manager is quite a bit different as well. Here, we're going to go to Add Roles and Features. We can also see Remove Roles and Features. It has a wizard to get you started.

We'll just click through a few. This is very different from older versions of Windows Server, but you can do role-based or feature-based installation, or Remote Desktop Service installation. We're just going to do role-based. Select the server you want it to be on. I'm going to select my server. You can see the server roles that you can add. If we go on one more, you can see features.

Windows Server only installs binaries for any service that you want to run on the server. This helps reduce the attack surface. You won't have a bunch of programs open by default. You actually have to go in, enable them, and turn them on. One major difference between older servers and newer servers is that the security configuration wizard has been completely removed, so features are secured by default.

### Services 05:34-06:28

You should use Group Policy Manager or Microsoft Security Compliance Manager to control specific security settings. We can also go to our services on Server Manager by selecting Tools and then Services.

It's a good practice to disable or turn off at least the startup behavior of any services that you're not requiring on this particular machine. Microsoft will start up services related to the roles you've installed, but often, there may be extra services that aren't required for the operation of your system. You can go through and look at all the services that are started automatically. For example, there's a service called SSDP that we're going to look at.

SSDP Discovery is a universal plug-and-play type of hardware on your system. It's universal plug-and-play for network devices. At one time, there were some flaws in it, and it's automatically disabled by default. You'll want to be careful not to disable a service that may be critical. Always do your research first.

### Summary 06:28-06:39

That's it for this demo. In this demo, we discussed some strategies you can use to harden your Windows Server operating system.

## 4.2.4 Managing Automatic Updates

### Configure Automatic Updates 00:00-00:33

We're going to talk about managing Windows updates. Windows 10 has significantly changed the way updates are handled. In Windows 8 and prior versions, you had a lot of control over what was installed and what wasn't. But the only way to have complete control over your Windows updates with Windows 10 is to implement Windows Server Update Services, or WSUS. WSUS servers are normally set up in a Windows domain environment; they're not typically seen on a home network.

### Update and Security 00:33-00:44

In Windows 10, the only way to get to your Windows Updates is to go to Start, go to Settings, and go to Update and Security.

### Default Behavior 00:44-01:22

Updates are automatically enabled and set to auto-download by default. You don't have the choice to select individual updates like in previous versions of Windows. Here, you should see the list of Windows updates currently ready for install. If there isn't a list of updates to download or install, it'll say it's up to date.

Let's click Install for the current pending updates. Now that the installation is complete, we have the ability to schedule when the restart happens. Since we won't be on this PC around 10:00 p.m., I'll select that time for a scheduled restart.

### Update Options 01:22-02:21

There are many options you should be aware of when using Windows update. The first option we're going to cover is to pause updates. You can pause any Windows updates from happening for a certain period, which you can set in the advanced options. Pay attention to the Change active hours option. This tells Windows not to not restart during your active hours. You can adjust the hours manually, or there's an option to auto-adjust active hours based on your activity.

View update history will show you some updates that are already installed. To view all updates or uninstall an update individually, you need to click Uninstall updates. Advanced options lets you configure a lot of things, such as receive updates for other Microsoft products, restarting device as soon as possible, showing a notification when your PC requires a restart to finish updating, and pausing the updates date selection.

### Metered Connections 02:21-02:53

This also lets you know that updates won't download over a metered connection. What does that mean? Well, let's say you're tethered to your cell phone network or you're using data. Or maybe you're a little old-school, and you have some form of a dial-up connection. All of these are metered connections—"you pay for the amount you use. You can label that Wi-Fi connection a metered connection in Windows 10. Then your Windows updates won't update anything while you're connected to those metered connections, and you save money.

### Peer-To-Peer 02:53-03:46

Windows 10 can use a peer-to-peer type connection to other devices on the network or the internet in order to download Windows updates. This could be useful if you have multiple computers on a metered network.

So, if you're on a network and some other Windows 10 computer has an update that you haven't installed yet, instead of going to Microsoft first, it'll go looking on the network for other machines that have sharing enabled and that have already received that update. Then it'll download the update from those other machines. This can be a little concerning, especially if you're a security administrator, because that means sharing is automatically enabled on those machines. As an administrator, I would turn this feature off, especially for external networks. It could contribute to some form of malicious attack if you're not careful. But on my local network, I wouldn't worry too much about it.

### Other Microsoft Products 03:46-04:20

There's another option to get updates for other Microsoft products when you update Windows. One important thing to know is that most of your updates go through Windows Update, but some applications for Windows 10 update through the Microsoft Store and not through Windows Update. In order to do so, you must launch the Microsoft store, click on the ellipsis, and select Downloads and Updates. This will give you the option to get updates if there are any available updates for the installed Microsoft store apps.

### Recovery Tools 04:20-04:52

Anyway, if we go back, I also want to show you some recovery tools that are available. Reset your PC gives you the option to reinstall Windows while keeping your personal data. Go back to the previous version of Windows 10 will roll back one build version. This helps if you're experiencing problems with the current build. But first, it'll prompt you to apply the latest available updates before rolling back. We won't cover the rest of the recovery options today.

### Summary 04:52-05:16

And that's it for this demo. We went over Windows update tools and discussed some changes from prior versions of Windows. We talked about updates on metered connections. We talked about how Windows gets updates from different sources through a peer-to-peer sharing method and how the restore function can be useful when you're troubleshooting Windows updates.

## 4.2.6 Configuring Microsoft Defender Firewall

### Configuring Windows Firewall 00:00-00:32

In this demonstration, we're going look at how to configure the Windows host-based firewall that comes with all current versions of Windows. A firewall is like a gatekeeper. Its job is to decide what network traffic to allow in and out of a system. Remember, a host-based firewall determines the traffic allowed in and out of a specific host. In this case, we're using a Windows workstation. A network firewall establishes rules for traffic on a network segment.

### Configure Firewall 00:32-01:24

To configure the host-based firewall on this Windows station, we're going to open up Control Panel. We could use the Settings app, but it eventually takes us to the Control Panel, so we'll just go straight there.

We're going to go to Windows Defender Firewall. First, let's make sure the firewall is running. Here, we can see we have one network connected to this workstation. It's a home or work private network. In prior versions, Windows used to let you label something as a home or work network. But in this case, it just labels it Private or Guest. This is a private network, and it's currently connected.

The green icon on the left indicates that the Windows Defender Firewall is on. When we click on Turn Windows Defender Firewall on or off, we have options to turn the Windows Defender Firewall on or off for both the public and private networks.

### Firewall Configuration Settings 01:24-03:20

The default firewall configuration for home or work private networks is a little more permissive than the default firewall settings for the public network. The assumption is that your private network is probably protected by some type of network firewall. Therefore, we can let the shields down just a little bit to make administration easy.

For example, we may want to allow help desk personnel to remote control our workstation. However, if you're on a public network, such as at an airport or an internet cafe, then you want maximum protection because that's an untrusted network. Therefore, when we connect to a public network, we'll have the Windows Defender Firewall on. It should be configured with much more strict rules than those used on the Home or Work private network.

Notice, here, we have the option to turn the firewall on or off. The Windows Defender Firewall should always be on. There are additional options here. The first one is to block all incoming connections, including those in the list of allowed apps. Think of this as building a huge brick wall around your workstation. Internally initiated traffic is allowed to go out, but externally initiated traffic coming in is completely blocked, so this isn't a very useful option. We don't use it in very many circumstances because it does block all externally initiated traffic, and that could be a problem. Most of the time, you'll leave that option turned off.

The Notify me when Windows Defender Firewall blocks a new program option can be very useful. A common mistake that system administrators make is to forget to open a port in the firewall for a new network-based application. When they try to test that application, it doesn't work. They think there's something wrong. By enabling this option, a pop-up message indicates that the firewall is blocking some incoming traffic.

As you can see, you can configure these options for both your private and public network locations.

### Allowing Exceptions 03:20-06:15

The next thing we need to look at is the concept of exceptions. We have the Windows Defender Firewall on. By default, it blocks all but the most essential traffic for our home or work private networks. If we install an application that requires traffic to come through that firewall, we need to create an exception.

Essentially, we're knocking a couple of bricks out of the brick wall we built around our system. This will allow traffic for our application through. To do that, we'll click Allow an app or feature through Windows Defender Firewall. A list of allowed programs and features is displayed under Name. We check each program or feature whose associated traffic we want to allow through the Windows Defender firewall. We check whether it applies to the private or public network or to both. An example is shown here. Your Core Networking features are allowed for both the private and public networks.

If you have a particular program you need to allow through the firewall, you look it up on the list and check it. For example, this workstation is on a work network and private, and you can verify that by clicking the Network icon. Go to Network and Internet Settings. You can see here that we're on a private network. On this network, we have a help desk that may need to take control of the workstation to troubleshoot problems. Therefore, we want to allow remote desktop access.

We'll scroll down to Remote Desktop, and we'll make sure that Remote Desktop is allowed on the private network. But we really don't want that hole in the firewall when we're connected to a public network such as an airport network. If we need additional information about a particular program and feature, we can click Details for a description. Let's go ahead and click OK to apply the change. Now, Remote Desktop is enabled as long as we're connected to the Home or Work private network.

So, what do you do if the application or feature we want to allow isn't listed? We'll select Allow an app or feature through Windows Defender Firewall and then select Allow Another App. It may populate a list of apps for you or try to guess what type of new app you're adding.

If the app you're looking for doesn't populate on the list, then you can go select it in the computer. Let's go to Browse. We actually have an app here on the C: drive called MyApp. Select it, and we're going to hit Open and Add. That's going to add it to the list of allowed apps and features. We can select the app and select whether it's opened on the private or public network. We're just going to do private.

Then we can hit OK to apply the change. You can also add an exception to the Windows Defender Firewall for a specific port member and protocol that you want to use. In earlier versions of Windows, you could do this in this interface, but not with later versions. Instead, we need to use a Windows Defender Firewall with advanced security.

### Summary 06:15-06:43

That's it for this demonstration. In this demo, we configured the Windows Defender Firewall. We began this demonstration by discussing what the Windows Defender Firewall does. We reviewed how to turn the Windows Defender Firewall on or off. We talked about how to create an exception in the Windows Defender Firewall. We also saw how to add new apps or features to your approved apps list.

## 4.2.8 Configuring Windows Defender with Firewall Advanced Security

### Configuring Windows Firewall Advanced Features 00:00-01:39

In this demonstration, we're going to look at Windows Defender Firewall with Advanced Security.

Windows Defender Firewall with Advanced Security manages the same Windows Defender Firewall that protects this workstation. However, the Windows Defender Firewall with Advanced Security utility lets us create much more granular firewall rules. To access the Windows Defender Firewall with Advanced Security, click Advanced Settings.

This utility displays an overview of the three different network categories along with the status of the firewall for each one. These network profiles are listed in order of permissiveness. The Domain Profile is the most open of all the profiles. The Private Profile is more restrictive than the Domain, and the Public Profile is even more restrictive.

We can configure inbound firewall rules by clicking Inbound Rules. These rules apply to network connections that are initiated by a host outside of the firewall. When that happens, these rules apply. We can review the list of all current inbound rules. If a rule has a green check mark next to it, it means that the rule is currently enabled and being applied. If it doesn't have a check mark next to it, that means that it's not enabled. This icon indicates that we're connected to a private network. Therefore, the private profile rules are currently being applied. You can enable or disable an inbound rule by right-clicking on it. If it's enabled, then you can disable it by right-clicking and selecting Disable. If it's disabled, you can right-click and enable it. You can also right-click and view its properties.

### The General Tab 01:39-02:19

The General tab defines the name for the rule. You can add a description here if you want. It also provides an option for enabling or disabling the rule. Under Action, you can specify whether the rule will allow the connection if it's secured with IPsec or block the connection. For example, this rule is allowed regardless of whether it's IPsec or not.

To change this, mark Allow the connection if it's secure. If we click Customize, we can configure various parameters that determine how secure the connection must be to be allowed. Let's click Cancel and then allow the connection regardless of whether it's secured. Let's go to the Programs and Services tab.

### Programs and Services Tab 02:19-02:36

We see a path to the executable that this rule applies to. You could also specify a service to which this rule will apply. In Windows 10, you can also specify the application packages or compartments to which this rule applies as well. Let's go to the Remote Computers tab.

### Remote Computers Tab 02:36-02:59

This inbound rule is enabled, which allows traffic for the application to enter this workstation from an external host. However, we can only do this if we require the connection to be secured with IPsec. This won't work for this application. We can't limit authorization to specific computers. Under Exceptions, you can create an exception that will skip this rule for connections coming from a specific computer.

### Protocol and Ports Tab 02:59-03:43

Now, under Protocols and Ports, we specify which transport protocol is going to be allowed and what port number is going to be allowed. Currently, it's set to UDP. The local port is set to All Ports, and the remote port on the originating host is set to All Ports. This is too permissive under local ports. Let's select Specific Ports, and then we'll specify which port this particular protocol is allowed to use. For example, let's suppose the application uses port 2,200. This way, only UDP port 2200 is open in the firewall. We can also specify that the originating port must be 2200 as well. Okay. Now let's go to the Scope tab.

### Scope Tab 03:43-05:05

The Scope tab works a lot like the Remote Computers tab. On the Remote Computers tab, we specify computers in the domain that are allowed to initiate a connection by this rule. On the Scope tab, we specify a list of IP addresses that are allowed to initiate connections. In this field, we can identify which local IP addresses are allowed to accept connections from remote hosts using the protocol and ports we specified earlier.

We can also specify which remote IP addresses are allowed to initiate the connection. We only have one interface in this system, so there's only one IP address that will be listening on the port we specified. Therefore, we can leave this set to Any IP address. But under Remote IP addresses, we may want to configure the rule so that connections can only be initiated by a host with a specific IP address. We can specify just one IP, or we can specify a range of addresses. We can allow connections from an entire subnet by specifying the network address followed by its prefix. Let's limit this rule to only allow connections from hosts that are on the same subnet as this host. If a host resides on a different subnet and tries to initiate a connection to this application, the rule will deny it. Let's enter ‘10.0.0.0/8' and click OK.

### Advance Tab 05:05-05:43

Let's go to the Advanced tab. We can specify which profiles this rule will be applied to. Currently, this rule is only applied to the private network, but we can also apply it to the domain and public networks. Let's limit this rule to the private profile. We can also specify which type of interfaces in the local system this rule will apply to by clicking Customize.

Here, we can apply the rule to all interface types, or we can just apply it to local area network, Remote access, or wireless. Let's leave it set to All interface types and click Cancel for now. Let's look at the Remote Users tab.

### Remote Users Tab 05:43-06:06

If this workstation were going to a domain, we could specify which domain users will be allowed to initiate connections for the application using the protocol and ports we specified. To do this, the connection must be secured with IPsec. Let's apply our changes to this rule. We can also create new rules by selecting New Rule under Actions.

### Inbound Rules 06:06-09:49

When we do, the new inbound rule wizard is displayed. We can use it to specify the type of rule we want to create. We can create a rule for a new program or a specific port. We can also create a custom rule. For example, suppose I've installed a secure shell or SSH service on this workstation that will allow me to remotely access the command line of this system from another host. By default, SSH runs on port 22. Therefore, we need to open up TCP port 22 in the firewall of this host to allow connections through.

Let's click on Port and click Next. Specify TCP and Port 22. Click Next. We can specify what to do with this type of connection when an external host tries to establish it. We're going to allow the connection. We could allow the connection only if it's secured, or we could block the connection, but the SSH protocol is already using SSL. Let's go ahead and click Next.

Now we'll specify which network profile we want to apply this rule to. We don't want to allow this connection if the computer is on a public network. Let's turn that option off. We do want it available on private and domain networks. We'll leave those profiles selected and click Next. We need to name the rule here. Let's name it SSH Server, and then we'll click Finish. The new rule is now in place.

You can also create a custom rule. We begin again by clicking New Rule under Actions. The firewall on this system is set not to respond to ICMP echo request packets by default, so it can't respond to ping or trace route commands. This is done as a defense against denial-of-service attacks. However, we want to configure the firewall to allow ping requests as long as they're coming from a trusted network and not from an external host. Let's go ahead and mark Custom because we need to configure the rule to work with ICMP. We'll click Next. Let's allow this rule for programs that use ICMP protocol by clicking Next. Under Protocols, we're going to select ICMPV4. Let's click Customize. By default, the rule is set to allow ICMP traffic.

But if we just want to allow ping requests to enter the system, we only need to allow ICMP echo requests packets. We'll select Specific ICMP types and Echo Requests. Click OK and then Next. We need to specify which local IP addresses we're going to accept ICMP echo requests packets on. I only have one interface in this system, so we can leave this set to Any. Let's limit the scope to just hosts on my local subnet by specifying that we want to allow the remote IP address of 10.0.0.0/8. Click OK and Next. We have to specify what to do if a connection is attempted. We're going to allow the connection. Let's click Next.

We need to specify the network profiles that we're going apply this rule to in order to prevent denial-of-service attacks. We should allow ICMP echo request packets only on domain and private networks. Let's turn Public off, but we can leave Private and Domain turned on. Click Next. Let's give this rule a name, ‘Ping ICMP request'. Then we're going to click Finish. Now we see our new inbound rule that allows ping requests to enter the workstation on our private or domain networks as long as they come from the same subnet where this host resides.

### Outbound Rules 09:49-10:27

We also have outbound rules that filter traffic that's being initiated internally on this host and going out onto the network. They're configured in much the same way as our inbound rules. Here, you see a list of the current outbound rules that are in use.

Under Monitoring, we can see firewall activity. You can also export firewall rules in exactly the same way. To do this, click Export Policy and save it to a file. You can then copy that policy file to another workstation and use the Import Policy button in Windows Defender Firewall with Advanced Security to import your rules onto the workstation.

### Summary 10:27-10:58

That's it for this demonstration. In this demo, we configured Windows Defender Firewall with Advanced Security to create more granular rules for our Windows Defender Firewall. We created a rule for the SSH protocol on TCP port 22. We also created a rule for ICMP echo request traffic. We ended this demonstration by talking about how to export the policies so we can import them on another workstation to set up its firewall.
