---
lang: zh-CN
title: Section 9.1 Host Virtualization
description: some description
---

As you study this section, answer the following questions:

<ul>
    <li>
     What is virtualization?
    </li>
    <li>
     What is the difference between a virtual machine and a hypervisor?
    </li>
    <li>
     What are the advantages of virtualization?
    </li>
    <li>
     What are the disadvantages of virtualization?
    </li>
   </ul>

In this section, you will learn to:

<ul>
    <li>
     Create virtual machines.
    </li>
    <li>
     Add virtual network adapters.
    </li>
    <li>
     Manage virtual machines.
    </li>
   </ul>

Key terms for this section include the following:

<table class="terms">
   <thead>
    <tr><th class_="firstTableHeader" scope="col" class="fw-bold">
     Term
    </th>
    <th scope="col" class="fw-bold">
     Definition
    </th>
   </tr></thead>
   <tbody><tr>
    <td>
     Physical machine
    </td>
    <td>
     The physical computer with hardware, such as the hard disk drive(s), optical drive, RAM, and
        motherboard.
    </td>
   </tr>
   <tr>
    <td>
     Virtual machine
    </td>
    <td>
     A software implementation of a computer that executes programs like a physical machine.
    </td>
   </tr>
   <tr>
    <td>
     Virtual hard
     <br>
     disk (VHD)
    </td>
    <td>
     A file that is created within the host operating system and simulates a hard disk for the virtual
        machine.
    </td>
   </tr>
   <tr>
    <td>
     Hypervisor
    </td>
    <td>
     A thin layer of software that resides between the guest operating system and the hardware. It creates
        and runs virtual machines.
    </td>
   </tr>
   <tr>
    <td>
     Load balancing
    </td>
    <td>
     A technique that disperses a workload between two or more computers or resources to achieve optimal
        resource utilization, throughput, or response time.
    </td>
   </tr>
  </tbody></table>

This section helps you prepare for the following certification exam objectives:

<table class="objectives">
   <thead>
    <tr><th class_="firstTableHeader" scope="col" class="fw-bold">
     Exam
    </th>
    <th scope="col" class="fw-bold">
     Objective
    </th>
   </tr></thead>
   <tbody><tr>
    <td>
     TestOut Security Pro
    </td>
    <td>
     3.0 Host and Application Defense
     <blockquote>
      3.2 Implement Application Defenses
     </blockquote>
    </td>
   </tr>
   <tr>
    <td>
     CompTIA Security+ SY0-601
    </td>
    <td>
     <p>
      2.2 Summarize virtualization and cloud computing concepts
     </p>
     <ul>
      <li>
       Thin client
      </li>
      <li>
       Containers
      </li>
      <li>
       Micro-services/API
      </li>
      <li>
       Virtualization
       <ul>
        <li>
         Virtual machine (VM) sprawl avoidance
        </li>
        <li>
         VM escape protection
        </li>
       </ul>
      </li>
     </ul>
    </td>
   </tr>
  </tbody></table>

## 9.1.1 Host Virtualization Overview

### Host Virtualization Overview 00:00-00:20

Let's spend a few minutes talking about virtualization and virtual network components.

Virtualization is a very important aspect of modern computing. But before we talk about what virtualization is and how it works, we first need to look at the way things have traditionally been done.

### Traditional Computing Model 00:20-01:39

In the traditional computing model, we have one operating system, or OS, installed on one hardware device. In this example, we have hardware that consists of our CPU, storage, and memory resources. We need an operating system to run these resources, which could be Windows, Linux, or even macOS. Either way, we have one hardware device being managed by one operating system.

The operating system's role is to provide services for all the applications that run on the hardware device so that they can utilize the memory, storage, and CPU resources efficiently. Here we have App1, App2, App3, and App4. Each app makes its own requests for hardware resources, and then the OS makes that happen. For example, let's suppose you're going to install a new server in your data center. The first thing you'd do is order your server hardware and then you'd pick an operating system. When the server comes, you'd install a server operating system on the hardware. The operating system has full reign over all the resources available on the server hardware, including RAM, processor time, storage devices, network interfaces, and so on. Finally, you'd install applications on top of that operating system that would interact with system resources.

### Problems with Traditional Computing Model 01:39-02:40

There's a fundamental problem with doing things this way—it's terribly inefficient. Usually, applications that run on the OS don't fully utilize all the hardware resources all the time. This is often true on a server system, and you find out that a lot of times your computing resources are actually underutilized. For example, you may see your CPU utilization hovering around 10% most of the time. You may also see that your memory utilization is likewise hovering at around 20%. This means 80-90% capacity is still available to perform additional computing tasks.

Servers are expensive, and wasted capacity means wasted dollars. Many times, servers are purchased for a specific purpose such as running web servers for individual apps. This can lead to server sprawl for the many underutilized servers This sucks up lots of power, puts out tons of heat, and costs an immense amount of money.

But there's a way to overcome this and consolidate all those servers into just a few, compact ones. That's where virtualization comes in.

### Virtualization Roles 02:40-04:07

Virtualization enables you to run multiple servers on a single physical server, called a host, through hardware virtualization. When you do this, each independent operating system or virtual machine thinks it has all the hardware resources it needs and runs in its own little isolated container. So instead of the many underutilized servers in traditional networking, with virtualization we can put many servers together on one hardware chassis to fully utilize CPU, RAM, disk, and network subsystems.

Virtualization increases IT agility, allows for greater flexibility, delivers increased performance, and allows you to scale up quickly while enjoying significant cost savings. We'll get to some more important benefits in just a minute.

Nowadays, we can virtualize just about anything—operating systems, storage, apps, networking, desktops, and more. Virtualization can also be enabled in the cloud where much of the computing can be done remotely without you having to build and maintain your own data center. It also allows companies to build their own private clouds in their data centers to virtually deliver their homemade apps to their corporate users. Now users can use just about any device to securely access their workloads remotely at any place, anytime, anywhere. The power of virtualization is driving an immense, global, and increasingly mobile workforce.

### Hypervisors 04:07-05:23

Virtualization starts with you installing a thin piece of software called a hypervisor, which decouples the virtual machines, or VMs, from the hardware and dynamically allocates resources as the virtual machines request them. Once the hypervisor is installed, you can then create virtual machines with their own operating system and apps.

Notice in this diagram we have our memory, storage, and CPU just like before. But instead of installing an operating system directly onto the host, we install a hypervisor to manage it.

On top of the hypervisor, we create virtual machines by allocating CPU, RAM, and storage. Generally, the more hardware you have on the host, the more virtual machines you can build. These physical servers that host multiple virtual machines have lots of processors and lots of RAM, and they're usually connected to an immense storage area network, or SAN, that's made to be fault tolerant.

Notice that each VM has its own OS and applications in an isolated container. Each VM makes calls to use each piece of hardware, and the hypervisor facilitates those requests. You can install just about any OS inside of a VM and then run apps built for that OS.

### Hardware Virtualization Types 05:23-05:28

Before we go on, there are three kinds of hardware virtualization that you need to be familiar with.

### Full Virtualization 05:28-06:00

The first type is called full virtualization. In full virtualization, the virtual machine completely emulates a real, physical host. This is good because it allows most operating systems and applications to run within that virtual machine without being modified in any way. The hypervisor fully decouples the operating system from the hardware. There are two types of full virtualization: bare-metal hypervisors (type 1) and hosted hypervisors (type 2). We'll learn more about these in just a minute.

### Partial Virtualization 06:00-06:26

Another form of virtualization is called partial virtualization. In partial virtualization, some virtual machine components are virtualized while others aren't. In other words, the OS uses some virtual components and some physical components while it runs. It's important to note that an operating system can only run in a partial virtualization environment if that operating system has been specifically modified to do so.

### Paravirtualization 06:26-07:08

The last type of virtualization is called paravirtualization. In paravirtualization, the hardware isn't virtualized at all. In other words, all the guest operating systems running on the hypervisor actually access various hardware resources in the physical devices directly. It doesn't virtualize any of the components. To do this, the guest operating systems run in isolated domains on the same physical hardware, which basically simulates running on separate systems. For an operating system to run on a paravirtualization environment, it must be specially modified to do so.

As you can see, a hypervisor is a fundamental component in any virtualization implementation.

### Hypervisor Types 07:08-07:17

There are several different hypervisors that you can choose from, and they generally fall within two main categories: type 1 and type 2.

### Type 1 Hypervisors 07:17-07:48

As we mentioned, type 1 hypervisors are installed directly onto the hardware and allow you to build VMs. This type is used in data centers to virtualize servers. Examples of type 1 hypervisors include VMware vSphere, Microsoft Hyper-V, Linux KVM, Citrix Hypervisor, Xen, and Oracle VM. These are enterprise-class hypervisors for serious, large-scale virtualization deployments that provide an array of management tools and feature-rich benefits.

### Type 2 Hypervisors 07:48-08:22

Alternatively, we have type 2 hypervisors. Since type 2 hypervisors are hosted and run on top of a regular operating system, they allow you to get a test environment up and running quickly without having to buy huge systems. Examples of type 2 hypervisors are VMware Workstation, Oracle VirtualBox, and Microsoft Hyper-V which is built into Windows 8.1 and 10.

All these hypervisors perform basically the same role that we talked about before. They allow you to install multiple operating systems on a single physical server.

### Virtualization Benefits 08:22-09:08

There are many benefits to implementing virtualization in your environment. The biggest drivers are reduced expenses and increased return on investment. Most virtualization platforms provide redundancy and load balancing, which minimize downtime. Also, unlike traditional computing where you have to go out and buy a physical server, you can spin up a virtual server in a fraction of the time. You can also take server snapshots in case you need to make a server rollback. An entire VM is stored in just a few files, and they can easily be copied or moved as you would any file. Finally, virtualization makes IT tasks much easier to manage and less costly.

With benefits like these, you can see why nearly all companies are using some form of virtualization in their business today.

### Virtual Machine Escape 09:08-09:49

Before we finish, we need to discuss a possible virtualization attack. Virtual machine escape is one of the security threats an attacker can take advantage of from within a virtual machine. Typically after escaping

out of a guest virtual machine, an exploiter can execute code on the hypervisor or the host operating system. The threat actor can gain access to the primary hypervisor and perform administrative tasks like VM deletion, powering off, resource allocation, and much more. The best way to prevent virtual machine escape is to regularly patch your hypervisor. Keeping your hypervisor current goes a long way in preventing exploits.

### Summary 09:49-10:11

That's it for this lesson. In this lesson, you were introduced to virtualization's common roles and functions. We discussed how virtualization works, different virtualization types, the hypervisors you can use, and virtualization benefits. We ended this lesson by discussing virtual machine escape and how you can prevent these attacks.

## 9.1.2 Load Balancing with Virtualization

### Load Balancing with Virtualization 00:00-00:20

Virtualization provides many advantages above simply installing an operating system on a physical computer system. One powerful benefit and feature is load balancing. Let's look at how load balancing works with virtual machines, or VMs.

### Clustering and Load Balancing 00:20-01:02

VMs run on top of a hypervisor which is installed on physical hardware called a host. The hypervisor decouples the hardware from the VMs, or workloads.

If we have two or more hosts, we can create a cluster. Clusters usually require shared storage like a SAN where the actual VM files reside and can be managed as a single entity. While workloads are running in memory, they still use real resources – real physical memory, real storage, and really CPUs, and the cluster manages that linking in an effective, optimized way.

### Aggregate Cluster Power 01:02-01:34

For example, if the cluster contains eight host servers with four quad-core CPUs each running at 4GHz and 64GB of memory, the cluster has an aggregate of 512GHz of CPU power and 512GB of memory available for running VMs. Having a cluster provides a number of benefits, including high-availability, load balancing, and high performance. Let's look at load balancing.

### Cluster Load Balancing 01:34-03:05

A cluster can sense which hosts are busy and offload workloads to a less busy host. It does this by monitoring hardware resources like CPU and RAM on each host of the cluster to determine the best placement for all the workloads. The load is evaluated frequently, and workloads can be adjusted dynamically to reallocate when needed.

This means a VM or workload could move from one host to another in a cluster for better performance. And what's cool is this is seamless to the user—they don't even notice all this is happening on the back end.

This dynamic allocation load balances the workloads across hosts in the cluster based on host resource load and availability. When a host gets busy, workloads will be moved to another host on the fly. That's powerful, and ensures each workload gets the very best performance possible.

Not all your hosts will have the same hardware with CPU and RAM resources. Some hosts will be beefier than others. Some will have newer processors. This means that some hosts can handle more dense workloads than others. The cluster can sense how busy each host is and adjust, or load-balance, the workloads for best performance and to best utilize CPU and memory resources across the cluster.

### Resource Pooling 03:05-05:38

Within a cluster, we can usually create what's called a resource pool. This helps us allocate CPU and RAM resources to prioritize our workloads.

Some workloads may have applications that are mission critical and require specific resources to always be up and running properly. Other workloads may not be as important, but still need adequate resources. Resource pooling allows us to establish performance boundaries within the cluster, so resources aren't consumed by low-level workloads and keep important workloads from starving for resources.

So, a resource pool works within the cluster, and may span two or more host servers. Let's create Resource Pool A with a certain amount of RAM and CPU shares. After creating the pool, we can then assign or create VMs to run in the pool. We can create as many pools as we like in our cluster, but we must always assign them CPU and memory performance. Here's another pool – Resource Pool B. We'll assign it a certain amount of CPU and RAM, and then we'll assign VMs to it.

In essence, the workloads end up being load balanced, and they are throttled to only use the established resource limits. This allows admins to aggregate computing capacity and delegate it for use rather than focus on individual host servers. And, as a bonus, if one host server goes down, the other servers in the cluster will pick up the workloads and continue on.

You can create a resource pool on an individual host. However, if you have a cluster, resource pooling will provide more resources across the hosts in a cluster, allowing you to better manage the use of those hardware resources, including reservations for CPU and RAM usage. The VMs will be load balanced within the resource pool within the cluster. This provides for rapid elasticity which leverages virtualized server and storage technologies to rapidly meet the rise and fall of user load and service demand.

Hypervisor software that supports resource pooling is downloadable from the internet. You can download an evaluation copy to set up and experiment with load balancing on virtual machines.

### Summary 05:38-06:11

That's it for this lesson. Within the context of virtualization, that's how load balancing works. Clustering allows VMs to be load balanced and highly available while providing the best performance possible for each workload. And resource pooling allows us to aggregate hardware resources across multiple hosts ensuring that the workloads get the resources they need without sacrificing the performance of others.

## 9.1.3 Virtualization Facts

This lesson covers the following topics:

<ul>
   <li>
    Virtualization components
   </li>
   <li>
    Virtualization advantages and disadvantages
   </li>
   <li>
    Virtualization security
   </li>
   <li>
    Load balancing
   </li>
  </ul>

### Virtualization Components

Virtualization refers to installing and running multiple operating systems concurrently on a single physical machine. Virtualization typically includes the following components:

<table>
   <thead>
    <tr><th class_="firstTableHeader" scope="col" class="fw-bold">
     Component
    </th>
    <th scope="col" class="fw-bold">
     Description
    </th>
   </tr></thead>
   <tbody><tr>
    <td>
     Physical machine
    </td>
    <td>
     A
     <i class="fs-italicize">
      physical machine
     </i>
     , also known as the host operating system, has the hardware, such as the hard disk drive(s), optical
        drive, RAM, and motherboard.
    </td>
   </tr>
   <tr>
    <td>
     Virtual machine
    </td>
    <td>
     A
     <i class="fs-italicize">
      virtual machine
     </i>
     , also known as the guest operating system, is a software implementation of a computer. The virtual
        machine executes programs in the same way a physical machine executes programs. The virtual machine appears to be a
        self-contained and autonomous system.
    </td>
   </tr>
   <tr>
    <td>
     Virtual hard disk (VHD)
    </td>
    <td>
     A
     <i class="fs-italicize">
      virtual hard disk
     </i>
     (VHD) is a file created within the host operating system and simulates a hard disk for the virtual
        machine.
    </td>
   </tr>
   <tr>
    <td>
     Hypervisor
    </td>
    <td>
     A
     <i class="fs-italicize">
      hypervisor
     </i>
     is a thin layer of software that resides between the guest operating system and the hardware. A
        hypervisor allows virtual machines to interact with the hardware without going through the host operating system. There are
        two types of hypervisors.
     <ul>
      <li>
       A Type I hypervisor is often called a native hypervisor or bare-metal hypervisor. A hypervisor in a dedicated
          appliance is called an embedded hypervisor. A Type I hypervisor is like a thin operating system that directly interfaces
          with the computer hardware. Examples of Type I hypervisors are:
       <ul>
        <li>
         VMware ESX and ESXi
        </li>
        <li>
         Microsoft Hyper-V
        </li>
        <li>
         Linux KVM
        </li>
        <li>
         Citrix Hypervisor
        </li>
        <li>
         Xen
        </li>
        <li>
         Oracle VM
        </li>
       </ul>
      </li>
      <li>
       A Type 2 hypervisor is known as a hosted hypervisor. It runs as an application on a conventional operating system.
          While it may be used in a production environment, a type 2 hypervisor is most often used as a development sandbox.
          Examples of Type II hypervisors are:
       <ul>
        <li>
         VMware Workstation and VMware Player
        </li>
        <li>
         Oracle Virtual Box
        </li>
        <li>
         Microsoft Hyper-V built into Windows 8.1 and 10
        </li>
        <li>
         Parallels Desktop for Mac
        </li>
       </ul>
      </li>
     </ul>
    </td>
   </tr>
  </tbody></table>

### Virtualization Advantages and Disadvantages

Advantages of virtualization are described in the following table.

<table>
   <thead>
    <tr><th class_="firstTableHeader" scope="col" class="fw-bold">
     Advantage
    </th>
    <th scope="col" class="fw-bold">
     Description
    </th>
   </tr></thead>
   <tbody>
    <tr>
     <td>
      Flexibility
     </td>
     <td>
      Virtual machines can be given network access. Other network devices will consider them to be physical
          machines. Be aware that virtual machines:
      <ul>
       <li>
        Should have the latest service packs and patches, just like physical machines.
       </li>
       <li>
        Should be hardened, just like physical machines.
       </li>
       <li>
        Can be connected to the production network by creating a bridged (external) virtual switch.
       </li>
      </ul>
      <p>
       Because they are self-contained, virtual machines can be easily moved between hypervisor hosts as needed.
      </p>
     </td>
    </tr>
    <tr>
     <td>
      Security
     </td>
     <td>
      To better protect other systems, virtual machines can be used to create honeypots and honeynets to
          attract attackers so you can analyze attacks on the system.
     </td>
    </tr>
    <tr>
     <td>
      Testing
     </td>
     <td>
      Virtual machines can be configured in a lab environment that mirrors a production network. This lab
          environment can be used to:
      <ul>
       <li>
        Test applications before installing them on production systems.
       </li>
       <li>
        Test updates and patches before rolling them out into the production environment.
       </li>
       <li>
        Test security controls to verify that they are working as designed.
       </li>
      </ul>
     </td>
    </tr>
    <tr>
     <td>
      Server consolidation
     </td>
     <td>
      Server consolidation allows you to move multiple physical servers onto a few physical servers with
          many virtual machines.
      <i class="fs-italicize">
       Physical-to-virtual migration
      </i>
      (P2V migration) is the process of moving an older operating system off aging
          hardware and into a virtual machine. Consolidating servers:
      <ul>
       <li>
        Requires fewer physical computers.
       </li>
       <li>
        Reduces power consumption.
       </li>
       <li>
        Increases physical server utilization of resources.
       </li>
       <li>
        Increases administrative efficiency.
       </li>
       <li>
        Reduces the number of incompatibility issues.
       </li>
      </ul>
     </td>
    </tr>
    <tr>
     <td>
      Isolation
     </td>
     <td>
      A virtual machine can be isolated from the physical network to allow testing to be performed without
          impacting the production environment. This is called sandboxing.
      <ul>
       <li>
        Sandboxed virtual machines offer an environment in which malware can be executed with minimal risk to equipment and
            software.
       </li>
       <li>
        Sandboxing virtual machines protects them from many kinds of security threats.
       </li>
       <li>
        To allow isolated virtual machines to communicate with each other, create a new virtual switch configured for
            host-only (internal) networking. Connect the virtual network interfaces in the virtual machines to the virtual
            switch.
       </li>
      </ul>
     </td>
    </tr>
    <tr>
     <td>
      Application virtualization
     </td>
     <td>
      Applications can be virtualized.
      <ul>
       <li>
        A virtual application appears to be local, but is really running on a different system.
       </li>
       <li>
        Virtualized browsers can protect the underlying physical operating system from malware installation. Any malware
            installed from the virtual browser affects only the browser, not the rest of the system.
       </li>
      </ul>
      <div class="info" data-block="
       Malware can also use virtualization techniques that make it difficult to
          detect.
      "><div class="to-info-box"><div class="to-info-box-body"><div class="to-icon large" aria-hidden="true"><svg aria-hidden="true" focusable="false" style="width:20px" data-prefix="fal" data-icon="circle-info" class="svg-inline--fa fa-circle-info " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 32a224 224 0 1 1 0 448 224 224 0 1 1 0-448zm0 480A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM208 352c-8.8 0-16 7.2-16 16s7.2 16 16 16l96 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0 0-112c0-8.8-7.2-16-16-16l-40 0c-8.8 0-16 7.2-16 16s7.2 16 16 16l24 0 0 96-32 0zm48-168a24 24 0 1 0 0-48 24 24 0 1 0 0 48z"></path></svg></div><div class="to-info-box-body-content"><span>
       Malware can also use virtualization techniques that make it difficult to
          detect.
      </span></div></div></div></div>
     </td>
    </tr>
   </tbody>
  </table>

Disadvantages of virtualization include:

<ul>
   <li>
    An attack on the host machine could compromise all guest machines operating on that host.
   </li>
   <li>
    A bottleneck or failure of any hardware component that is shared between multiple guests, such as a failure in a disk
      subsystem, could affect multiple virtual machines.
   </li>
   <li>
    While administration is centralized, virtualization is a newer technology and requires new skills. Managing virtual
      servers can add complexity.
   </li>
   <li>
    Your configuration is susceptible to server sprawl, a condition that delays patch and security update management due to
      the number of virtual machines that must be managed. .
   </li>
  </ul>

### Virtualization Security

Security considerations for a virtual machine should be the same as for physical machines. For the host and all guest machines, be sure to:

<ul>
   <li>
    Reduce the number of services running.
   </li>
   <li>
    Apply patches and updates regularly.
   </li>
   <li>
    Install antivirus and other security software.
   </li>
   <li>
    Implement backups, operating system snapshots, and other solutions for data protection.
   </li>
  </ul>

In addition, you should protect against virtual machine escape, an exploit in which malware allows the operating system within a virtual machine to break out and interact directly with the hypervisor. To minimize this vulnerability.

<ul>
   <li>
    Apply patches and updates regularly.
   </li>
   <li>
    Install only the resources-sharing features that are necessary.
   </li>
   <li>
    Install only the software applications that are necessary.
   </li>
  </ul>

### Load Balancing

Load Balancing is a technique that disperses a workload between two or more computers or resources to achieve optimal resource utilization, throughput, or response time. The primary goal of load balancing is to improve performance and create high availability by configuring multiple devices to respond as one. Load balancing can also provide fault tolerance.

If the load balancing mechanism is able to detect when a specific node or member is unavailable, new requests will automatically be distributed to other available members. Load balancing methods with virtualization include the following:

<ul>
   <li>
    Resource pooling creates shared logical pools of CPU and memory resources from many physical machines within the
      hypervisor to guarantee a level of resources for specific virtual machines.
   </li>
   <li>
    Workload balancing distributes a workload (the total requests made by users and applications of a system) across multiple
      computers or a computer cluster to achieve optimal resource utilization, maximize throughput, minimize response time, and
      avoid overload.
   </li>
  </ul>

## 9.1.4 Creating Virtual Machines

### Creating Virtual Machines 00:00-00:47

In this video, we're going to create virtual machines using Hyper-V. To open Hyper-V Manager, we click on Tools > Hyper-V Manager. We're going to right-click the server, go to New, and then to Virtual Machine.

On the New Virtual Machine Wizard page, we first click Next. Then we select a name for our new virtual machine. I'm going to call it Windows Server 2019.

You also have the option to store the virtual machine, or VM, in different locations. Just make sure the location you choose has enough space. You can see it's grayed out here. If we take snapshots of the virtual machine, they're stored wherever the virtual machine is located. Take that into account when you're creating the virtual machine.

### Generation 00:47-01:34

We hit Next and Specify Generation. This is a relatively new section as it was added back in Windows Server 2016. Before that, Hyper-V didn't have this option. But it now gives you the option to support more legacy hardware.

Sometimes environments use mixed operating systems or different bit versions, like 32-bit or 64-bit operating systems. Generation 2 doesn't allow for 32-bit systems, and it doesn't support all previous versions of Hyper-V. You need to understand your environment and what type of servers and other things you're going to be using.

Generation 2 also supports the newer virtualization features and has a UEFI-based firmware. But like I said, this generation can only work with 64-bit systems, not 32-bit ones. Let's select Generation 1 for our purposes.

### Startup Memory 01:34-01:55

Now we're going to set up the initial startup memory. We can change this now, or we can change it after the fact. It doesn't matter. You can also specify Dynamic Memory for this machine, but we're going to wait until we've created the virtual machine to do that.

On the Configuring Network page, you can select a virtual network switch right here. We're also going to wait to do that because we can change that later.

### Hard Drive 01:55-02:30

On the Connect Virtual Hard Disk page, we're going to select a virtual hard drive. By default, it creates a new virtual hard disk. If we create it through the wizard, it will be a dynamically increasing VHDX. That's 127 B.

You use a different wizard to create a fixed-size VHD if you don't want it to be dynamically expanding. We either create that pre-VHD setup by selecting Use an existing virtual hard disk, or we can select Attach a virtual hard disk later. If you do create the virtual hard drive through the wizard, it's going to be dynamically expanding. You can convert it later; Hyper-V gives you that option.

### Installation Media 02:30-03:32

Now, if you selected Generation 1, this is what you generally see. But if you selected Generation 2, a few of these options will be missing. On Generation 1, we can install the OS from either a CD/DVD, a physical drive, or an ISO file.

We also have the option to install from floppy, although that's not very common and hasn't been for a long time. The last option is to install it from a network-based server, assuming we have connectivity. Since we didn't select any virtual networks, that's grayed out.

If we had connected a network adapter, it would be active and we could select it. It could be a WDF server or something like that. We'll install the operating system later. One thing to note: if we did select Generation 2, we would have the option to install from image ISO but not from CD/DVD or virtual floppy. You still would have the network-based installation option as well.

After hitting Next, it shows us the basic settings we've selected. Let's click Finish, and it creates the virtual machine for us.

### Change Settings 03:32-04:10

So now we're going to right-click our virtual machine and go to Settings.

You can see that we can change any of the choices we made using the wizard except for the generation settings. The Generation 1 or 2 settings cannot be changed after the wizard is complete. You have to make that decision beforehand. If you need something that does support legacy options and you selected Generation 2, you'll have to create a new virtual machine.

But currently, with Generation 1, we can go in and change things like the virtual hard disk, what's in the DVD drive, our network adapter connection, and other settings. We make those changes here. It's convenient to install virtual machines from ISOs.

### Image File 04:10-05:11

ISOs are images of CDs or DVDs, and that's what we're going to be using. We'll browse to our server image file. Let's go to Image File, Browse, and here I have my image file. This is our ISO file. When we clicked Open, what we basically did was we told the server, "This is where our image file is."

It's kind of like putting an image disc into your computer's DVD drive. That's how it treats it on bootup. The difference is that this is a virtual machine and the file is just a copy of a DVD. It's obviously not an actual DVD. ISOs can be stored on pretty much any type of storage device. You can have them locally on the machine, or you can boot them from a USB drive. Let's go ahead and hit OK.

Currently the virtual machine has nothing on its hard drive. It has a Windows Server 2019 DVD, or ISO, in the CD drive. If we double-click it (or if you don't like double-clicking, you can right-click and click Connect), you can see the machine is currently turned off.

### CTRL+ALT+DEL and Start 05:11-05:50

You can see right here (this button right here, hover over it) that it shows you if you press it, a CTRL+ALT+DEL command. You can also do this within the virtual machine by pressing CTRL+ALT+END. Because if you do that, a CTRL+ALT+DEL, it basically sends that command to the server you're currently in and not to the virtual machine. So it does CTRL+ALT+END.

Next is the Start button. If we click this button, it powers on the VM. We're going to go ahead and click it. This button, Turn Off, is kind of like a hard stop. It's the equivalent of hard shutting down your machine. So if I just held down the button and hard crashed the machine, that's basically what this does.

### Shut Down and Save 05:50-06:18

Then we have the Shut Down button that sends a shutdown signal. Then we have the Save button. The Save button is similar to hibernating on a laptop. The Save button stops the virtual machine from using physical resources, but it maintains the state of the machine.

If you have to stop what you're doing and maybe do some other function on the server, this can be useful if you don't want to lose where you're at, or you want pick it up a little bit later. If you have to perform a different function prior to making a change, you might use that option.

### Summary 06:18-06:45

That's it for this demo. That's how you create a virtual machine using Hyper-V. You can see here this has brought us to our installation window since it just booted that ISO from the Windows Server 2019 ISO from what it sees as the DVD drive. From here, we would finish installing our operating system and the virtual machine would be ready for use. But that's not part of this demo so I'll stop here.

## 9.1.5 Managing Virtual Machines

### Managing Virtual Machines 00:00-00:25

In this demo, we'll talk about settings on existing virtual machines. We're going to go ahead and click on Tools and go to Hyper-V Manager. There are some settings that you can only change when the machine is off. So instead of using this Server 2019, we're going to use my Windows 10 virtual machine. Right-click and go to Settings.

### Hardware Settings 00:25-00:59

If I need to add hardware to this virtual machine, or VM, I can do it right here on the Add Hardware page. We can add network adapters, SCSI controllers, fiber channel adapters, and legacy network adapters. If we go to the BIOS page, we can set and see the current boot order. You're going to see my current boot order right here. First is the CD/DVD drive, then the IDE or hard drive, network adapter, and floppy disk (which is uncommon to be used as your boot drive).

### Security Settings 00:59-01:09

Windows Server 2019 gives us options for security settings. This is basically just encryption support for your virtual machines. We're not going to go into that at this moment.

### Memory Page 01:09-02:48

On the Memory page, we can change how Hyper-V deals with the memory startup RAM, or the amount of RAM available when you start the VM. So unless we turn on Dynamic Memory, this is all the RAM this VM is going to have. Virtual machines need a little more RAM on startup than they do to actually run. We may be able to set the minimum memory lower, and the machine would still work well. Windows 10 requires 1GB of RAM for the 32-bit distributions and 2GB of RAM for the 64-bit distributions, whereas Server 2019 only requires 512MB of RAM.

Dynamic Memory allows the host to allocate memory based on need. So, let's enable Dynamic Memory. If we set the minimum RAM to 512 and another one of our virtual machines needs additional RAM, the host can reallocate some of the RAM from this VM to the other VM. The reallocation is also based on need. And remember, you can't adjust the memory if the machine has already booted. So, the minimum RAM is the smallest amount of RAM that can be given to the VM. Make sure you have enough for the machine to run. Maximum RAM is the maximum amount of RAM the host can allocate to the VM.

You can also set memory weight for this machine. This setting gives the host a priority for allocating memory. If Hyper-V has to make a decision, it's going to give RAM to the highest priority machine. For example, if I lowered this for my Windows 10 machine and my server has higher priority, Hyper-V would allocate more RAM to my server than to Windows 10.

### Virtual Processors 02:48-03:41

You can set the number of virtual processors for the virtual machine. We might have a quad-core CPU in the host, but we may want to give the VM only one core. We can only go above one if we have more than one core in the physical machine. We also have resource control here. We can specify a certain percentage of the host processor in reserve for this virtual machine. We can set a limit in terms of total resources as well. We can also set a relative weight. If you have a VM with a weight of 200 and one with a weight of 100, the one with 200 weight will get twice as much attention from the processor as the one with 100 weight.

We can also change the hard drive, if necessary, for IDE Controller 0. Under IDE Controller 1, we can specify the media for the virtual CD/DVD drive.

### ISO Image 03:41-04:19

We can use an ISO image, or we can connect the physical drive. You can see I'm using an ISO image. SCSI controller allows us to add SCSI devices. By default, we can add a hard drive or a shared drive, but we can't do this while the virtual machine is running. We can change the virtual network to which this adapter attaches. We can also enable virtual LAN and bandwidth management. We can map comports as well. And we can use a virtual floppy or diskette drive. Some of these options are only available if we selected the Generation 1 option under Server Generation Support.

### Management 04:19-05:04

Under Management, we can view the name of the virtual machine. The Integration Services setup, which services the VM, is basically all that we're going to use. We can turn on Operating system shutdown, Time synchronization, Data Exchange, and Heartbeat. Heartbeat is basically the failover for the server. In Windows Server, you can set the heartbeat or the failover settings, and you can also set up the backup or volume shadow copy. There are some guest services as well. In Server 2012, this was called snapshots. Snapshots had their name changed to checkpoints to avoid confusion with some other services.

We can also configure the Smart Paging File Location here.

### Automatic Start Action 05:04-05:49

Automatic Start Action specifies what we want this virtual machine to do when the physical computer starts. By default, if it was running when the physical machine stopped, it will restart when the physical machine reboots. Another option is to start automatically. If you select Nothing, you'll have to manually restart it.

Automatic Stop Action specifies the action the VM takes if we shut down the physical server. By default, Save the virtual machine state is the action chosen so that the virtual machine doesn't crash. That's probably your best option. The Turn off the virtual machine option is a hard crash of the virtual machine. You don't want to select that. We could use the Shut down the guest operating system option, but we normally leave it at the default.

### Summary 05:49-06:01

That's it for this demonstration. In this demo, we went over some of the settings you can change on an existing virtual machine.

## 9.1.7 Adding Virtual Network Adapters

### Adding Virtual Network Adapters 00:00-00:54

In this demonstration, we're going to walk through the process of adding a new network adaptor to an existing virtual machine. The process is pretty straightforward. All you need to do is locate the virtual machine in your list of virtual machines within Hyper-V Manager. Right click on it, and then click on Settings.

I might add, before we go any further, that in order to add a new network board, you do have to have the virtual machine shut down. It needs to be in an off state. You can't add it to a live, running virtual machine. We're good here, the VM is shut down. To add a new network interface to this system, under Hardware I click on Add Hardware. Then I select Network Adapter from the list of available hardware that I can add to the system, and then click Add.

### Specify Virtual Switch 00:54-01:26

Now I need to specify which virtual switch I want to connect this network board to. I only have one virtual switch defined. This is my virtual switch that is connected to my physical network segment, and also provides internet access. I could just add the network board and leave it not connected to anything, and I could connect it to something else later on. Let's go ahead and do connect it to the switch, come down here and click OK.

### DHCP 01:26-02:23

Now, let's power on that virtual machine, I'll click on Connect, and then Power On. Now, if this had been a physical system, and I had installed a new physical network board into that physical system and connected it to my network switch with a drop cable, when I power the system on, by default, Windows is going to dynamically assign that new network interface an address via DHCP. If that's what you want, you're in good shape.

If this were a workstation system, that's probably what we would want to do, but this virtual machine is a Windows Server 2016 server. Generally speaking, we don't like having dynamically assigned addresses to servers, because most of the time the address needs to stay the same. Therefore, we're going to log onto this virtual machine, and what we're going to do is assign a static IP address to it.

### Static IP Address 02:23-03:23

Let's go to Local Server. Let's click on Ethernet2. Go to Properties, Internet Protocol Version 4 Properties. Let's use a statically assigned IP address. The first NIC in this system was assigned 10.0.0.68, so let's assign this one 10.0.0.69. We'll leave the same default gateway address. It copied in the address that it was assigned previously for the default gateway by the DHCP server, didn't save the DNS server address. We'll enter that in manually. Click OK. Yes, close. Refresh server manager.

### Summary 03:23-03:47

We now have two NICs installed in this system, the first one assigned 10.0.0.68, the second one 10.0.0.69. That's it for this demonstration. In this demo, we talked about how to add a virtual network board to a virtual machine in Hyper-V.
