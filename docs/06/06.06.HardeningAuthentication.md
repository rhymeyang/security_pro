---
lang: zh-CN
title: Section 6.6 Hardening Authentication
description: some description
---

As you study this section, answer the following questions:

<ul>
    <li>
     Identify the characteristics that typically define a complex password.
    </li>
    <li>
     What does the minimum password age setting prevent?
    </li>
    <li>
     What is a drawback to account lockout for failed password attempts?
    </li>
    <li>
     What are the advantages of a self-service password reset management system?
    </li>
   </ul>

In this section, you will learn to:

<ul>
    <li>
     Configure account password policies.
    </li>
    <li>
     Restrict local accounts.
    </li>
    <li>
     Secure default accounts.
    </li>
    <li>
     Enforce user account control.
    </li>
    <li>
     Configure smart card authentication.
    </li>
   </ul>

The key terms for this section include:

<table class="terms">
   <thead>
    <tr><th class_="firstTableHeader" scope="col" class="fw-bold">
     Term
    </th>
    <th scope="col" class="fw-bold">
     Definition
    </th>
   </tr></thead>
   <tbody><tr>
    <td>
     Multifactor authentication
    </td>
    <td>
     Using more than one method to authenticate users.
    </td>
   </tr>
   <tr>
    <td>
     Smart cards
    </td>
    <td>
     Similar in appearance to credit cards, smart cards have an embedded memory chip that contains encrypted
        authentication information. These cards are used for authentication.
    </td>
   </tr>
   <tr>
    <td>
     Microprobing
    </td>
    <td>
     The process of accessing a smart cards chip surface directly to observe, manipulate, and interfere with
        the circuit.
    </td>
   </tr>
   <tr>
    <td>
     Radio frequency identification
     <br>
     (RFID)
    </td>
    <td>
     The wireless, non-contact use of radio frequency waves to transfer data.
    </td>
   </tr>
  </tbody></table>

This section helps you prepare for the following certification exam objectives:

<table class="objectives">
   <thead>
    <tr><th class_="firstTableHeader" scope="col" class="fw-bold">
     Exam
    </th>
    <th scope="col" class="fw-bold">
     Objective
    </th>
   </tr></thead>
   <tbody><tr>
    <td>
     TestOut Security Pro
    </td>
    <td>
     1.0 Identity Management and Authentication
     <blockquote>
      1.1 Manage Identity
     </blockquote>
    </td>
   </tr>
   <tr>
    <td>
     CompTIA Security+ SY0-601
    </td>
    <td>
     2.7 Explain the importance of physical security controls.
     <ul>
      <li>
       Sensors
       <ul>
        <li>
         Cards
        </li>
       </ul>
      </li>
     </ul>
     <p>
      3.7 Given a scenario, implement identity and account management controls.
     </p>
     <ul>
      <li>
       Identity
       <ul>
        <li>
         Tokens
        </li>
        <li>
         Smart cards
        </li>
       </ul>
      </li>
      <li>
       Account policies
       <ul>
        <li>
         Password complexity
        </li>
        <li>
         Password history
        </li>
        <li>
         Password reuse
        </li>
        <li>
         Time of day
        </li>
        <li>
         Network location
        </li>
        <li>
         Geofencing
        </li>
        <li>
         Geotagging
        </li>
        <li>
         Geolocation
        </li>
        <li>
         Time-based logins
        </li>
        <li>
         Access policies
        </li>
        <li>
         Account permissions
        </li>
        <li>
         Account audits
        </li>
        <li>
         Impossible travel time/risky login
        </li>
        <li>
         Lockout
        </li>
        <li>
         Disablement
        </li>
       </ul>
      </li>
     </ul>
    </td>
   </tr>
  </tbody></table>

## 6.6.1 Hardening Authentication

### Hardening Authentication 00:00-00:17

In this lesson, we're going to talk about hardening authentication. Hardening means strengthening. You want to make sure your authentication methods are strong so you can be confident that the users accessing your network are who they claim to be.

### Education 00:17-01:09

As simple as it may sound, user education is one of the most important parts of authentication hardening. A surprisingly large percentage of security issues within an organization can be tracked back to an employee or another authorized user. While some of these breaches are intentional, many are unintentional; they're a result of a seemingly harmless action.

After all, the strongest doors and the toughest locks become inconsequential if an employee inadvertently opens the door for a potential attacker because they're trying to be helpful.

End user security training should be extensive. For the purpose of authentication hardening, encourage your employees to use password creation methods that they'll remember. Remind them that they shouldn't write down their passwords. Teach them how to recognize social engineering attempts, and remind them not to share their physical or digital access with anyone for any reason.

### Passwords 01:09-02:24

Next, let's look at passwords more closely. Since passwords are a primary method of authorization, be sure to harden your password policies.

For example, configuring password aging policies causes passwords to be valid for only a specified length of time. After this time has passed, the user will need to change their password.

Enforcing password history prevents the end user from being able to reuse the same password over and over. This can be set for a certain number of times. You might configure your settings so employees can't reuse any of their past five passwords. Or you could set up an indefinite policy so that a user can never use any of the same passwords they've used in the past.

Another way to harden passwords is to enforce password complexity. Doing this prevents users from creating simple passwords like "1234" or "password." When you configure your enforcement policy, you can require capital letters, numbers, or special characters. You can even require that the password be a minimum number of characters long.

You can also allow end users to manage their own passwords without requiring help from the system administrator. This is known as self-service password management. While this can be a convenient option for the user and the administrator, be sure to consider whether it's suitable for your desired level of security.

### Multifactor Authentication 02:24-03:39

As we've already discussed, passwords are a common authentication method, and they do provide a layer of security. But just because your network or data is protected by a passwords doesn't mean it's secure.

Whenever possible, you should use multifactor authentication. This means using more than one method to authenticate your users.

End users can authenticate in many ways.

The user could provide something they know, like a password or a PIN.

They could provide something they have, like an ID card or a security token. They could provide something that they are by using their biometric data, such as a palm print, a fingerprint, or a retina scan. Robust authentication processes use two or more of these factors.

Some administrators mistakenly assume that requiring users to supply a username and a password constitutes multifactor authentication. That's incorrect. A username and a password are both items that the end user knows, so they constitute single-factor authentication. If you want to make your authentication process more robust, you can add an additional authentication factor.

For example, you could require a name and password along with a smart card: something that the user knows and something that the user has.

Or you could require a fingerprint scan and a PIN: something that the user is and something that the user knows.

### Account Restrictions 03:39-04:33

Another way to harden your authentication is to apply restrictions to user accounts. First, you can limit the number of concurrent logins to one per person. This way, if someone forgets to log off of a device, they can't log into a second device without terminating the first connection.

You can also limit when an end user can log in to the system. For example, you may specify that end users can log in between the hours of seven in the morning and six at night. If they try to log in outside of that window, they're blocked.

Another thing you can do is set an account lockout threshold. The account lockout threshold determines the number of failed login attempts that can occur before the user account is locked. Or you could configure a reset lockout counter. The reset lockout counter parameter specifies the amount of time that must pass after a failed login attempt before the failed login counter is reset. This is to slow down password guessing as well as dictionary or brute force attacks.

### Account Monitoring 04:33-05:11

While we're on the topic of user accounts, let's discuss monitoring and maintenance. Most network administrators are sitting on a pile of data about their users.

There are logs to show when users are signing in, when they're entering incorrect passwords, when they're resetting passwords, where they log in from, and more.

Keeping an eye on activity logs can be kind of dull and time-consuming. So instead of doing it manually, a lot of people use software to do it for them. If unusual or risky behavior is detected, the software will notify you so can act accordingly. This could mean requiring an additional method of authentication, or it could mean locking an account completely.

### Account Maintenance 05:11-06:45

Maintaining accounts is also important. Some large corporation networks have been breached using outdated or inactive user accounts.

If an employee leaves the organization, that user's account needs to be disabled or deleted. You should also disable inactive accounts. These are commonly associated with contract employees, who only access the network periodically. If the user doesn't need access for a time, disable their account. When the user needs access again, you can re-enable it.

Automatic account expiration is another option where the account is only enabled for a certain amount of time. After that time has passed, the account is automatically disabled. This is especially useful for temporary employees.

You should also make sure that the user accounts have the appropriate level of access. On a Windows network, there are two separate sets of user accounts that you must manage. The first set of accounts resides on the domain controller, and they're managed by the admins.

The second type of accounts are the local user accounts on each individual workstation. These are local accounts. You may not want users to have local administrative access. If they do, they could adjust local file system permissions, install malware, or even create a backdoor user account. Because of this the default administrator account should be the only administrator-level local user accounts on your workstation, and you may want to rename it to obscure it. All other users should be standard users that aren't members of the Administrators group.

You should also disable the local guest user account on each workstation. This account allows someone to authenticate and gain limited access to the system without providing any type of credentials.

### Limit Remote Access 06:45-07:40

Now, let's talk about remote access. The most important thing you can do to harden your remote access is to ensure that it's only enabled for end users who actually need it. Remote-access clients should connect to the internal network through a demilitarize zone, or DMZ. This allows traffic monitoring, which lets you verify that remote access connections are authorized and legitimate. You can also restrict remote access to only certain authorized IP addresses.

In addition, you can limit concurrent logins, such as only one per user. Every time a remote user connects, their last login date and time should be displayed. This allows the end user to see if somebody else has been using their connection to gain access to the network.

Lastly, you should audit remote logins. Check to see if remote connections are made at suspicious times or from suspicious IP addresses, and check for a spike in the number of failed logins. All these events indicate that some type of attack is probably being conducted.

### Summary 07:40-07:59

And that's it for this lesson. In this video, we discussed hardening authentication through user education, stronger passwords, multifactor authentication, account restrictions, account monitoring, account maintenance, and limited remote access.

## 6.6.2 Configuring User Account Restrictions

### Configure User Account Restrictions 00:00-00:30

In this demonstration, we'll look at hardening a Windows workstation by configuring user account restrictions. By setting these restrictions in a domain, they will always be applied, even if the user logs in from a different system, or if a different user logs into system.

Let's begin by going to Tools > Active Directory User and Computers. Let's drill down into Users groups and go to this location. Now you can see the list of users here, in this domain group.

### Harden an Account 00:30-01:02

First, we need to do several things to harden these accounts. Let's choose the temporary employee, Daniel Jackson. There are several things we can do to harden his account, specifically because he's a temporary employee.

This user works Monday through Friday from 8:00 in the morning until 5:00 at night. We need to restrict the user's logon hours and days to the times he is working. Also, because the user is a temporary employee, we should configure the account to expire automatically when the employment term expires.

We want to disable the account automatically in case we forget to manually disable it.

### Select Login Hours and Days 01:02-01:46

First, let's go into Account settings > Logon Hours. Everything that is highlighted in blue is a permitted logon block or hour.

You can see the days here, Sunday through Saturday, and anything highlighted in white will be logon denied. In this case, we want to limit logon to Monday through Friday, 8:00 a.m. through 5:00 p.m. If we select a day and select Logon Denied, it denies logon for the whole day. It whites it all out. We'll select Saturday, as well.

We'll select the whole group up to 8:00 a.m. Then we'll go from here to 5:00 p.m. You can see we have blued out Monday through Friday, 8:00 a.m. to 5:00 p.m. We click OK, and that restricts the user to logging in only during those hours of 8:00 a.m. to 500 p.m, Monday through Friday.

### Set Account Expiration 01:46-02:10

We also need to set the account expiration. You can see it's set to Never. We want to change this. Let's say this account will expire at the end of the year. We'll click December 31. We'll click Apply. Click OK.

Now Daniel Jackson's account will automatically deny him access unless he's logging in Monday through Friday, 8:00 a.m. to 5:00 p.m. The account will be disabled automatically on December 31, at the end of the day.

### Disable Account 02:10-02:45

Also, in this OU, we have an employee who's on extended leave.

The employee will be back in a couple of months, but until then, we don't want anyone to be able to use the account. We could delete the account, but that wouldn't be wise. Because the user's coming back, we'd have to recreate the account including all the rights. That can be difficult when you have a lot of rights in your organization. A better option is to disable the account.

To do this, come up here and right-click the account. You can see the options here. Notice that the account has a little black arrow here, on the side of the user. That indicates the account is disabled now.

### Re-enable Account 02:45-03:01

Let's say we have another employee who has been out on extended leave but is coming back to work tomorrow. We need to re-enable the account. In the same way, we'll right-click the account. Then we'll click Enable Account. The user is enabled. The user can log back into the system upon return to the office tomorrow.

### Restrict to a Computer 03:01-03:57

The last thing we want to do in this demonstration is restrict a user to a particular computer on the network. The user will be allowed to log on only from that system. Let's say the user, Samantha Carter, is allowed to log in only on the lab computer.

Let's go to Properties. We'll go to Account and click Log On To... As you can see here, the user can currently log in to all computers on the domain. We don't want that because the user should only be in the lab.

We'll set it manually. Here, you type in the computer name after selecting the following computers. You type in the computer's net bios, domain name, or DNS name.

Let's type in 'LabComputer' and click Add. Notice this is the only computer listed now for the user. So, this is the only computer the user can log in to.

You can add more than one computer. Also, you can add other users to the same computer. Let's click OK. Now this user can log in only to that lab computer.

### Summary 03:57-04:21

That's it for this demonstration. In this demonstration, we showed you how to configure user account restrictions. We first looked at how to restrict login times for a given user account.

We disabled and enabled user accounts. We set an expiration date for an account. Then we ended the demonstration by configuring a user account to use a specific computer in the network.

## 6.6.3 Configuring Account Policies and UAC Settings

### Account Policies and UAC Settings 00:00-00:39

In this demonstration, we'll show you actions you can take to harden Windows authentication. First, we'll configure account policies that will be applied to all the users in the domain.

Then, we'll enforce UAC settings. An easy way to enforce UAC setting is to make the configuration changes to a GPO in the domain. When you use a GPO, settings are automatically enforced on each workstation whenever a user logs in to the domain.

Using Group Policy, you make the changes once, instead of having to do it manually on each workstation.

### Password Policies 00:39-01:07

Let's go to Tools > Group Policy Management and right-click Default Domain Policy. Click Edit. That opens the Group Policy Management Editor. Then, let's go to Computer Configuration > Policies > Window Settings > Security Settings > Account Policies > Password Policy.

Here, you see the password policies that are available.

### Minimum Password Length 01:07-01:34

First, let's change the minimum password length from seven characters to a more secure 10 characters.

The value you choose for many of these settings depends on your environment, the organization, and how you want to balance security with ease of use for the users.

If you set the password policy too high, it might be difficult for users to manage. We'll set the password length at 10 because that's a reasonable amount of characters for a password.

### Password History 01:34-01:57

Now, let's go to Enforce Password History. The value is set to 24. This means the system keeps a 24-password history. That prevents users from repeating recent passwords.

This policy makes sure that users can't reuse a password until they have made 24 different password changes. Click OK. That's fine where it's set.

### Maximum Password Age 01:57-02:30

Let's change our maximum password age. Our minimum password age is currently set to one day. We're going to change that to 30 days.

A minimum password length of one day means the user could change the password every day. Some users might try changing the password every day so they get back to an old password after 24 days of passwords changes. We don't want to allow that.

Let's change the minimum password age to 10 days. That means users have to keep a password for 10 days.

### Password Complexity 02:30-02:50

Now, let's look at password complexity requirements. These are basic complexity requirements that Windows has defined.

In most cases when you click the Explain tab, it'll provide more information about the policy setting. Here you can see all the password requirements that Windows has set. So, we'll click OK.

### Account Lockout Policies 02:50-03:39

After configuring password policies, let's configure the account lockout policies. If we go here, the first one we'll look at is the account lockout threshold.

You can see that it's currently set to 0 invalid logon attempts. Let's double-click it. Zero invalid logon attempts means it's not enabled. It's defined, but a policy set at zero is, by definition, not enabled.

Let's change this to 3. That means, after three invalid passwords entries, the account will lock. Click OK.

If you look, this automatically sets the two other values for the account lockout policy to 30 minutes each. Let's go into these. In this case, maybe we want to change these defaults, but let's first look at the reset account lockout counter.

### Reset Account Lockout Counter 03:39-04:17

A reset account lockout counter set to 30 minutes means that a locked out account will reset in 30 minutes and you can try again. It means those two invalid entries won't count toward the same lockout.

You can try every 30 minutes and you won't be locked out. We can make this shorter even, you don't want to lock the account for a long period of time if a user is trying to get logged into an account.

You don't want a user to wait 30 minutes between each attempt. It's an unrealistic amount of time. We'll change this to 10 minutes. Click OK.

If a user is not sure what the password is, the user can try every 10 minutes or have an administrator unlock the account.

### Account Lockout Duration 04:17-04:54

Another important setting is the account lockout duration. Let's say you do have three invalid login attempts in 10 minutes.

The account will not be locked for long, but you want your account lockout policy to be long enough to deter malicious users from waiting for it to reset.

If we set this to 60 minutes, that makes it harder for a malicious user trying to break in. A malicious user will not find it time effective to wait for 60 minutes.

If a user is locked out, the user can call the service desk or an administrator to unlock the account. A significant lockout period helps keep malicious people out of your system.

### User Account Control Settings 04:54-05:43

The next thing we'll look at is the local policies. If we go to Local Policies > Security Options, we can look at the UAC settings.

These settings have a lot to do with administrative approval and certain account control settings that you want in your system.

You can access these later to see what each of these do. If you look, you see that most of these are undefined. You can go in, double-click, define the setting, and enable it.

You can also go to the explanation; it tells you exactly what the setting does.

It's important to know where these are because they specify how your system responds to administrative-level access and system responses. These include installing new software and how the system behaves for elevation prompts for standard users and for administrators.

You can set these policies here.

### Summary 05:43-06:07

In this demonstration, we talked about hardening Windows authentication. We looked at several things you can do with group policies to enforce hardening of our Windows workstations.

We specifically looked at how you can use Group Policy to harden Windows workstations with password policies, account lockout policies, and user account control settings.

## 6.6.5 Hardening User Accounts

### Harden User Accounts 00:00-00:37

In this demonstration, we'll look at things you can do to harden Windows workstation authentication within your network. First, we'll look at restricting local accounts.

We want to ensure that only authorized users have administrative rights to the local Windows operating system. If a workstation is joined to a domain, then we typically use a domain user account to authenticate.

However, we sometimes forget that there are still local user accounts on each individual Windows workstation. One or more of them may have administrative access to the local systems; this presents a security issue.

### Restrict Local Accounts 00:37-01:09

In general, an average end user should have only limited access to the local system. This prevents the user from installing software and making security configuration changes.

The first thing we'll do in this demonstration is lock things down so that only the built-in administrator account and the domain admins group have administrative-level access to the workstations.

In addition, we need to remove any other users who are members of the Administrators group. You could configure these settings manually on each workstation, but that would take a lot of time.

### Use a Group Policy Object (GPO) 01:09-01:35

A better option is to configure these settings in a GPO in the domain. This will allow you to make these configuration settings once and have them automatically enforced on every workstation.

To begin, we'll go to Tools > Group Policy Management > Default Domain Policy and right-click. Go to Edit. Let's make this a little bigger here. Then, go to Preferences.

### Modify Local Administrators Group 01:35-02:59

Let's go to Control Panel > Settings > Local Users and Groups and right-click. This configures the local Windows workstation user accounts, not necessarily domain accounts. Here, under Action, we'll leave it as Update. We'll go to Group Name and select Administrators. We don't want to delete all member users that exist currently.

Deleting all existing users in the admin group to remove administrative access to the system would remove all administrative access to workstations. We do need to have a limited number of users with administrative access.

We'll click Add. Under Name, let's add our built-in administrative account. To do this, all you do is type 'BUILTIN\ADMINISTRATORS'. But, that's not all we want to do.

We also want to add our domain admins to this group. Let's go to Add and we'll use a special variable. We'll enter '%DOMAIN%\'. This puts in a filler.

If we ever have to change our domain name, this will take whatever our domain name is and apply it. It's something to keep in mind. It may save you a lot of time in the future if you do have to change your domain name.

Let's click OK. Now we can see this is created right here. Next, we want to secure the default accounts on each workstation.

### Secure Default Accounts 02:59-04:14

As you know, when you install a Windows workstation, several user accounts are created by default. You define administrator, guest, and user accounts during the installation process.

We want to harden authentication by renaming the default administrator account to something that makes it less obvious that the account is an administrator.

We also want to disable the guest account. It provides a degree of access to the system without a password. We also want to look for any local user account that has the Password never expires option enabled.

All user accounts should have their passwords changed on a regular schedule.

We also want to look for any user accounts that have never been used. The default for creating a new local user account on a Windows workstation should have the option User must change password at next logon enabled.

Therefore, we're going to assume that any user account that has that option marked has never been used because the user has never logged in. We want to get rid of all accounts that have never been used.

To do this, we'll switch over to the Windows 10 workstation. We'll right-click in the window and go to Computer Management.

Now we're going to go to Local Users and Groups > Users. This shows the users currently on the system. Notice we can see our Administrator group.

### Rename Local Administrator Account 04:14-04:50

First, we want to rename our local admin group. Let's go into Properties. The General tab displays. You can see that this account is the main admin account. Let's go back out and right-click. Click Rename.

Let's rename the account Secret account. When you rename this account, you want to make sure it's not something that's obviously the admin account.

You can change it to all sorts of things, as long as it's not obviously the admin account. A lot of code that's written to access, search, and break into systems isn't super-manual. It's normally code added in the administrative login. Changing this one thing can keep a lot of those simple attacks from occurring.

### Delete Unused Accounts 04:50-05:23

The next thing we want to look at are accounts that have never been logged in to. If we double-click this account right here, for Mr. Hank Hill, you can see the option to require password change at login is not checked. That's good.

This means that this user has logged in before. If we look at this one, now you can see this says User must change password at next login.

This means this user has never logged in, which means this account is just sitting here and, possibly, is an account that's not needed. Most likely, that's the case. We'll delete this account because we probably don't need it.

### Disable the Guest Account 05:23-05:55

The next thing we want to look at is the guest account. Notice that the guest account and another default account here both have the black arrow here on them.

That normally means that the account's disabled. We can verify this by double-clicking the account. You see here that the account is disabled. So, that's good.

You want to make sure it's disabled because, as we said before, an enabled guest account allows some level of access into the system. We don't want to allow that at all. We want to make sure users have to authenticate to get into the system.

### Password Never Expires 05:55-06:20

The other thing you want to look for is the Password never expires checkmark. We'll check our TestOut account.

We'll leave this in for our purposes. But normally, you don't want a normal user to have a password that never expires.

If you do have this option enabled on your Windows workstations, you probably want to uncheck it and require that the user has to change the password, just like normal accounts on the domain. For now, we're going to click OK.

### Summary 06:20-06:57

That's it for this demonstration. In this demo, we looked at things you can do to harden Windows authentication for Windows workstations in your network.

First, we looked at limiting local administrator accounts by removing all users who are members of the administrative group unless they are in a built-in admin on the local system or a domain admin.

We ended this demo by looking at securing our default local users. We renamed the local administrative account, we disabled the guest account, we made sure all local users have to change their passwords, and we looked for any user accounts that have never been used.

## 6.6.9 Hardening Authentication Facts

This lesson covers the following topics:

- Hardening authentication methods
- Hardening authentication best practices

### Hardening Authentication Methods

Hardening means to strengthen. You want to make sure your authentication methods are strong so that you can be confident that users accessing your network are who they say they are.

The following table provides various methods for strengthening your authentication.

<table>
   <thead>
    <tr><th scope="col" class="fw-bold">
     Method
    </th>
    <th scope="col" class="fw-bold">
     Description
    </th>
   </tr></thead>
   <tbody>
    <tr>
     <td>
      Password Policies
     </td>
     <td>
      Account policies help you control the composition
            and use of passwords. Password policies include:
      <ul>
       <li>
        Enforce password history - This determines the number of
                unique new passwords that have to be used before an old password
                can be reused. This helps to prevent users from reusing any
                recent passwords.
       </li>
       <li>
        Maximum password age - This requires users to change their
                password after a given number of days.
       </li>
       <li>
        Minimum password age - This determines the number of days that
                a password must be used before the user can change it. This
                prevents users from reverting back to their original password
                immediately after they have changed it.
       </li>
       <li>
        Minimum password length - This identifies the minimum number
                of characters in a password.
       </li>
       <li>
        Password must meet complexity requirements - A complex
                password prevents using passwords that are easy to guess or
                crack. Complex passwords must meet the following minimum
                requirements:
        <ul>
         <li>
          Cannot contain the user's account name or parts of the
                    user's full name that exceed two consecutive characters
         </li>
         <li>
          Must be at least six characters in length
         </li>
         <li>
          Must contain characters from three of the following four
                    categories:
          <ul>
           <li>
            English uppercase characters (A through Z)
           </li>
           <li>
            English lowercase characters (a through z)
           </li>
           <li>
            Base-10 digits (0 through 9)
           </li>
           <li>
            Non-alphabetic characters (for example, !, $, #, or %)
           </li>
          </ul>
         </li>
        </ul>
       </li>
      </ul>
      <p>
       Complexity requirements are enforced when passwords are changed
              or created.
      </p>
     </td>
    </tr>
    <tr>
     <td>
      Multifactor Authentication
     </td>
     <td>
      When possible, multifactor authentication should
            be used. This means using more than one method to authenticate your
            users. End users can be authenticated using three types of factors:
      <ul>
       <li>
        Something you know
       </li>
       <li>
        Something you have
       </li>
       <li>
        Something you are
       </li>
      </ul>
      Robust authentication processes use two or more of these factors.
     </td>
    </tr>
    <tr>
     <td>
      Account Restrictions
     </td>
     <td>
      Account restrictions place restrictions on the use
            of a user account for login. For example, you can:
      <ul>
       <li>
        Prohibit multiple concurrent logins
       </li>
       <li>
        Allow logins only during certain days and hours
       </li>
       <li>
        Allow logins only from specific computers
       </li>
       <li>
        Create expiration dates for user accounts for temporary users
                to prevent them from being used past a certain date
       </li>
      </ul>
     </td>
    </tr>
    <tr>
     <td>
      Account Monitoring
     </td>
     <td>
      Account monitoring can help you detect unusual or
            risky behavior. You should monitor for the following:
      <ul>
       <li>
        Login activity.
       </li>
       <li>
        Suspicious logins for the user (spikes, logins at unusual time
                of day, and/or frequent or failed logins).
       </li>
       <li>
        Remote-access traffic.
       </li>
      </ul>
     </td>
    </tr>
    <tr>
     <td>
      Account Maintenance
     </td>
     <td>
      The following list provides best practices for
            account maintenance:
      <ul>
       <li>
        Delete an employee's account when the employee leaves the
                organization.
       </li>
       <li>
        Disable inactive accounts.
       </li>
       <li>
        Use automatic account expiration when applicable.
       </li>
       <li>
        Restrict remote access only to authorized clients (filtering
                by IP address).
       </li>
      </ul>
     </td>
    </tr>
    <tr>
     <td>
      Limit Remote Access
     </td>
     <td>
      The following precautions should be taken when
            administering remote access:
      <ul>
       <li>
        Allow remote access to the network only for those users who
                need it to perform their duties (not standard for all users).
       </li>
       <li>
        Do not allow remote access clients to connect directly to the
                internal network. Allow remote access clients to connect to a
                DMZ and then monitor the traffic.
       </li>
       <li>
        Restrict remote access only to authorized clients . You can
                filter by IP address.
       </li>
      </ul>
     </td>
    </tr>
    <tr>
     <td>
      Account Lockout Policies
     </td>
     <td>
      Account lockout disables a user account after a
            specified number of incorrect login attempts. Account lockout
            policies include:
      <ul>
       <li>
        Account lockout duration - Specifies the number of minutes a
                locked-out account remains locked out before automatically
                becoming unlocked. When set to 0, an administrator must unlock
                the account.
       </li>
       <li>
        Account lockout threshold - Specifies the number of failed
                logon attempts that causes a user account to be locked out.
       </li>
       <li>
        Reset account lockout counter after - Specifies the number of
                minutes that must elapse after a failed logon attempt before the
                failed logon attempt counter is reset to 0 bad logon attempts.
                For example, if this value is set to 60 minutes and the account
                lockout threshold is set to 5, the user can enter up to four
                incorrect passwords within one hour without the account being
                locked.
       </li>
      </ul>
      <p>
       Account lockout can be used to prevent attackers from guessing
              passwords, but it can also be used maliciously to lock an account
              and prevent a valid user from logging in.
      </p>
     </td>
    </tr>
   </tbody>
  </table>

### Hardening Authentication Best Practices

When controlling user account and password security, be aware of the following:

<ul>
   <li>
    For large environments, implement a password management system with a
        self-service password reset management system. This allows a user to
        change his or her own password and ensures that only he or she knows it.
        In a system where administrators hand out passwords that users cannot
        change, passwords lack security. In this type of arrangement, no matter
        how complex the password is, more than one person knows what it is. This
        can affect the security of the system.
   </li>
   <li>
    Implement account auditing to track incorrect login attempts. Small
        numbers of incorrect logon attempts occur naturally as users mistype or
        forget passwords. Large numbers of incorrect login attempts could
        identify a potential hacker trying to guess passwords.
   </li>
   <li>
    Scan systems to identify unused user accounts or accounts with blank
        passwords.
   </li>
   <li>
    When implementing account lockout and account policies on Microsoft
        systems:
    <ul>
     <li>
      The Local Security Policy controls policies for user accounts that
            are defined on a local system.
     </li>
     <li>
      Policy settings in Group Policy are linked to the domain control
            settings for all user accounts in the domain. Settings defined at
            other levels in Group Policy do not affect password or account
            lockout settings.
     </li>
    </ul>
   </li>
   <li>
    Disable and/or remove unnecessary accounts installed on the operating
        system by default, or disable specific user accounts that are no longer
        needed.
   </li>
   <li>
    Prohibit the use of generic user accounts. Generic accounts, such as
        guest or administrator accounts in Windows, should be disabled.
   </li>
   <li>
    Prohibit the use of shared user accounts.
    <br>
    Shared accounts:
    <ul>
     <li>
      Increase the likelihood of the account being compromised. Because
            the account is shared, users tend to take security for the account
            less seriously. For example, one organization found that the
            passwords for shared user accounts proliferated to the point where
            hundreds of current and former employees knew them.
     </li>
     <li>
      Make password management more difficult. Because password changes
            must be communicated to multiple users, many system administrators
            avoid making any password changes at all. If the password is well
            known, employees (including former employees that no longer need
            access to the account) may still know the password.
     </li>
     <li>
      Reduce responsibility for the account. Because users view the
            account as communal, users may do things with the account that they
            would not do with their personal account.
     </li>
     <li>
      Destroy audit trails for the account. Because multiple users are
            associated with the account, it can be difficult to identify who is
            actually responsible for actions performed with the account.
     </li>
     <li>
      Make it difficult to monitor the account for unusual activity.
            Because multiple users are associated with the account, it is much
            more difficult to define behaviors that are normal and behaviors
            that are abnormal. This is problematic because identifying abnormal
            account activity is key to detecting attacks on your systems.
     </li>
    </ul>
   </li>
  </ul>

## 6.6.10 Configuring Smart Card Authentication

### Configuring Smart Card Authentication 00:01-00:20

In this demonstration, we are going to look at using Group Policy to enforce smart card authentication on computers in a domain. We will do this by making it so all employees in the research and development department and all administrators need to have their smart card in order to log on to their computers.

### Creating Group Policy Enforce Smart Card Authentication 00:20-01:54

So, first, let's start by working on the first group, the research and development employees. So, in Server Manager, we are going to go to Tools. We are going to open Group Policy Management. We are going to go here, to our Research and Development OU. You can see, in this domain, we already have that OU created.

Notice that we have already created a Group Policy Object and linked it to the Research and Development Department OU. So, we are going to right-click this Group Policy object, and we are going to click Edit to open Group Policy Management Editor.

Now we need to enable two different policies in this Group Policy object to enforce smart card authentication. First, we need to locate a policy named Interactive Log on Requires Smart Card and enable it. After that, we need to set interactive log on smart card removal behavior to force log off.

So, let us enable the first policy. Because these are computer policies and not user policies, we will expand policies under Computer Configuration. We are going to navigate to Windows > Security Settings > Local Policies, and then we are going to go to Security Options. Now we need to scroll down to Interactive Log on Session and locate the policy titled Requires Smart Card.

We are going to double-click the policy. So, first we are going to define this policy, and then we are going to enable it. If we click OK, now we have just specified that any research and development employee is required to have a smart card in order to log in to their local machine.

### Enforcing the Group Policy 01:54-02:58

So, the next policy we need to look at is called Interactive Logon Removal Behavior. As you can see, it is the one right below it. Double-click that policy. Now we define this policy. We select Force Logoff. We are going to click OK.

Now we can close the Group Policy Management Editor at this point. Now we can look and see if the GPO is enforced or not. So, if you look right here, you can see that the GPO Enforced is labeled as No, so that means that, currently, the GPO is not enforced.

There is no little lock icon, meaning that the policy is not enforced. So, know that, when a GPO is enforced, it means that the settings we specify here in the GPO cannot be overruled by another GPO that may be linked to a lower organizational unit within the OU, where the GPO is linked.

So, if we do not enforce it, another GPO, for example, like one in this sub-OU, could potentially override the settings that we defined in our RND GPO, right here. Since we do not want that to happen, we want this GPO to be enforced.

Enforcing Group Policy for a Group of Users 02:58-05:04
We are going to right-click on the GPO and select Enforced. Now the GPO is enforced. Now, no matter what we do at lower layers within this OU, this GPO will always be enforced.

And the next time one of our Research and Development employees tries to log in to their local workstations, they are going to have to have a smart card in order to do so.

And if they have their smart card, then they can use it to authenticate. And then, if they remove the smart card, they will automatically be forced to log off. So, now, let us do the same thing for our administrative users.

We are going to do this through Active Directory Computers and Users. Let us go ahead and close the Group Policy Management window. We are going to go to Tools. We are going to go to Active Directory Users and Computers.

Now we are going to go to our Admins OU I have created. Within the Admins OU are all of our administrative users in the domain. Now we want these users to be forced to use smart card authentication. So, let us click, the first user, and we are going to highlight both of the users. If we right-click both of these at the same time, as they are both highlighted, it will open the Properties, for all of the users at once.

If you have four or five users, it can be really helpful, so you do not have to go through and do it to each account. Now we are going to click on the Account tab. You can see, down here, we are going to scroll down to Smart Card is Required for Interactive Logon. Select that.

If we click OK, that change is made for all of the admin users here. There is one more account we need to do this for, and that is the Default Administrator User account that is created when Active Directory is initially installed. We will go into our Users OU.

You can see the default account here. We are going to right-click, go to Properties, go to Account, and we can scroll down until Smart Card is Required for Interactive Login. We are going to hit OK.

Now, when any of these admin users try to authenticate to their local machine using a domain account, they will be required to have a smart card for authentication.

### Summary 05:04-05:38

That is it for this demonstration. In this demo, we talked about enforcing the use of a smart card for authentication to the local computer systems in our domain. We first edited the group policy associated with an OU in the domain, and we required smart card authentication for any users in that container.

We made it so that if they remove their smart card, they will be forced to log off immediately. And then we required a smart card for computer authentication for all of the administrative users in the domain.

## 6.6.12 Smart Card Authentication Facts

This lesson covers the following topics:

- Smart cards
- Smart card benefits and weaknesses

### Smart Cards

Smart cards are plastic cards similar to credit cards that have an embedded memory chip that contains encrypted authentication information. Be aware that smart cards:

<ul>
   <li>
    Use public key infrastructure (PKI) technology to store digital signatures, cryptography keys, and identification
      codes.
   </li>
   <li>
    Can authenticate a user when used in conjunction with a smart card reader connected to a computer system.
   </li>
   <li>
    Typically have RAM, ROM, programmable ROM, and a microprocessor integrated within the card itself.
   </li>
   <li>
    Have their own processor, allowing the card to perform its own cryptographic functions.
   </li>
   <li>
    Use a serial interface to connect to the card reader.
   </li>
   <li>
    Are powered externally by the smart card reader.
   </li>
   <li>
    Are generally considered to be tamper-proof.
   </li>
   <li>
    Can be divided into two categories:
    <ul>
     <li>
      Contact smart cards: these cards use a gold-plated contact pad that must physically touch the contact pad on a smart
        card reader.
     </li>
     <li>
      Contactless smart cards: these cards do not require physical contact with the reader device. Instead, these cards use
        Radio Frequency Identification (RFID) technology to communicate with the smart card reader. An antenna is wound around the
        edge of the card and activated when the card is within proximity of the card reader.
     </li>
    </ul>
   </li>
  </ul>

### Smart Card Benefits and Weaknesses

Key benefits of smart cards include the following:

<ul>
   <li>
    They provide tamper-resistant storage for a user's private key and other personally identifying information
      (PII).
   </li>
   <li>
    They isolate security-related operations from the rest of the system.
   </li>
   <li>
    They allow security credentials to be portable.
   </li>
  </ul>

Smart cards are subject to the following weaknesses:

<ul>
   <li>
    Microprobing - this is the process of accessing the chip surface directly to observe, manipulate, and interfere with the
      circuit.
   </li>
   <li>
    Software attacks - these exploit vulnerabilities in the card's protocols or encryption methods.
   </li>
   <li>
    Eavesdropping - this captures transmission data produced by the card as it is used.
   </li>
   <li>
    Fault generation - this deliberately induces malfunctions in the card.
   </li>
  </ul>
