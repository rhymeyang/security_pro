---
lang: zh-CN
title: Section 8.2 Wireless Attacks
description: some description
---

As you study this section, answer the following questions:

<ul>
    <li>
     What is the difference between bluejacking and bluesnarfing?
    </li>
    <li>
     What is an initialization vector used for?
    </li>
    <li>
     How can you discover rogue access points?
    </li>
    <li>
     What is the difference between passive and active radio frequency identification (RFID) tags?
    </li>
   </ul>

In this section, you will learn to:

<ul>
    <li>
     Use wireless attack tools.
    </li>
    <li>
     Crack Wi-Fi encryption with Aircrack-ng.
    </li>
    <li>
     Detect rogue hosts.
    </li>
    <li>
     Configure rogue host protection.
    </li>
   </ul>

The key terms for this section include:

<table class="terms">
   <thead>
    <tr><th class_="firstTableHeader" scope="col" class="fw-bold">
     Term
    </th>
    <th scope="col" class="fw-bold">
     Definition
    </th>
   </tr></thead>
   <tbody>
    <tr>
     <td>
      Rogue access points
     </td>
     <td>
      Any unauthorized access point added to a network.
     </td>
    </tr>
    <tr>
     <td>
      Initialization vector (IV)
     </td>
     <td>
      A seed value used in encryption. The seed value and the key are used in an encryption algorithm to
          generate additional keys or encrypt data.
     </td>
    </tr>
    <tr>
     <td>
      Radio frequency identification
     </td>
     <td>
      RFID uses radio waves to transmit data from small circuit boards called RFID tags to special
          scanners.
     </td>
    </tr>
    <tr>
     <td>
      Near Field Communication
      <br>
      (NFC)
     </td>
     <td>
      NFC allows two-way communication between two devices. The devices must be within a few centimeters of
          each other. NFC is a newer technology that is built on RFID.
     </td>
    </tr>
    <tr>
     <td>
      Interference
     </td>
     <td>
      A signal that corrupts or destroys a wireless signal. Interference can affect communication of access points and other wireless
          devices.
     </td>
    </tr>
   </tbody>
  </table>

This section helps you prepare for the following certification exam objectives:

<table class="objectives">
   <thead>
    <tr><th class_="firstTableHeader" scope="col" class="fw-bold">
     Exam
    </th>
    <th scope="col" class="fw-bold">
     Objective
    </th>
   </tr></thead>
   <tbody>
    <tr>
     <td>
      TestOut Security Pro
     </td>
     <td>
      2.0 Physical and Network Security
      <ul>
       <li>
        Harden Network Devices
        <ul>
         <li>
          Configure and Access a Wireless Network
         </li>
        </ul>
       </li>
      </ul>
     </td>
    </tr>
    <tr>
     <td>
      CompTIA Security+ SY0-601
     </td>
     <td>
      1.4 Given a scenario, analyze potential indicators associated with network attacks.
      <ul>
       <li>
        Wireless
        <ul>
         <li>
          Evil twin
         </li>
         <li>
          Rogue access point
         </li>
         <li>
          Bluesnarfing
         </li>
         <li>
          Bluejacking
         </li>
         <li>
          Disassociation
         </li>
         <li>
          Jamming
         </li>
         <li>
          Radio frequency identifier (RFID)
         </li>
         <li>
          Near field communication (NFC)
         </li>
         <li>
          Initialization vector (IV)
         </li>
        </ul>
       </li>
      </ul>
      <p>
       3.4 Given a scenario, install and configure wireless security 
		settings.
      </p>
      <ul>
       <li>
        Installation considerations
        <ul>
         <li>
          Site surveys
         </li>
        </ul>
       </li>
      </ul>
      <p>
       4.1 Given a scenario, use the appropriate tool to assess organizational security.
      </p>
      <ul>
       <li>
        Packet capture and replay
        <ul>
         <li>
          Wireshark
         </li>
        </ul>
       </li>
      </ul>
     </td>
    </tr>
   </tbody>
  </table>

## 8.2.1 Wireless Attacks

### Wireless Attacks 00:00-00:19

Because wireless networks use an unbounded communication method, they're especially vulnerable to attacks. This includes all types of wireless networks, as in Wi-Fi, Bluetooth, RFID, and even NFC. In this lesson, I'm going to go over the various attacks that threaten wireless networks.

### Wi-Fi Attacks 00:19-00:29

Because network security is a top priority, it's common for network administrators to implement stringent rules and limit website access. Some users find this very frustrating.

### Rogue Access Point 00:29-01:20

To try to evade these rules, users sometimes install an access point on their own computer. This is known as a soft access point. A network hacker who has gained access to a network, perhaps using MAC spoofing, might do the same. This is called a rogue access point or an unauthorized association.

Here's the big problem—most employees don't understand the importance of securing their soft access point or even how to do it. So they just leave it open to hackers. When an attacker discovers an access point, they're able to run various types of vulnerability scanners from outside the company, perhaps from a car or adjacent building or even from several miles away. Keep in mind that if a hacker can gain some type of physical access to your company, they can also hide a physical rogue access point as well. This is often done by configuring an extremely compact and powerful hardware device called a Raspberry Pi as their access point.

### Evil Twin Attack 01:20-02:25

A rogue access point that's placed on the network by a malicious attacker can be used to run what's called an evil twin attack. Here's how this works—say your organization currently has a wireless network with a SSID of MyCompanyWiFi. The attacker configures their own access point with the same SSID and places it near the organization's building. Then the attacker uses a jamming or disassociation attack to knock users off the legitimate network. When users reconnect to the network, they're now connecting to the attacker's access point instead.

Once a victim is connected to a rogue access point, the attacker can capture all data flowing through it. The user shouldn't notice anything different since their internet is still running like normal. These attacks are extremely dangerous as the attacker gains immediate access to all sorts of sensitive information.

To defend against these attacks, you should perform regular site surveys to locate any rogue access points. Your wireless networks encrypt data, which helps protect against sniffing. But some older standards, like WEP, are vulnerable due to improperly configured initialization vectors, or IVs.

### Initialization Vectors 02:25-03:46

When we encrypt data, we use a secret key that only we know. If we use the same key for everything we encrypt, it won't take long for the key to be compromised. This is where initialization vectors can help out. The IV is a random string that's added to the key to create a different key for each encryption process. Unfortunately, if we don't configure the IV properly, it can open us up to attacks.

Wired Equivalent Privacy, or WEP, was one of the first wireless security protocols that used IVs to help with encryption. The problem, though, was the IV was only 24 bits long and the key was 40 bits. This meant there was only approximately 16 million different IVs that could be generated. This may sound like a lot, but it actually meant that an IV would be repeated at least once every 4096 packets. It doesn't take much time to get 4096 packets, and attackers were able to develop programs that would flood the network with packets to find matching IVs. Once an attacker gets multiple IVs, they can begin decrypting the encryption key. After that, all communication is open and no longer secure.

No networks should use WEP anymore. Newer wireless standards such as WPA-2 don't even use IVs for encryption. For many of these wireless attacks to work, the attacker needs to kick everyone off the legitimate network and prevent them from reconnecting. They attempt this with jamming attacks or disassociation attacks.

### Jamming Attack 03:46-04:08

A Wi-Fi jamming attack requires a special device that works by analyzing the spectrum used by wireless networks and then transmitting a powerful signal on the same frequencies. Basically, the jammer tries to be the loudest voice in the room so nearby devices can't see the legitimate wireless network. The hope is that they disconnect and are unable to reconnect again. Jamming devices are illegal and difficult to come by, though.

### Disassociation Attack 04:08-04:50

A disassociation attack, on the other hand, can be performed with a laptop. This is also know as a deauthentication attack. When a device connects to a wireless network, special unencrypted management packets are sent back and forth. A deauthentication attack takes advantage of this unencrypted process by sending fake, malicious deauthentication packets to kick people off the network. The attacker can select individual users or kick everyone off at once. Jamming and deauthentication attacks have the same end result, but they use very different methods.

Wi-Fi is used everywhere today and attackers are always working on methods to exploit weaknesses. Yet another wireless technology that can be susceptible to attacks is Bluetooth.

### Bluetooth Attacks 04:50-05:09

From headphones and speakers to watches, fitness devices, automobiles, and even refrigerators, Bluetooth devices are heavily integrated into our daily lives. This makes these devices attractive to malicious attackers. An attacker can gather all sorts of personal data and even take over our devices' embedded cameras and microphones.

### Bluejacking 05:09-05:25

One common Bluetooth attack is Bluejacking. When performing a Bluejacking attack, he or she looks for another Bluetooth device that's discoverable and sends unwanted messages to it. Attackers can't gain control of a device or steal any data so Bluejacking is more annoying than harmful.

### Bluesnarfing 05:25-05:49

Bluesnarfing, on the other hand, can be harmful. Bluesnarfing is when an attacker exploits a vulnerability in the OBject EXchange Protocol, or OBEX Protocol, to pair to a target device. Once paired, he or she is able to access all the victim's device data and then disconnect without leaving a trace.

The best defense against both of these attacks is to only enable Bluetooth when you need to and to not leave devices in Discovery Mode.

### RFID Attacks 05:49-06:44

Radio frequency identification, or RFID, uses radio waves to transmit data from small circuit boards called RFID tags to special scanners. Active RFID tags, like those seen in a car's toll pass, have on-board batteries and can send signals over a long distance. Passive RFID tags, which are used in ID badges and credit cards, aren't powered. These tags instead rely on the RFID scanner's transferred energy.

A malicious attacker can build their own scanner to target these RFID tags. If an attacker can get close enough, they can scan the RFID chip and clone it. An attacker might also eavesdrop on the communication between the chip and reader and steal the data that way.

To protect against these attacks, RFID chips often operate at different frequencies, making it more difficult for an attacker to quickly complete a scan. Also, because most of these chips are passive, an attacker has to get extremely close for it to work. Of course, this would make them pretty obvious to everyone.

### NFC Attacks 06:44-07:10

Near field communication, or NFC, is a newer technology that's built on RFID. NFC allows two-way communication between two devices. But they must be within a few centimeters of each other.

NFC is what allows us to use our smartphones to pay for items at the store. We can also use NFC to transfer files between two phones if they're right next to each other. NFC is vulnerable to the same types of attacks as RFID, but it requires the attacker to be incredibly close.

### Summary 07:10-07:39

That'll wrap up this lesson. In this lesson, we looked at some different wireless communications attacks. We first looked at Wi-Fi and rogue access points, evil twin attacks, how an IV can be exploited, and also how jamming and disassociation attacks work. Then we looked at Bluetooth attacks, including Bluejacking and Bluesnarfing. Finally, we covered how RFID and NFC work and the security concerns associated with both of these devices.

## 8.2.2 Wireless Attack Facts

Because wireless networks communicate using radio waves, they are vulnerable to attack. Common attacks on wireless networks include Wi-Fi, Bluetooth, and radio frequency identification/near-field communication (RFID/NFC) attacks.

This lesson covers the following topics:

- Wi-Fi attacks
- Bluetooth attacks
- RFID/NFC attacks

### Wi-Fi Attacks

Wi-Fi networks are practically everywhere. Many organizations have setup and configured Wi-Fi networks. If not configured properly, these networks can be susceptible to attack. The following table explains common Wi-Fi attacks:

<table>
    <thead>
     <tr><th class_="firstTableHeader" scope="col" class="fw-bold">
      Wi-Fi Attack
     </th>
     <th scope="col" class="fw-bold">
      Description
     </th>
    </tr></thead>
    <tbody>
     <tr>
      <td>
       Rogue access points (AP)
      </td>
      <td>
       A rogue AP is any unauthorized AP added to a network. Rogue APs can allow
        the unauthorized capture of credentials and other sensitive information. Attackers also use this type of attack to conduct phishing and
        man-in-the-middle attacks.
       <p>
        An example of a rogue AP is an employee with access to the wired network installing a wireless AP on a free port. The employee may do this because of poor
          signal strength. This rogue AP provides access to the network. If the AP has not been secured to the same standards as an official AP, it is likely to be targeted by an attacker.
       </p>
       <p>
        The following actions can be taken to protect against rogue APs:
       </p>
       <ul>
        <li>
         Put APs in separate virtual LANs.
        </li>
        <li>
         Use site survey tools to identify hosts and APs on the wireless network.
        </li>
        <li>
         Check connected MAC addresses to identify unauthorized hosts.
        </li>
        <li>
         Analyze wireless traffic to identify rogue hosts.
        </li>
        <li>
         Disconnect any rogue access points you discover.
        </li>
       </ul>
      </td>
     </tr>
     <tr>
      <td>
       Evil twin attack
      </td>
      <td>
       Rogue APs placed by an attacker can be used to run a evil twin attack. In this
        attack:
       <br>
       <ul>
        <li>
         The rogue AP is configured to mimic the legitimate network.
        </li>
        <li>
         The attacker uses a jamming or disassociation attack to knock users off the legitimate network.
        </li>
        <li>
         When users re-connect to the network, they connect to the attacker’s AP.
        </li>
        <li>
         The attacker can monitor and capture all data that moves through the rogue AP.
        </li>
       </ul>
       <p>
        To protect against this attack, conduct an radio frequency (RF) noise analysis to detect a malicious rogue AP that uses jamming
        to force wireless clients to connect to it, instead of legitimate APs.
       </p>
      </td>
     </tr>
     <tr>
      <td>
       Initialization vector (IV) attack
      </td>
      <td>
       An initialization vector is a seed value used in encryption. The seed value and the key are used
        in an encryption algorithm to generate additional keys or to encrypt data.
       <p>
        Wired Equivalent Privacy (WEP) encryption reuses initialization vectors. The reuse of IVs makes it easy for attackers 
		to crack them. This is known as an 
        IV attack. Be aware that:
       </p>
       <ul>
        <li>
         The WEP IV is 24-bits and the key is 40-bits. This allows for approximately 16 million IVs. An IV is repeated at least once every 4096 packets.
        </li>
        <li>
         Hackers developed programs that flood the network with packets, allowing them to quickly find matching IVs.
        </li>
        <li>
         Once enough IVs are obtained, the attacker can decrypt the encryption key.
        </li>
        <li>
         WEP encryption can be cracked in as little as 1-2 minutes.
        </li>
       </ul>
       <p>
        Due to the vulnerabilities of WEP, you should no longer use it. Newer standards such as WPA2 and WPA3 do not use IVs in
        the encryption process.
       </p>
      </td>
     </tr>
     <tr>
      <td>
       Jamming attack
      </td>
      <td>
       With wireless networks, interference is a signal that corrupts or destroys the wireless signal sent by
        APs and other wireless devices. Non-malicious interference includes the following:
       <ul>
        <li>
         Electromagnetic interference (EMI) is interference caused by motors, heavy machinery, and fluorescent lights.
        </li>
        <li>
         Radio frequency interference (RFI) is interference on the radio channel. It is caused by nearby wireless devices using the same channel, cordless phones, or microwave ovens.
        </li>
       </ul>
       <p>
        Adjacent channels on wireless APs have a small degree of overlap. To avoid interference with other wireless
        APs within the same vicinity, use channels that don't  overlap neighboring wireless APs.
       </p>
       <p>
        Some interference is malicious in nature, designed to disrupt wireless network communications. Malicious interference is
        sometimes referred to as jamming. In a jamming attack, a transmitter is tuned to the same frequency and the same type of modulation as the wireless network. The jamming signal overrides the legitimate wireless network radio signals at the
        receiving devices.
       </p>
       <p>
        The following list describes different types of jamming signals that can be used to disrupt a Wi-Fi network.
       </p>
       <ul>
        <li>
         <i class="fs-italicize">
          Spark jamming
         </i>
         is the most effective type of Wi-Fi interference attack. It repeatedly blasts receiving equipment with
          high-intensity, short-duration RF (radio frequency) bursts at a rapid pace. Experienced RF signal technicians can usually identify this
          type of attack quickly because of the regular nature of the signal.
        </li>
        <li>
         <i class="fs-italicize">
          Random noise jamming
         </i>
         produces radio signals using random amplitudes and frequencies. While not as effective as a
          spark attack, the random noise attack is harder to identify due to the intermittent and random
          nature of the interference. In fact, this type of signal is frequently mistaken for background radio noise that occurs naturally.
        </li>
        <li>
         <i class="fs-italicize">
          Random pulse jamming
         </i>
         uses radio signal pulses of random amplitude and frequency to interfere with a Wi-Fi
          network.
        </li>
       </ul>
      </td>
     </tr>
     <tr>
      <td>
       Disassociation/deauthentication attack
      </td>
      <td>
       Wireless devices are vulnerable to deauthentication (deauth) and disassociation attacks because the
        802.11 standard allows devices to be authenticated with multiple APs at once. When a device connects to a
        wireless network, special unencrypted management packets are sent back and forth. Deauthentication and disassociation attacks take advantage of these
        packets to disconnect devices from a network. Be aware that:
       <br>
       <ul>
        <li>
         To execute a deauth attack, the attacker pretends to be the wireless router the device is connected to. The attacker disconnects
          the device from the network. When the user tries to reconnect, the attacker can intercept the user's
          information.
        </li>
        <li>
         Disassociation attacks are similar. Instead of disconnecting a user, disassociation tricks the user into giving the fake router responsibility for forwarding packets.
        </li>
       </ul>
      </td>
     </tr>
    </tbody>
   </table>

### Bluetooth Attacks

Bluetooth is designed to allow devices to communicate within a personal area network (PAN) of close proximity. PAN devices include cell phones, personal digital assistants (PDAs), printers, mice, and keyboards.

Bluetooth:

<ul>
    <li>
     Is designed for distances longer than infrared (IR) communication and has lower power consumption.
    </li>
    <li>
     Requires that devices be in discovery mode to find each other and synchronize.
    </li>
    <li>
     Operates in the 2.4 GHz range and uses adaptive frequency hopping (AFH).
    </li>
   </ul>

Eavesdropping is difficult because Bluetooth implements authentication and key derivation with custom algorithms based on the SAFER+ block cipher. It also uses the E0 stream cipher for encrypting packets. Bluetooth is one of the most secure protocols for mobile device communication, but it is susceptible to the following attacks:

<ul>
    <li>
     <i class="fs-italicize">
      Bluejacking
     </i>
     looks for nearby devices that are in discovery mode and sends unwanted messages. The attacker is unable to
    steal any data. This attack is more annoying than harmful.
    </li>
    <li>
     <i class="fs-italicize">
      Bluesnarfing
     </i>
     exploits a vulnerability in the object exchange (OBEX) protocol that allows an attacker to pair to the target device. Once
    paired, the attacker can view the calendar, emails, text messages, contact lists, and other data on the device. Many Bluetooth
    devices have built-in features to prevent bluesnarfing, but it is still a known vulnerability.
    </li>
   </ul>

To mitigate the risks of Bluetooth attacks, enable Bluetooth only when needed and make sure discovery mode is turned off except for when pairing devices.

### RFID/NFC Attacks

RFID uses radio waves to transmit data from small circuit boards, called RFID tags, to special scanners. There are two types of RFID tags:

<ul>
    <li>
     Active RFID tags have onboard batteries and can send signals over a long distance. Road toll passes and other type passes use active RFID.
    </li>
    <li>
     Passive RFID is not powered and relies on the energy of the scanner to transmit data. These tags are seen in ID
    badges, credit cards, and similar devices.
    </li>
   </ul>

RFID systems are vulnerable to various kinds of attacks, including:

<table>
    <thead>
     <tr><th class_="firstTableHeader" scope="col" class="fw-bold">
      RFID Attack
     </th>
     <th scope="col" class="fw-bold">
      Description
     </th>
    </tr></thead>
    <tbody>
     <tr>
      <td>
       Eavesdropping
      </td>
      <td>
       An attacker uses an RFID reader to listen to conversations between a tag and the intended
    reader.
      </td>
     </tr>
     <tr>
      <td>
       Man-in-the-middle (MTM)
      </td>
      <td>
       An attacker intercepts a signal from an RFID tag, then manipulates the signal before
    sending it to the intended recipient. This kind of attack is frequently used to take down a system.
      </td>
     </tr>
     <tr>
      <td>
       Denial of service (DOS)
      </td>
      <td>
       An attacker blocks radio signals or jams the system with interfering noise.
      </td>
     </tr>
     <tr>
      <td>
       Cloning and spoofing
      </td>
      <td>
       An attacker creates a copy of an existing tag and uses the fake tag to gain access to
    a secure system.
      </td>
     </tr>
    </tbody>
   </table>

To protect against these attacks, RFID chips often operate at different frequencies. This makes it more difficult for an attacker to find and scan them.

Near Field Communication (NFC) is a newer technology that is built on RFID. NFC allows two-way communication between two devices. The devices must be within a few centimeters of each other. Although NFC transmission distances are very short, transmissions are susceptible to several malicious attacks, including:

<ul>
    <li>
     A lost NFC device allows anyone who finds it to access NFC resources.
    </li>
    <li>
     NFC signals can be jammed by malicious interference.
    </li>
    <li>
     NFC devices and readers are susceptible to man-in-the-middle exploits, where an attacker captures transmissions from the
    reader and forwards them on to the device, potentially reading and/or modifying data in transit.
    </li>
    <li>
     NFC devices and readers are susceptible to relay attacks. An attacker can capture NFC data in transit and use
    the information to masquerade as the original device.
    </li>
   </ul>

## 8.2.3 Using Wireless Attack Tools

### Wireless Attack Tools 00:04-00:17

In this demo, we're going to take a look at some commonly used wireless-cracking tools.

We'll also show you how easy it is to bypass common security through obscurity techniques, such as hiding the SSID and using MAC address filtering.

### Kali Linux Tools 00:17-00:53

For this demo, we'll be using a Linux distribution called Kali. Kali Linux is a self-contained Linux distribution that contains many different tools. Under Applications here, you can see a list of the tools that Kali offers, including wireless attack tools.

A few of these tools use a graphical user interface, such as Fern Wi-Fi Cracker. This allows you to perform several different wireless attacks from an easy-to-use GUI. But most of them are just are command line tools.

When we click on them, we're presented with information about the tool itself and how to use it, like we see here with aircrack-ng. We also see a quick guide on how to use the tool and some examples.

Using the Internet to Find Tools 00:53-02:17
Although Kali has a lot of tools already bundled with it, there are other tools that hackers like to use. A web search will usually lead you to a list of some of the latest tools out there. I'll jump over to my Windows 10 machine for a minute and look at a few websites.

I did a quick search and found this article that list some of the most popular tools. It's a few years old but still relevant. Some of the tools listed are Aircrack, Airsnort, and Cain & Able. Cain & Able for example hasn't really been updated for a few years, but it still works for a lot of things. Wireshark is good for capturing all types of traffic and is a highly recommended tool for anyone working in networking or security.

Another site you should be aware of is wigle.net. This site keeps a database of all the open Wi-Fi networks that people across the world find.

All information on this website has been submitted by users and is constantly being updated. If we zoom out, we can see just how many wireless networks have been identified as open.

Now, a lot of these open networks could be coffee shops, hotels, or other public places. But some are simply unwitting households who haven't properly set up their wireless network.

This is why it's so important to understand how to properly secure a wireless network. Hackers are constantly looking for open or easy-to-crack networks. The reason for looking for these networks could be as benign as simply wanting internet access. However, others use open networks for illegal activities.

### Hacking a Wireless Network 02:17-02:52

Let's go back to our Kali system and look at how easy it is to bypass weak wireless security practices. I've already set up a wireless network for this demonstration.

The wireless network has been configured to not broadcast its SSID. The Wi-Fi network doesn't have any authentication or encryption implemented. But it is using MAC address filtering. Let's see how easy it is to bypass this security through obscurity techniques.

If we go to our wireless networks up here, we can see a list of available ones. The network we want to connect to isn't listed. Remember, it isn't broadcasting its SSID. But that won't stop us, right?

Changing Wireless Interface to Monitor Mode 02:52-03:48
Let's open a terminal session. The first thing we need to do is change our wireless interface to Monitor mode. To do this, we need to identify the name of the wireless card. So we type ‘ifconfig' and press Enter. With newer versions of Kali you might need to type ‘ip address show'.

Here's our wireless interface—wlan0. Now let's take the interface down. Then we'll use the ‘iwconfig' command to switch it to Monitor mode. After that, we'll bring the interface back up.

The next thing we need to do is make sure there aren't any processes that'll conflict with the tool we're going to use. We do this by typing the ‘airmon-ng check wlan0' command.

We can see there are two processes that have the potential to affect our tool. I'm only going to kill one of these as the other one shouldn't affect us. I'll go ahead and do that. Now let's clear the screen.

### Capturing Signals with Airodump 03:48-04:50

Now let's use the airodump tool. What this tool does is capture all the wireless signals floating through the air and extract information from them.

If you remember, Monitor mode allows a wireless interface to capture all wireless signals, not just the ones intended for the device. The airodump tool captures that information and shows it to us.

The wireless network we want to connect to is right here—hiddenWireless. This column displays the SSIDs of the wireless networks in range of our device. We can also see the authentication method being used and the device's encryption algorithm, cipher, and MAC address.

Let's mark hiddenWireless since it's the network we're trying to get into. After that, I'm going to change this tool's view to only show hosts but not access points.

This is a list of all hosts that are in range. Notice this one in red. This line is highlighted because it's connected to the hiddenWireless access point that we previously selected.

Notice here that we can see the MAC address of both the access point and the host. This is the information we need since MAC address filtering is enabled.

### Spoofing a MAC Address 04:50-05:38

In order to connect to this wireless network, I need to spoof my MAC address. I need to change the MAC address of my wireless interface card to match this one. This is actually very easy.

First, we need to bring the wireless interface down. Then we use the ‘macchanger' command. The ‘-m' option is used to specify the new MAC address we want.

Let's copy the MAC address here and paste it. Then we specify the interface, and we have a new MAC address. Let's bring the interface back up and verify our MAC address.

Notice we can see our hard-coded MAC address as well as the MAC address being spoofed, which matches the client connected to the Wi-Fi network. And if we quickly use the ‘ifconfig' command, we can also see our MAC address here.

### Connecting to the Network 05:38-06:57

Now let's connect to the Wi-Fi network. First, we bring the interface down and use the ‘iwconfig' command to change our mode to Managed and specify the SSID of the wireless network we're connecting to. Now we bring the interface back up.

Now let's get an IP address using the ‘dhclient' command. And success! We're assigned an IP address from the access point. We can ping the access point, which has an IP address of 10.10.10.1, to verify that we're connected. And we are.

I know the login information for this access point, so I'm going to connect to it to show you the configuration. Chances are you probably wouldn't know this information unless the person left the default login on the AP.

On the Wireless page, notice that the SSID broadcast is disabled. And on the Wireless MAC filter tab, we can see that this feature is enabled and there's a single MAC address on the list.

As you can see, with a little practice and research, it's pretty easy to crack a wireless network that uses weak security practices. I'd like to point out that a lot of these tools in this Linux distribution are made to crack even WPA and WPA2 networks.

### Summary 06:57-07:06

That's it for this demo. In this demo, we looked at some wireless hacking tools.

## 8.2.4 Crack Wi-Fi Encryption with Aircrack-ng

### Crack Wi-Fi Encryption with Aircrack-ng 00:00-00:36

In this demo, we're going to work with the aircrack-ng suite. This suite is often used to gain unauthorized access to wireless networks using WEP, WPA, or WPA2 security that uses a pre-shared key. We're going to use WPA2 with a pre-shared key, but the methodology is the same for WEP and WPA.

The aircrack-ng suite focuses on performing brute force attacks on a captured wireless handshake. It comes pre-loaded on Kali Linux. Since it's a command line tool, we're going to open a terminal to work in. Let's get started.

Enable Monitor Mode on a Wireless Adaptor 00:36-01:46
The first thing we need to do is allow the network card to listen to all wireless traffic. Most network cards support this behavior, but you may need a special driver to enable it. We'll use the airmon-ng command to put the network card into monitor mode. Monitor mode basically means that we 're going to receive all traffic received on a wireless channel. Airmon-ng is made specifically for enabling monitor mode on a network card. We need a list of wireless network cards so that we know which ones we can use. Let's go ahead and type in 'airmon-ng'.

A list of my cards appears, and I only have one wireless card, wlan0, so we're going to use that one. I'll do that by typing in 'airmon-ng start wlan0'.

When we enable Monitor mode on a wireless card, a warning may appear that tells us that some applications can interfere with Monitor mode. We can go ahead and kill the listed processes. I do that by entering the kill command for each of those processes. I see that the process identification, or PID, is listed for each one. Let's go ahead and kill those by typing 'kill 699 766 825'.

### Capture Handshake 01:46-04:23

Now that Monitor mode is set up, we should find a network to attempt to gain access to. To do this, we'll use the airodump-ng tool. We'll also use this tool to capture a wireless handshake. To get the list of available wireless networks, we just run the tool and tell it which monitor interface to use by entering 'airodump-ng wlan0mon'.

This interface shows quite a bit of information, but the pieces we're interested in are the ESSID, channel, and encoding being used for the target network. I'm interested in the network CorpNet, since it sounds more interesting than the other networks listed here. As mentioned earlier in the video, we want to capture a full wireless authentication handshake. This can sometimes take quite a while to occur under normal circumstances, so the aircrack-ng suite has included a tool to help speed things along. We'll need to copy some information from this tool for the next command. Sometimes, it's difficult to copy the text while the tool is running. We're going to stop the tool and start it again with some new flags once we have the information we need. I'm going to open a second terminal to do this.

Let's enter 'aireplay-ng -0 5 -a'. I'll then come up here and just copy the CorpNet mac address and paste it in down here. I'll finish off the command by typing '-c', go up, grab this mac address, and finish with 'wlan0mon'.

This command will force a specified wireless client to reauthenticate to the wireless network, making it more likely that we'll capture a full handshake quickly.

Now that we've copied the required information, I'll restart airodump-ng. The command syntax is

'airodump-ng -c 11 -w capture --bssid'. I'll copy the mac address and paste it in down here. And I'll finish the command with 'wlan0mon'.

All right. Now the modified flags will allow us to specify the wireless network we want to capture instead of just capturing everything. It also allows us to specify the name of the file we're saving the captured data to. Now that airodump is monitoring a specific network, it'll notify us when a full handshake is caught.

Now we'll run the command that we prepared earlier to force a full handshake to occur. You'll see this happen in the terminal on the top line, so focus your attention there. I'll do this by pressing Enter to run that command and wait for a handshake to occur.

Okay, we just captured a handshake. We can take this information and attempt to crack the password now.

### Capture the Wi-Fi Key 04:23-05:27

Let's jump back up to the top terminal and try to crack the password. I'll type 'aircrack-ng -w passwords.txt capture-01.cap'. This command uses -w to specify the wordlist, which is passwords.txt, and points to my captured handshake, which is the .cap file. I'll press Enter.

We're using a list of the top 500,000 most common passwords. This list is great if a less-experienced user has set the password for the wireless network, and it provides results quickly. While the command is running, we can see quite a bit of information that's displayed up here, in the top terminal. The part we're concerned with is the number of keys processed, the time remaining, and whether or not a key was found. It's important to note that the percentage shown here isn't the progress to cracking the password, but the progress through the password file. It's very likely that, with a secure network, this file could get to the end without ever finding the password.

All right. The tool has found a password for the CorpNet network, as displayed in the top terminal.

### Summary 05:27-05:41

That's it for this demonstration. In this demo, we discussed how to gain access to a wireless network using aircrack-ng and some of the other tools included in the suite.

## 8.2.5 Detecting Rogue Hosts

### Detecting Rogue Hosts 00:04-00:47

In this demo, we're going to configure our wireless controller to detect rogue hosts and look at other features wireless controllers have. Some of these features help with rogue host detection. If you remember, a rogue host is an unauthorized access point within your network or a different network in the surrounding area.

Let's start by logging in to our controller. On the main page, we have some statistics that can be useful for seeing what's going on with your wireless networks. We're going to check to see if this controller is set up for detecting rogue hosts. Let's go to Insight > Untrusted Rogue APs. Notice there are no APs listed in this section. To populate this list, we're going to have to trigger a scan to look for these them.

### Access Point Settings 00:47-02:10

Under Access Points, we're going to click the one access point we have. This first window shows details related to the access point. Now we're going to go to Configuration and see what kind of settings we have available for this AP.

IP Setting allows you to set DHCP or static addresses. If settings are set to DHCP, you can specify a failback IP address, MASK, and gateway. Radio gives you several options to tweak, such as mode, channel width, channel, and TX power. Some controllers have an auto mode for Tx power, but this one doesn't.

Load balance provides options for balancing connected clients. Max associated clients can be set so once that threshold is hit, load balancing is triggered. RSSI Threshold is a signal strength setting. If the client's signal is weaker than the set RSSI threshold, it'll disconnect the client from the AP. WLANs show which wireless networks are set up with this access point. You can override each access point if you don't want the same SSIDs on each access point. LED is just the indicator light on the access point.

The last setting we're going to look at is Rogue AP Detection. This is the scan button we use to scan for Rogue APs. Let's start a scan. Depending on how many surrounding networks there are, it could take several minutes. Great, the scan has completed. Let's go take a look at the list.

### Manage Rogue Devices 02:10-03:30

We're going to go back to insight and then to the Untrusted Rouge APs. This will show us some details related to information gathered during the scan. Let filter them so we know which APs are the closest by signal strength. You can see we have one AP that's close with -46 signal strength.

Sometimes, it's even possible to see the device's location on a map with other solutions. We have two options for rogue APs: we can trust them, or we can delete them from the list. The Tp-link Omada controller already knows that it's an untrusted AP, and it'll remain that way unless we trust it.

Let's say we know about this device, so we'll mark it as trusted. The device was removed from the untrusted list, and now it's on the Trusted APs list.

There could be a time where you may want to remove a trusted rouge AP and put it back on the untrusted list. To do that, you click the Untrust button. Now the SSID network NotYourWifi is back on the untrusted list.

It's important to know that this rogue device detection feature is just one step in protecting your network. If you were to identify a very suspect rogue device here, you would probably want to take additional steps, such as using an RF scanner to pinpoint the device and physically remove it from your organization or find the building where the network is coming from. Not all rogue APs are expected to be on your network, as other users may set up APs for their own use.

### Summary 03:30-03:46

That's it for this demo. In this demo, we discussed the configuration of various features on a wireless controller. We looked at various settings we can control with an AP. We also looked at how you can manage rogue devices.
