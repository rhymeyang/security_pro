---
lang: zh-CN
title: Section 8.3 Wireless Defenses
description: some description
---

As you study this section, answer the following questions:

<ul>
    <li>
     Which settings in a wireless access point can you configure to improve security?
    </li>
    <li>
     Which cryptographic protocol uses a Remote Authentication Dial-In User Service (RADIUS) server?
    </li>
    <li>
     Which access method forces a user to view and interact with it before accessing a network?
    </li>
    <li>
     What are the three components in an 802.1x setup?
    </li>
    <li>
     Which EAP standard is considered to be one of the most secure?
    </li>
   </ul>

In this section, you will learn to:

<ul>
    <li>
     Harden a wireless network.
    </li>
    <li>
     Configure a wireless intrusion prevention system.
    </li>
    <li>
     Configure a captive portal.
    </li>
   </ul>

The key terms for this section include:

<table class="terms">
   <thead>
    <tr><th class_="firstTableHeader" scope="col" class="fw-bold">
     Term
    </th>
    <th scope="col" class="fw-bold">
     Definition
    </th>
   </tr></thead>
   <tbody>
    <tr>
     <td>
      Wi-Fi Protected Access
      <br>
      (WPA)
     </td>
     <td>
      The most commonly used cryptographic protocol in use for wireless networks. WPA2 and WPA3 are the two
          versions in use.
     </td>
    </tr>
    <tr>
     <td>
      Pre-shared key
      <br>
      (PSK)
     </td>
     <td>
      Wireless access method that utilizes a passphrase for users to connect.
     </td>
    </tr>
    <tr>
     <td>
      Wi-Fi Protected Setup
      <br>
      (WPS)
     </td>
     <td>
      Wireless access method that allows a device to securely connect to a wireless network without typing
          the PSK.
     </td>
    </tr>
    <tr>
     <td>
      Open network
     </td>
     <td>
      Wireless access method that has no authentication.
     </td>
    </tr>
    <tr>
     <td>
      Captive portal
     </td>
     <td>
      Wireless access method that forces a user to view and interact with it before accessing a
          network.
     </td>
    </tr>
    <tr>
     <td>
      802.1x
     </td>
     <td>
      Standard for local area networks that is used to authenticate users to a wireless network. It was created by The Institute of Electrical and Electronics
          Engineers Standards Association (IEEE-SA).
     </td>
    </tr>
    <tr>
     <td>
      Remote Authentication Dial-In User Service
     </td>
     <td>
      A protocol used to authenticate users in a enterprise environment to a wireless network.
     </td>
    </tr>
    <tr>
     <td>
      Extensible Authentication Protocol
      <br>
      (EAP)
     </td>
     <td>
      An authentication framework that uses a set of interface standards. EAP allows various authentication
          methods to be used.
     </td>
    </tr>
   </tbody>
  </table>

This section helps you prepare for the following certification exam objectives:

<table class="objectives">
   <thead>
    <tr><th class_="firstTableHeader" scope="col" class="fw-bold">
     Exam
    </th>
    <th scope="col" class="fw-bold">
     Objective
    </th>
   </tr></thead>
   <tbody>
    <tr>
     <td>
      TestOut Security Pro
     </td>
     <td>
      2.2 Harden Network Devices
      <blockquote>
       2.2.2 Configure and Access a Wireless Network
       <br>
       2.2.4 Harden a Wireless Network
      </blockquote>
     </td>
    </tr>
    <tr>
     <td>
      CompTIA Security+ SY0-601
     </td>
     <td>
      1.6 Explain the security concerns associated with various types of vulnerabilities.
      <ul>
       <li>
        Weak configurations
        <ul>
         <li>
          Default settings
         </li>
        </ul>
       </li>
      </ul>
      <p>
       3.2 Given a scenario, implement host or application security solutions.
      </p>
      <ul>
       <li>
        Hardening
        <ul>
         <li>
          Patch management
          <ul>
           <li>
            Third-party updates
           </li>
           <li>
            Auto-update
           </li>
          </ul>
         </li>
        </ul>
       </li>
      </ul>
      <p>
       3.3 Given a scenario, implement secure network designs.
      </p>
      <ul>
       <li>
        Port security
        <ul>
         <li>
          Media access control (MAC) filtering
         </li>
        </ul>
       </li>
      </ul>
      <p>
       3.4 Given a scenario, install and configure wireless security settings.
      </p>
      <ul>
       <li>
        Cryptographic protocols
        <ul>
         <li>
          WiFi protected access II (WPA2)
         </li>
         <li>
          WiFi protected access III (WPA3)
         </li>
        </ul>
       </li>
       <li>
        Authentication Protocols
        <ul>
         <li>
          Extensible Authentication Protocol (EAP)
         </li>
         <li>
          Protected Extensible Application Protocol (PEAP)
         </li>
         <li>
          EAP-FAST
         </li>
         <li>
          EAP-TLS
         </li>
         <li>
          EAP-TTLS
         </li>
         <li>
          IEEE 802.1X
         </li>
         <li>
          Remote Authentication Dial-in
         </li>
         <li>
          User Server (RADIUS) Federation
         </li>
        </ul>
       </li>
       <li>
        Methods
        <ul>
         <li>
          Pre-shared key (PSK) vs. Enterprise vs. Open
         </li>
         <li>
          WiFi Protected Setup (WPS)
         </li>
         <li>
          Captive portals
         </li>
        </ul>
       </li>
       <li>
        Installation considerations
        <ul>
         <li>
          Wireless access point
         </li>
         <li>
          (WAP) placement
         </li>
        </ul>
       </li>
      </ul>
     </td>
    </tr>
   </tbody>
  </table>

## 8.3.1 Wireless Security

### Wireless Security 00:00-00:24

Wireless networking uses radio frequencies to transmit data. This means that anyone with a wireless receiver can capture data from a network if it's not secured properly. In this lesson, we'll go over some common configuration problems and different cryptographic protocols we can implement to further secure our data.

### Weak Configurations 00:24-00:39

When we set up a new wireless access point, the first thing we need to do is properly configure it. Many users just plug it in and use the default settings, which is extremely dangerous. These settings are readily available for anyone to look up on the internet.

### Default Login 00:39-00:55

The first setting to change is the default login information. All access points are shipped with a default login, such as admin. No other setting matters more than this one because if an attacker has our login information, they basically have complete control of the whole device.

### SSID 00:55-01:49

The next setting we should change is the network name, or SSID, which stands for service set identifier. The SSID can be a maximum of 32 bytes in length. We want to make sure that our SSID is unique to ourselves, but it shouldn't include identifiable information such as last name or address.

By default, the SSID is broadcast, and anyone within range can see the network name. We can, though, disable this right from the start if we choose. This might seem like an obvious setting to enable, but it doesn't actually provide as much security as you'd think. A determined hacker can easily discover hidden SSIDs, and beyond that, disabling the SSID can cause connection issues for your device. You should experiment to see if disabling your SSID is the best option for your network.

### MAC Address Filtering 01:49-02:31

You can also configure your wireless access point to use MAC address filtering. This makes it so only hosts that have certain MAC addresses can connect, which helps you control which systems are allowed access in the first place. MAC address filtering provides a minimal level of security at best, though. It may discourage a casual attacker, but it won't stop a determined one.

If an attacker is really set on gaining access to your wireless network, they can sniff packets and see which MAC addresses are being used to connect to the wireless access point. Then they can use MAC address spoofing to configure their system with one of the allowed MAC addresses.

### Wi-Fi Signal Strength 02:31-03:22

You should also monitor your wireless access point antenna placement and wireless access point antenna power levels.

Data emanation is a significant security problem. By default, the radio signals used by a wireless network broadcast omni-directionally. That radio signal travels farther than you realize, which makes it possible for an attacker outside of your building to access your wireless network. You can limit this exposure by manipulating your wireless access point antenna placement and your wireless access point power levels to reduce the amount of data emanation outside of the building.

Proper access point configuration is important to keeping a wireless network safe. But the most important security step is choosing the correct encryption method. Using a weak encryption method like WEP would make a network vulnerable to any hacker.

### Cryptographic Protocols 03:22-03:35

When we configure our wireless network, it's important that we select the best cryptographic protocols available. For most users, the Wi-Fi Protected Access, or WPA, versions 2 or 3 are the best options.

### WPA2 03:35-04:50

WPA2 was first introduced in 2004 and is still widely used today. There are two versions available—WPA2-Personal and WPA2-Enterprise. WPA2-Personal, also known as WPA2-PSK, or WPA2 pre-shared key, protects our network by using a pre-shared key referred to as the passphrase. WPA2-Enterprise verifies users through a RADIUS server.

WPA2-Personal uses AES with CCMP to encrypt all data. This stands for Advanced Encryption Standard with Counter Mode Cypher Block Chaining Message Authentication Code Protocol. AES with CCMP uses a 128-bit key and encrypts data in 128-bit blocks.

When a device connects to the access point, a four-way handshake occurs to authenticate the device. The pre-shared key and SSID are used to generate a session key during this process. A hacker can take advantage of some vulnerabilities in the four-way handshake to intercept the data and perform offline password attacks that could eventually crack weak passwords.

### WPA3 04:50-05:45

To address these vulnerabilities and support new technologies, the WPA3 standard is being implemented. WPA3 was introduced in 2018. Instead of using a pre-shared key, WPA3 uses the Simultaneous Authentication of Equals standard, or SAE standard.

SAE uses a 128-bit key and perfect forward secrecy to authenticate. Perfect forward secrecy is a cryptographic method that generates a new key for every transmission. This makes the handshake much more secure because if a hacker gets ahold of one message, they still aren't able to crack the keys.

It'll take a while for WPA3 to fully replace WPA2 since WPA2 is currently implemented in many network devices. Until then, we need to be aware of the differences in these standards and their encryption method vulnerabilities so that we can better protect our networks.

### Summary 05:45-06:23

That'll wrap up this lesson. In this lesson, we looked at some things we can do to better secure out wireless networks. We first looked at some of the default configurations we should change, including login information, the SSID, MAC address filtering, and transmission power. Then we looked at the two main cryptographic protocols in use today, which are WPA2 and WPA3. WPA2 is still the most widely used protocol, but WPA3 has been released and will eventually fix many of the vulnerabilities inherent in WPA2.

## 8.3.2 Wireless Security Facts

Wireless networking uses radio frequencies to transmit data. This means anyone with a wireless receiver can capture data from an improperly secured network.

This lesson covers the following topics:

<ul>
   <li>
    Weak configurations
   </li>
   <li>
    Cryptographic protocols
   </li>
  </ul>

### Weak Configurations

Proper configuration of a wireless access point (WAP) is the first step in securing the network. The following table explains some important actions to take regarding WAP settings.

<table>
   <thead>
    <tr><th class_="firstTableHeader" scope="col" class="fw-bold">
     Security Configuration
          Action
    </th>
    <th scope="col" class="fw-bold">
     Description
    </th>
   </tr></thead>
   <tbody>
    <tr>
     <td>
      Change default login credentials
     </td>
     <td>
      WAPs typically come configured with a default administrator username and password. Because the
          administrator username and password is used to configure WAP settings, it's important to reset the defaults. This
          prevents outsiders from guessing the default username and password and breaking into the system.
     </td>
    </tr>
    <tr>
     <td>
      Change default service set identification (SSID) and broadcast
     </td>
     <td>
      The SSID can be a maximum of 32 bytes in length. Since many manufacturers use a default SSID,
          it's important to change the SSID from the default. The SSID should be unique, but should not contain identifiable
          information (address, last name, etc.).
      <p>
       The SSID broadcast can also be disabled. This is known as SSID suppression or cloaking.
      </p>
      <div class="info" data-block="
       A determined hacker can still easily discover hidden SSIDs. Disabling SSID broadcast can cause
          connection issues for devices.
      "><div class="to-info-box"><div class="to-info-box-body"><div class="to-icon large" aria-hidden="true" style="width:20px"><svg aria-hidden="true" focusable="false" data-prefix="fal" data-icon="circle-info" class="svg-inline--fa fa-circle-info " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 32a224 224 0 1 1 0 448 224 224 0 1 1 0-448zm0 480A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM208 352c-8.8 0-16 7.2-16 16s7.2 16 16 16l96 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0 0-112c0-8.8-7.2-16-16-16l-40 0c-8.8 0-16 7.2-16 16s7.2 16 16 16l24 0 0 96-32 0zm48-168a24 24 0 1 0 0-48 24 24 0 1 0 0 48z"></path></svg></div><div class="to-info-box-body-content"><span>
       A determined hacker can still easily discover hidden SSIDs. Disabling SSID broadcast can cause
          connection issues for devices.
      </span></div></div></div></div>
     </td>
    </tr>
    <tr>
     <td>
      Enable MAC address filtering
     </td>
     <td>
      Every network device has a unique media access control (MAC) address. By specifying the MAC addresses
          that are allowed to connect to the network, unauthorized MAC addresses can be prevented from connecting to the WAP.
          Configuring a MAC address filtering system is very time consuming and demands upkeep.
      <div class="info" data-block="
       Attackers can still use tools to capture packets and retrieve valid MAC addresses. An attacker
          can spoof a wireless adapter's MAC address and circumvent the filter.
      "><div class="to-info-box"><div class="to-info-box-body"><div class="to-icon large" aria-hidden="true" style="width:20px"><svg aria-hidden="true" focusable="false" data-prefix="fal" data-icon="circle-info" class="svg-inline--fa fa-circle-info " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 32a224 224 0 1 1 0 448 224 224 0 1 1 0-448zm0 480A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM208 352c-8.8 0-16 7.2-16 16s7.2 16 16 16l96 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0 0-112c0-8.8-7.2-16-16-16l-40 0c-8.8 0-16 7.2-16 16s7.2 16 16 16l24 0 0 96-32 0zm48-168a24 24 0 1 0 0-48 24 24 0 1 0 0 48z"></path></svg></div><div class="to-info-box-body-content"><span>
       Attackers can still use tools to capture packets and retrieve valid MAC addresses. An attacker
          can spoof a wireless adapter's MAC address and circumvent the filter.
      </span></div></div></div></div>
     </td>
    </tr>
    <tr>
     <td>
      Update the firmware
     </td>
     <td>
      Manufacturers release updates to the firmware on a regular basis to address known issues. It is
          important to regularly check for updates and apply them to prevent the system from being exposed to known bugs and
          security vulnerabilities.
      <div class="info" data-block="
       While it is extremely important to keep devices up-to-date, it's just as important to
          properly test new updates before pushing them out to the entire network. Proper testing will reduce the number of new
          bugs or problems on a live network that the update may have introduced.
      "><div class="to-info-box"><div class="to-info-box-body"><div class="to-icon large" aria-hidden="true" style="width:20px"><svg aria-hidden="true" focusable="false" data-prefix="fal" data-icon="circle-info" class="svg-inline--fa fa-circle-info " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 32a224 224 0 1 1 0 448 224 224 0 1 1 0-448zm0 480A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM208 352c-8.8 0-16 7.2-16 16s7.2 16 16 16l96 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0 0-112c0-8.8-7.2-16-16-16l-40 0c-8.8 0-16 7.2-16 16s7.2 16 16 16l24 0 0 96-32 0zm48-168a24 24 0 1 0 0-48 24 24 0 1 0 0 48z"></path></svg></div><div class="to-info-box-body-content"><span>
       While it is extremely important to keep devices up-to-date, it's just as important to
          properly test new updates before pushing them out to the entire network. Proper testing will reduce the number of new
          bugs or problems on a live network that the update may have introduced.
      </span></div></div></div></div>
     </td>
    </tr>
    <tr>
     <td>
      Enable the WAP firewall
     </td>
     <td>
      Most wireless APs come with a built-in firewall that connects the wireless network to a wired
          network. This should be enabled to help prevent unauthorized access to the network.
     </td>
    </tr>
    <tr>
     <td>
      Wi-Fi signal strength
     </td>
     <td>
      Data emanation is a significant security problem. By default, the radio signals used by a wireless
          network are broadcasting omni-directionally and can travel quite a distance from the WAP. An attacker sitting outside the
          building may be able to connect to the wireless network if the signal is traveling outside.
      <p>
       This can be limited by manipulating the WAP antenna placement. Some WAPs also allow the signal strength to be
          adjusted. Using these settings, reduce the signal strength so the signal stays inside the building.
      </p>
     </td>
    </tr>
   </tbody>
  </table>

### Cryptographic Protocols

Enabling the proper cryptographic protocol is perhaps the most important way to secure a wireless network. For most users, Wi-Fi Protected Access (WPA) versions 2 or 3 will be the best option. The following table explains these two protocols:

<table>
   <thead>
    <tr><th class_="firstTableHeader" scope="col" class="fw-bold">
     Cryptographic Protocol
    </th>
    <th scope="col" class="fw-bold">
     Description
    </th>
   </tr></thead>
   <tbody>
    <tr>
     <td>
      Wi-Fi Protected Access 2
      <br>
      (WPA2)
     </td>
     <td>
      WPA2 is the implementation name for wireless security that adheres to the 802.11i specifications. It
          was first introduced in 2004 and is still heavily used in today's networks. There are two version of WPA2 available:
      <ul>
       <li>
        WPA2-Personal is also known as WPA2-PSK (pre-shared key). This version uses a pre-shared key, or passphrase, to
            protect the network. WPA2-PSK:
        <ul>
         <li>
          Uses Advanced Encryption Standard with Counter Mode with Cipher Block Chaining Message Authentication Code
              Protocol (AES-CCMP)as the encryption algorithm to encrypt all data. AES-CCMP uses a 128-bit key and a 128-bit block
              size.
         </li>
         <li>
          Performs a 4-way handshake to authenticate the device when it connects to the access point. The pre-shared key
              and SSID are used to generate a session key during this process. The handshake does have some vulnerabilities that
              allow a hacker to intercept data and perform offline password attacks.
         </li>
        </ul>
       </li>
       <li>
        WPA2-Enterprise uses a RADIUS server to authenticate users to the network.
       </li>
      </ul>
     </td>
    </tr>
    <tr>
     <td>
      Wi-Fi Protected Access 3
      <br>
      (WPA3)
     </td>
     <td>
      To support the vulnerabilities inherent in the WPA2 handshake and to support newer technologies, WPA3
          was implemented. First introduced in 2018, WPA3 implements the Simultaneous Authentication of Equals (SAE) standard
          instead of using the pre-shared key.
      <p>
       SAE uses a 128-bit key and Perfect Forward Secrecy (PFS) to authenticate users. Perfect forward secrecy is a
          cryptography method that generates a new key for every transmission. This makes the handshake much more secure from
          hackers. If any portion of the handshake is intercepted, the key is still uncrackable.
      </p>
     </td>
    </tr>
   </tbody>
  </table>

## 8.3.3 Wireless Authentication and Access Methods

### Wireless Authentication and Access Methods 00:00-00:31

Wireless networks encrypt communications using a security protocol, which is typically WPA2 or WPA3. But in order to authenticate users and distribute authentication keys, other methods are generally used. In this lesson, we'll go over some of the different access methods we can implement to connect to a wireless network as well as the authentication protocols we often find in enterprise environments.

### Access Methods 00:31-00:38

Depending on the environment, we can use different methods to connect users to a wireless network. Let's take a look at some of these methods.

### Pre-Shared Key 00:38-00:58

The first and probably most common access method is to use a pre-shared key, or PSK. A PSK is simply a passphrase that we type in to connect to a network. If we don't want to type in the passphrase to connect each and every device, we can use Wi-Fi Protected Setup, or WPS, to simplify the process.

### Wi-Fi Protected Setup 00:58-01:33

WPS only works with a network that uses a pre-shared key and WPA2. On the access point, there's usually a button that makes WPA2 start to search for devices in range. On the connecting device, there's probably a WPS button that automatically joins the device to the access point. You need to enter a unique eight-number access point pin if the connecting device doesn't have a button like this. Some devices and access points can also use Near Field Communication, or NFC, during the WPS process to connect to each other.

### Open Network 01:33-01:48

Our other option is to simply have an open network. This means that no authentication takes place, and anyone can connect to the network at will. This should only be used by public establishments that want to offer free wireless access.

### Captive Portal 01:48-02:18

Many open networks implement a captive portal. Captive portals force a user to view and interact with them before accessing the network. Basically, you're initially able connect your device to the wireless network. But before you can access the internet, you're redirected to a captive portal page. You might be prompted to agree to the network's terms and conditions or maybe even asked to pay a fee before you can proceed. These portals are used a great deal today, and you've most likely used one before.

### Authentication Protocols 02:18-02:33

In an enterprise environment, using a PSK isn't very secure or efficient. Enterprise networks usually make use the 802.1x Protocol to authenticate users to the wireless network.

### 802.1x 02:33-03:25

802.1x authentication is one of the most secure ways to enforce wireless network authentication. On a wired network, once a user is authenticated, the port they're connected to is activated. The port remains off if the user's activation fails. We can implement the 802.1x Protocol in a wireless network by enabling a virtual port when the user is authenticated.

There are three components to an 802.1x setup. The first is the supplicant, or wireless client. Then we have the authenticator, which is responsible for handling the communications between the supplicant and the authentication server—the third component. Know that oftentimes, the authentication server is a RADIUS server. When you use a RADIUS server, the authenticator is also known as the network access server, or NAS.

### RADIUS 03:25-04:50

RADIUS stands for Remote Authentication Dial-In Service. It was developed in 1991 and was originally used to authenticate users to remote networks over dial-up networks. We still use it today to remotely authenticate users. Obviously, though, we don't do this over dial-up connections anymore, which are more or less antiquated. RADIUS is known as a triple-A protocol, meaning that it provides authentication, authorization, and accounting management.

When using 802.1x with RADIUS, the client sends their credentials to the authenticator, or NAS. The NAS forwards the credentials to the RADIUS server to verify. If you use a Windows server, this is done using Active Directory. Then the server sends back the verification and user rights to the NAS, which forwards them back to the client. Then the client can access network resources. Using 802.1x authentication significantly increases your wireless network security.

To ensure that the authentication information being sent between these devices is secure, the Extensible Authentication Protocol, or EAP, is used. EAP isn't actually a specific protocol; it's merely a framework in which other protocols work. As a security administrator, you need to be familiar with several different EAP protocols. Let's start by looking at the Protected Extensible Authentication Protocol, or PEAP.

### PEAP 04:50-05:11

PEAP was created collaboratively by Cisco, Microsoft, and RSA Security. This protocol encapsulates the authentication communications within a TLS tunnel and exclusively uses a server-side certificate to authenticate Wi-Fi clients. This simplifies network implementation and administration.

### EAP-FAST 05:11-05:48

Next, we have EAP Flexible Authentication via Secure Tunneling, or EAP-FAST. EAP-FAST was created by Cisco, and it works by making a TLS tunnel that doesn't require an authentication server certificate. Instead, this protocol uses a Protected Access Credential, or PAC, to authenticate users.

Then, we have EAP Transport Layer Security, or EAP-TLS. EAP-TLS is the original and probably most secure of the wireless EAP authentication protocols. Because it's the original, it's also the most widely supported.

### EAP-TLS 05:48-06:18

The nice thing about EAP-TLS is that it requires client-side certificates in addition to server-side certificates. The certificate fully encrypts the authentication handshake between client and server and is then used in place of a password, making it practically impossible to crack. But because each client

requires an installed CA-signed PKI certificate, EAP-TLS is much more labor intensive and expensive to implement than other protocols.

### EAP-TTLS 06:18-06:53

The final protocol is EAP Tunneled Transport Layer Security, or EAP-TTLS. EAP-TTLS is essentially an updated version of EAP-TLS. The biggest difference is that we only need a certificate on the server. This greatly simplifies the implementation process since we don't need a certificate on each wireless device. EAP-TTLS has been supported natively since Windows 8. By using the right authentication protocol, you can greatly increase your wireless network's security and further protect it from attacks.

### Summary 06:53-07:36

That'll wrap up this lesson. In this lesson, we looked at the different wireless network access methods we can implement, including pre-shared keys, server authentication, and open networks. We also went over how WPS and captive portals work. Then we saw the various authentication methods that can be used for wireless networks. First, we looked at RADIUS and how it utilizes 802.1x authentication. We finished up by looking at the different EAP protocols, which include PEAP, EAP-FAST, EAP-TLS, and EAP-TTLS.

## 8.3.4 Wireless Authentication and Access Methods Facts

Wireless networks encrypt communications using a security protocol, typically WPA2 or WPA3. However, to securely authenticate users and distribute authentication keys, other methods need to be used.

This lesson covers the following topics:

<ul>
   <li>
    Access methods
   </li>
   <li>
    Authentication protocols
   </li>
  </ul>

### Access Methods

Choose an access method for a wireless network based on the use of the network. The following table describes access methods:

<table>
   <thead>
    <tr><th class_="firstTableHeader" scope="col" class="fw-bold">
     Access Method
    </th>
    <th scope="col" class="fw-bold">
     Description
    </th>
   </tr></thead>
   <tbody>
    <tr>
     <td>
      Pre-shared key
      <br>
      (PSK)
     </td>
     <td>
      A pre-shared key is a passphrase that is used to access the wireless network. This is probably the
          most commonly used access method.
     </td>
    </tr>
    <tr>
     <td>
      Wi-Fi Protected Setup
      <br>
      (WPS)
     </td>
     <td>
      Wi-Fi Protected Setup works only on a network that uses a PSK and WPA2. WPS allows a device to
          securely connect to a wireless network without typing in the PSK. To do this, you:
      <br>
      <ul>
       <li>
        Push a button on the access point that causes the access point to search for
            devices in range.
       </li>
       <li>
        Push the WPS button on the device to automatically join it to the access point. If
            there is no button, enter the eight-digit pin that is unique to the access point.
       </li>
      </ul>
      <div class="info" data-block="
       Some devices and access points can also use Near Field Communication (NFC) during the WPS process to connect to each other.
      "><div class="to-info-box"><div class="to-info-box-body"><div class="to-icon large" aria-hidden="true" style="width:20px"><svg aria-hidden="true" focusable="false" data-prefix="fal" data-icon="circle-info" class="svg-inline--fa fa-circle-info " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 32a224 224 0 1 1 0 448 224 224 0 1 1 0-448zm0 480A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM208 352c-8.8 0-16 7.2-16 16s7.2 16 16 16l96 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0 0-112c0-8.8-7.2-16-16-16l-40 0c-8.8 0-16 7.2-16 16s7.2 16 16 16l24 0 0 96-32 0zm48-168a24 24 0 1 0 0-48 24 24 0 1 0 0 48z"></path></svg></div><div class="to-info-box-body-content"><span>
       Some devices and access points can also use Near Field Communication (NFC) during the WPS process to connect to each other.
      </span></div></div></div></div>
     </td>
    </tr>
    <tr>
     <td>
      Open Network
     </td>
     <td>
      An open network has no authentication at all and allows anyone to connect to the network. This
          access method should be used only in public places that want to offer free wireless access.
     </td>
    </tr>
    <tr>
     <td>
      Captive Portal
     </td>
     <td>
      Many open networks implement a captive portal. Captive portals force a user to view and interact
          with them before accessing a network. A hotel network is a good example captive portal use. When using a captive portal:
      <ul>
       <li>
        The user connects to the wireless network but is redirected to a captive portal page before internet access is granted.
       </li>
       <li>
        The user might be prompted to agree to the terms and conditions of using the network or even asked to pay a fee before being granted access.
       </li>
      </ul>
     </td>
    </tr>
   </tbody>
  </table>

### Authentication Protocols

Enterprise level networks need a higher level of security. Many enterprise networks use the 802.1x protocol to authenticate users to the wireless network. 802.1x is a standard for local area networks created by The Institute of Electrical and Electronics Engineers Standards Association (IEEE-SA). This standard is often labeled IEEE 802.1x.

Once a user is authenticated to a wired network, the port the user is connected to is activated. If the user activation fails, the port remains off. The 802.1x protocol can be implemented in a wireless network by enabling a virtual port when the user is authenticated. There are three components in a 802.1x setup:

<ul>
   <li>
    The
    <i class="fs-italicize">
     supplicant
    </i>
    is the wireless client.
   </li>
   <li>
    The
    <i class="fs-italicize">
     authentication server
    </i>
    contains a centralized database for user authentication.
   </li>
   <li>
    The
    <i class="fs-italicize">
     authenticator
    </i>
    is a device responsible for handling the communications between the supplicant and
      authentication server.
   </li>
  </ul>

802.1x implementations on wireless networks often use Remote Authentication Dial-In Service (RADIUS). RADIUS was developed in 1991. It was originally used to authenticate users to the remote network over a dial-up network. RADIUS is known as a triple-A protocol. This means it provides authentication, authorization, and accounting.

When using 802.1x authentication for wireless networks with RADIUS, be aware that:

<ul>
   <li>
    A RADIUS server is required to centralize user account and authentication information. A centralized database for user
      authentication is required to allow wireless clients to roam between cells and authenticate using the same account
      information.
   </li>
   <li>
    PKI is required for issuing certificates. At a minimum, the RADIUS server must have a server certificate. To support
      mutual authentication, each client must also have a certificate.
   </li>
   <li>
    The wireless access point is a RADIUS client.
   </li>
   <li>
    The wireless access point forwards the wireless device's credentials to the RADIUS server for authentication.
   </li>
   <li>
    A RADIUS federation is multiple RADIUS servers that communicate with each other after establishing a trust relationship.
      These servers may be on different networks and could span multiple organizations.
   </li>
  </ul>

To ensure the authentication information being sent is secure, the Extensible Authentication Protocol (EAP) is used. EAP is a framework in which other protocols work. The following table explains EAP and the protocols:

<table>
   <thead>
    <tr><th class_="firstTableHeader" scope="col" class="fw-bold">
     Protocol
    </th>
    <th scope="col" class="fw-bold">
     Description
    </th>
   </tr></thead>
   <tbody>
    <tr>
     <td>
      Extensible Authentication
      <br>
      Protocol
      <br>
      (EAP)
     </td>
     <td>
      EAP is a set of interface standards that allows various authentication methods to be used:
      <ul>
       <li>
        EAP supports multiple authentication methods (smart cards, biometrics, and digital
            certificates).
       </li>
       <li>
        Using EAP, the client and server negotiate the characteristics of authentication.
       </li>
      </ul>
     </td>
    </tr>
    <tr>
     <td>
      Protected Extensible Authentication Protocol
      <br>
      (PEAP)
     </td>
     <td>
      PEAP provides authentication in an SSL/TLS tunnel with a single certificate on the server. PEAP:
      <ul>
       <li>
        Creates a secure communication channel for transmitting certificate or login credentials.
       </li>
       <li>
        Enables mutual authentication by requiring the server to prove its identity with the client.
       </li>
       <li>
        Was a collaborative effort between Cisco, Microsoft, and RSA.
       </li>
      </ul>
     </td>
    </tr>
    <tr>
     <td>
      EAP Flexible Authentication via Secure Tunneling
      <br>
      (EAP-FAST)
     </td>
     <td>
      EAP-FAST uses a Protected Access Credential (PAC) to authenticate users. EAP-FAST:
      <ul>
       <li>
        Establishes a TLS tunnel in which client authentication credentials are transmitted.
       </li>
       <li>
        Is susceptible to attackers who intercept the Protected Access Credential (PAC) and use it to compromise user
            credentials. This vulnerability is mitigated by manual PAC provisioning or by using server certificates.
       </li>
       <li>
        Was created by Cisco.
       </li>
      </ul>
     </td>
    </tr>
    <tr>
     <td>
      EAP Transport Layer Security
      <br>
      (EAP-TLS)
     </td>
     <td>
      EAP-TLS uses Transport Layer Security (TLS) and is considered to be one of the most secure EAP
          standards available. EAP-TLS:
      <ul>
       <li>
        Is widely supported by almost all manufacturers of wireless LAN hardware and software.
       </li>
       <li>
        Requires signed client-side and server-side certificate authority (CA) PKI certificates.
       </li>
       <li>
        Is labor-intensive and expensive to implement.
       </li>
      </ul>
     </td>
    </tr>
    <tr>
     <td>
      EAP Tunneled Transport Layer Security
      <br>
      (EAP-TTLS)
     </td>
     <td>
      EAP-TTLS also uses a CA signed certificate. EAP-TTLS:
      <ul>
       <li>
        Is an updated version of EAP-TLS.
       </li>
       <li>
        Requires only one CA signed certificate on the server, simplifying the implementation process.
       </li>
      </ul>
     </td>
    </tr>
   </tbody>
  </table>

## 8.3.5 Hardening a Wireless Access Point

### Hardening a Wireless Access Point 00:00-00:41

In this demonstration, we're going to go through some of the steps you can take to harden a wireless network, and we're going to use a wireless controller.

This means we make changes on the controller itself, and those changes propagate out to each of the access points connected to it. The concepts in this demo transfer to other types of wireless access points, such as all-in-one small office/home office devices.

To start, we need to log in to our controller. I have a web browser open, and I've entered the controller's IP address. I'll enter the username, ‘admin', and password, and we're logged in.

### Default Username and Password 00:41-01:14

The first thing we want to do is change the default username and password for this device. This is the first thing you should do with any networking device you're configuring. It's very important that you change those defaults.

We do this on the Administer tab. Notice we can also choose to use an authorization server if we want to, but just change the default username to something else. We'll enter the old password and then the new password. Click Apply. The Admin session timeout setting is also on this page.

### Session Timeout 01:14-02:08

This setting defines how much time must pass before the user is automatically logged out.

This is a nice thing to have, as it keeps users from logging in to the device and then walking away from it and leaving it vulnerable. Let's change this to 10 minutes. Click Apply.

Now we're asked to log out and start a new session with the new timeout setting. Click OK, and let's log in with our new username and password.

Let's go to the Configure tab. There are a lot of settings and options on this tab. On the System tab, we can specify the IP address and subnet mask to use on the network.

It's good to change this from a typical IP address range, as it adds another layer of security, but we'll leave it how it is for now. Let's go to the Access Points page.

On this page, we can see all the access points connected to the wireless controller.

Access Point Management and Configuration 02:08-02:55
Right now, we only have one AP, or access point, connected. If we wanted to, we could click Edit and change the configuration.

Notice that all these options require us to override the group configuration. Remember, this is a wireless controller. As such, it controls the configuration options for each access point in the network.

If we want to change the settings on a specific access point (for example, change the channel it's using), we can do that here. For now, let's click Cancel.

Under Access Point Groups, any changes to this configuration will be applied to all the APs in the network. This makes managing networks with multiple APs very easy. All the settings look good, so let's just click Cancel.

### WAN Configuration 02:55-04:47

On the WLANs page, we can create wireless LANs--that is, we can create multiple wireless networks, each specified by an SSID. For example, we currently have three different WLANs configured on this controller. Let's edit the DevRuckusAP network.

Here, we can see the configuration of this network and that it's defined as a standard network. We can also configure the authentication options. Right now, the authenticate type is open.

We could configure this to connect to a RADIUS server, specify that it use MAC address authentication, or use a combination of the two. We can also configure the encryption method.

We're using WPA2 with the AES algorithm. You can see we have a very weak passphrase configured, which is fine for a demo, but make sure you use a complex passphrase with this encryption.

Down here, we can also configure the WLAN to use a captive portal. The Wireless Client Isolation option allows us to configure the network to isolate each connected client.

There are also a lot of advanced options we won't get into, but remember there's a lot of customization that can happen with these types of wireless controllers that you just can't find in smaller, consumer-grade devices. Leave everything as it is and click Cancel.

Let's look at the configuration of the Guest network. Notice the type is defined as Guest, which causes our guest access policies and access control settings to be applied.

We also need to note that we're using open authentication with no encryption. This is an open, unsecure guest network. That's why we're isolating wireless client traffic from each other. It's good idea to have this option enabled on guest networks. Click Cancel, and let's go to the Access Control page.

### Access Control Configuration 04:47-06:53

On this page, we can configure how client access is controlled. For example, under L2-L7 Access Control, we can define MAC address control lists that can be used with a specific WLAN.

To define MAC address control lists, add all the MAC addresses you want to give network access to and then enable MAC address filtering on the specific WLAN to use that list. We can also do this by IP address.

Under Device Access Policy, we can permit or deny clients based on their device specifications. For example, we could deny all clients using a particular operating system.

Application Recognition and Filtering is another useful feature. It lets us block traffic based on port, IP address, protocol, and other characteristics.

We configure this by looking at our access points' logs and identifying the different types of traffic. We would then take that information and decide if we want to block anything.

Let's go back up to the device access policy and define a rule. We're going to create a rule that blocks traffic from video game consoles. We'll name the rule and add a description. Click Create New.

Notice, under OS/Type, that we have an option for gaming. This identifies traffic generated by video game consoles, such as an Xbox or PlayStation console. We want to deny this traffic, so we'll select Deny from the rule type dropdown. Click Save > OK.

There's a number of other features on this controller that you can use. We can add roles and policies that affect users, and we can add users to the device. We can also configure the controller to notify us of specific events via email.

On the Services page, we can configure self-healing and background scanning, which are both very useful feature, but they're outside the scope of this video. We can also configure wireless intrusion detection.

Wireless Intrusion Detection and Prevention System (WIPS) 06:53-07:36
Wireless intrusion detection and prevention system (WIPS) is, actually, a very useful feature. It helps protect against wireless attacks such as denial-of-service (DoS) attacks, rogue access points, evil twin attacks, and rogue DHCP servers.

For example, we can protect against repeated authentication attacks right here. We can even specify how long a client will be blocked. This helps protect our system from DoS attacks and brute force attacks. We can also configure the controller to automatically flag APs trying to spoof an SSID or MAC address as a malicious device. This is a great tool for protecting against evil twin attacks.

### Summary 07:36-07:50

That's it for this demonstration. In this demo, we discussed some of the things you can do to harden a wireless network using a wireless network controller.

## 8.3.8 Configuring a Captive Portal

### Configuring a Captive Portal 00:04-01:02

In this demonstration, we're going to configure a captive portal. Captive portals force a user to view and interact with them before they can access a network or the internet.

After you connect your device to the wireless or guest network, but before you can access the internet, you are redirected to a captive portal page.

You might be prompted to agree to the terms and conditions of using the network, and you might be asked to pay a fee to you gain access. Some even allow users to log in to use the network. They are used a great deal, and you've most likely used one before, especially at hotels or airports.

Today, we'll be using a captive portal that's part of pfSense. pfSense sits between the internal network and the internet, as you can see in this diagram.

We want to configure the captive portal so that any device that connects to our guest Wi-Fi will have to go through the captive portal in order to get internet access.

### Add Captive Portal Zone 01:02-01:44

I have a network adaptor installed in pfSense that I'm going to use for my guest Wi-Fi. If I scroll down, you can see it listed right here. So, let's get started. I'll go to Services > Captive portal and click on the Add button. Under Add Captive Portal Zone, I want to enter in our zone name, ‘Guest_WiFi'. For Zone description, I'll put in Guest Wi-Fi. By the way, for the zone name, you can only use letters, digits, and underscores, but you can use any character for the description name. Click the Save & Continue button.

### Captive Portal Configuration 01:44-05:39

Now, under Captive Portal Configuration, let's check the Enable Captive Portal check box. When we do, we get a bunch of options. Under Interfaces, you'll see my Guest Wi-Fi interface that we looked at in the beginning of the demo. Depending on your network, you could have a VLAN configured for your guest Wi-Fi. My demo environment isn't set up with VLAN, but that would work really well for this. This is the one we want to pick.

Under Maximum concurrent connections, we can put in a number of concurrent connections. I'll put five in here. This is not the number of users, but rather how many connections a single IP can establish to the portal. For Idle timeout, we'll put in 60 minutes. If a client is inactive for that amount of time, they'll be disconnected. Hard timeout limits a connection no matter what. We might not want users on our guest network forever, so you can limit the time they spend. Let's put in 120 minutes. We can also give guest users a traffic quota. We might not want them streaming video for two hours, so we can put something in here to restrict that if we like. I'll just leave it blank for now.

I'm going to leave the next several set to the defaults and scroll down a bit until I see Per-user bandwidth restriction. Let's go ahead and check the box to enable it. This limits users' download and upload speeds. For Default download, I'll put in 10,000 kilobits per second, which is about 10 megabits per second. For the Default upload, I'll put in 3,000 kilobits per second, which is about 3 megabits per second.

We could use a custom captive portal page. Let's check the box. When I do, you can see that I would need a custom page to upload. I would also need an error page and logout page. I'm just going to use the default page that comes with pfSense for my captive portal page. But if I were setting this up for real use, I'd certainly want a custom page. I'll uncheck that box.

I could also upload a custom logo or a custom background for my page. For the Terms and Conditions, I can put in something like, ‘Don't be bad on the internet.'

For Authentication Method, we're not going to use any authentication. We could use RADIUS if we had that set up, or we could use some other type of authentication. But for this demo, I'll select None, don't authenticate users from the dropdown.

We could Enable HTTPS login, but if I did, I'd have to configure the server to have a certificate, and I haven't done that, so I'll leave that unchecked.

Here, at the bottom, it reminds us to set up DHCP on our captive portal interface. I've already done that, so we're good to go. That is all we're going to set up here, so click on Save to continue. And here, you can see that our captive portal has been created.

Now, before we continue, let's briefly look at a few options that we skipped and aren't going to configure.

Under the MAC's tab, we can get a little more granular with bandwidth control as far as limiting the upload and download. Under Allowed IP Addresses, we can do the exact same thing, but by IP instead of MAC addresses. Allowed Hostnames is the same, but by hostname.

Here, we have Vouchers. Vouchers are single-use codes used to gain internet access through a captive portal. Vouchers are commonly implemented in places where authentication is required, but where there is also a time limit on internet access.

And lastly, the File Manager tab is used to upload files that are used inside a captive portal page, such as style sheets and image files.

Now let's test out our captive portal over on our Guest Wi-Fi network.

Test the Captive Portal in a Guest Wi-Fi Network 05:39-06:04
I've switched over to our Guest Wi-Fi network. What should happen when we go to surf the web is that we should get redirected to our captive portal page. I'll open up our web browser, and we're directed to our pfSense captive portal page. Remember, I didn't configure authentication, so all I have to do is check the box to agree with the terms and conditions to proceed. I'll click Login, and after a second, I'm forwarded to my homepage.

### Summary 06:04-06:21

That's it for this demo. In this demo, we configured a captive portal on pfSence to force users to agree to terms and conditions before being allowed access to the internet.
