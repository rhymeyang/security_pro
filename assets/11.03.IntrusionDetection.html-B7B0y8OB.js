import{_ as a,c as s,b as n,a as e,d as t,o}from"./app-6Mc17HFZ.js";const l={};function r(c,i){return o(),s("div",null,i[0]||(i[0]=[n("<p>As you study this section, answer the following questions:</p><ul><li> What is the difference between an IDS and IPS? </li><li> Which component gathers data from source devices? </li><li> Why is a false negative the worst possible action by an IDS? </li><li> Which detection method causes more false negatives? </li><li> What is the difference between an inline and out-of-band IDS installation? </li></ul><p>In this section, you will learn to:</p><ul><li> Implement intrusion monitoring. </li><li> Implement intrusion prevention. </li><li> Use Squil and Squert. </li></ul><p>The key terms for this section include:</p>",5),e("table",{class:"terms"},[e("thead",null,[e("tr",null,[e("th",{class_:"firstTableHeader",scope:"col",class:"fw-bold"}," Term "),e("th",{scope:"col",class:"fw-bold"}," Definition ")])]),e("tbody",null,[e("tr",null,[e("td",null," Intrusion detection system "),e("td",null," Device or software that monitors, logs, and detects security breaches, but takes no action to stop or prevent the attack. ")]),e("tr",null,[e("td",null," Intrusion prevention system "),e("td",null," Device that monitors, logs, detects, and can also react to stop or prevent security breaches. ")]),e("tr",null,[e("td",null," Sensor "),e("td",null," IDS component that passes data from the source to the analyzer. ")]),e("tr",null,[e("td",null," Engine "),e("td",null," IDS component that analyzes sensor data and events; generates alerts; and logs all activity ")]),e("tr",null,[e("td",null," Signature-based detection "),e("td",null," Also referred to as pattern matching, dictionary recognition, or misuse-detection (MD-IDS). This detection method looks for patterns in network traffic and compares them to known attack patterns called signatures. ")]),e("tr",null,[e("td",null," Heuristic-based detection "),e("td",null," Also referred to as behavior, anomaly, or statistical-based detection. This detection method first defines a baseline of normal network traffic and then monitors traffic looking for anything that falls outside that baseline. ")])])],-1),e("p",null,"This section helps you prepare for the following certification exam objectives:",-1),e("table",{class:"objectives"},[e("thead",null,[e("tr",null,[e("th",{class_:"firstTableHeader",scope:"col",class:"fw-bold"}," Exam "),e("th",{scope:"col",class:"fw-bold"}," Objective ")])]),e("tbody",null,[e("tr",null,[e("td",null," TestOut Security Pro "),e("td",null,[t(" 2.0 Physical and Network Security "),e("p",null," 2.2 Harden Network Devices ")])]),e("tr",null,[e("td",null," CompTIA Security+ SY0-601 "),e("td",null,[t(" 3.3 Given a scenario, implement secure network designs. "),e("ul",null,[e("li",null,[t(" Network-based intrusion detection system (NIDS)/network-based intrusion prevention system (NIPS) "),e("ul",null,[e("li",null," Signature based "),e("li",null," Heuristic/behavior ")])]),e("li",null," Out-of-band management ")])])])])],-1),n('<h2 id="_11-3-1-intrusion-detection" tabindex="-1"><a class="header-anchor" href="#_11-3-1-intrusion-detection"><span>11.3.1 Intrusion Detection</span></a></h2><h3 id="intrusion-detection-00-00-00-24" tabindex="-1"><a class="header-anchor" href="#intrusion-detection-00-00-00-24"><span>Intrusion Detection 00:00-00:24</span></a></h3><p>The first step in defending our network against unauthorized access is knowing if someone is attempting to gain access. To assist network defenders in this task, we can implement network intrusion detection or network intrusion prevention systems. In this lesson, we&#39;ll look at the differences, detection methods, and implementation of these systems.</p><h3 id="intrusion-detection-and-intrusion-prevention-systems-00-24-00-32" tabindex="-1"><a class="header-anchor" href="#intrusion-detection-and-intrusion-prevention-systems-00-24-00-32"><span>Intrusion Detection and Intrusion Prevention Systems 00:24-00:32</span></a></h3><p>To better understand the differences between an intrusion detection and intrusion prevention system, lets take a look at what each of them do.</p><h3 id="intrusion-detection-system-ids-00-32-00-49" tabindex="-1"><a class="header-anchor" href="#intrusion-detection-system-ids-00-32-00-49"><span>Intrusion Detection System (IDS) 00:32-00:49</span></a></h3><p>An intrusion detection system, or IDS, is used to monitor and detect unauthorized access. It doesn&#39;t try to stop an attack or prevent traffic; it just monitors data packets and creates logs. An IDS can be either a software program or a hardware device.</p><h3 id="intrusion-prevention-system-ips-00-49-01-35" tabindex="-1"><a class="header-anchor" href="#intrusion-prevention-system-ips-00-49-01-35"><span>Intrusion Prevention System (IPS) 00:49-01:35</span></a></h3><p>Similar to an IDS is an intrusion prevention system, or IPS. Not only does the IPS monitor network traffic, it also works to block unauthorized and suspicious packets from entering the network.</p><p>No solution is perfect, and that&#39;s why we should always implement security-in-depth and use both detection and prevention systems. Even with an IPS, malicious packets may still find their way into the network. The IDS can serve as a backup and alert us that something suspicious may be going on and record it for us. This information will be extremely valuable after the attack so that we can figure out exactly what happened and what the damage is.</p><p>Now that we understand what an IDS and IPS are, lets take a look at how they work.</p><h3 id="detection-methods-01-35-02-42" tabindex="-1"><a class="header-anchor" href="#detection-methods-01-35-02-42"><span>Detection Methods 01:35-02:42</span></a></h3><p>Both IDS and IPS systems monitor data packets for suspicious traffic. They do vary slightly in how they accomplish this, but both systems use generally the same methods. For simplicity&#39;s sake we&#39;ll talk about the IDS systems, but understand that all of this can apply to both unless otherwise specified.</p><p>This first and most common method is signature-based detection. This type of IDS is sometimes called a misuse-detection IDS. It attempts to match the known traffic patterns of specific network attacks. Similar to how viruses have a unique fingerprint that antivirus programs use to detect them, malicious packets also have a unique fingerprint that the IDS can use to identify them with.</p><p>The other detection method is heuristic, or behavior-based detection, sometimes referred to as statistical anomaly-based detection. With this type of detection, you set up a baseline of regular network activity and the IDS determines if activity is outside the norm. The biggest issue with this method is that a larger number of false positives are likely to be generated.</p><p>No matter the detection method being used, an IDS can either be a host-based or network-based IDS.</p><h3 id="ids-ips-implementation-02-42-03-38" tabindex="-1"><a class="header-anchor" href="#ids-ips-implementation-02-42-03-38"><span>IDS/IPS Implementation 02:42-03:38</span></a></h3><p>A host-based IDS is software installed on the host system. Host-based IDSs are better at detecting attacks unique to the services and applications on that system than network-based IDSs. A host-based IDS also monitors local files for suspicious activity, which is something a network-based IDS can&#39;t do. The problem with host-based IDSs is that software must be installed on each system you want to protect. This can lead to excessive administrative effort. Also, if a system is compromised, the log reports on that system become unreliable because the attacker may have modified the log files.</p><p>The other option is to install the IDS on the network itself. This is a physical device that monitors network traffic in real time. We have two options on where to install a network IDS: inline or out of band.</p><h3 id="out-of-band-03-38-03-55" tabindex="-1"><a class="header-anchor" href="#out-of-band-03-38-03-55"><span>Out-of-Band 03:38-03:55</span></a></h3><p>Because an IDS is a passive device that simply monitors packets, they&#39;re generally installed as out-of-band devices. All this means is that the device is installed outside the flow of traffic. It&#39;s usually connected with a network tap, like a switch, which allows it to monitor traffic without being in the way.</p><h3 id="inline-03-55-04-21" tabindex="-1"><a class="header-anchor" href="#inline-03-55-04-21"><span>Inline 03:55-04:21</span></a></h3><p>An IPS on the other hand is an active device that&#39;s usually installed inline, or in the flow of traffic. All data goes through the IPS, where it&#39;s checked out and either allowed to pass through or stopped.</p><p>Regardless of whether the device is inline or out of band, it can be installed in front of or behind the firewall. Generally, an IDS or IPS should be installed behind the firewall as this uses less resources.</p><h3 id="summary-04-21-04-57" tabindex="-1"><a class="header-anchor" href="#summary-04-21-04-57"><span>Summary 04:21-04:57</span></a></h3><p>That&#39;ll wrap things up for this lesson. In this lesson, we looked at intrusion detection and intrusion prevention systems. The biggest difference between the two is that an IDS is a passive monitoring device and an IPS is an active prevention device. We also looked at the common detection methods that both use, which are signature-based detection and heuristic, or behavior-based, detection. Finally, we looked at how to install these devices on a network. IDSs should be installed out of band and IPSs should be inline.</p><h2 id="_11-3-2-ids-facts" tabindex="-1"><a class="header-anchor" href="#_11-3-2-ids-facts"><span>11.3.2 IDS Facts</span></a></h2><p>The first step in defending a network against unauthorized access is knowing that someone is gaining access. An intrusion detection system (IDS) is a special network device that can detect attacks and suspicious activity. An active IDS is known as an intrusion prevention system (IPS).</p><p>This lesson covers the following topics:</p><ul><li> Differences between IDSs and IPSs </li><li> Detection methods </li><li> Device implementation </li></ul><h3 id="differences-between-idss-and-ipss" tabindex="-1"><a class="header-anchor" href="#differences-between-idss-and-ipss"><span>Differences between IDSs and IPSs</span></a></h3><p>The below table shows the differences between an IDS and an IPS:</p>',32),e("table",null,[e("thead",null,[e("tr",null,[e("th",{class_:"firstTableHeader",scope:"col",class:"fw-bold"},"IDS"),e("th",{class_:"firstTableHeader",scope:"col",class:"fw-bold"},"IPS")])]),e("tbody",null,[e("tr",null,[e("td",null,[t(" A passive IDS monitors, logs, and detects security breaches, but it takes no action to stop or prevent the attack. A passive IDS: "),e("ul",null,[e("li",null," Can send an alert, but this requires the security administrator to interpret the degree of the threat and respond accordingly "),e("li",null," Cannot be detected on the network because it takes no detectable actions ")])]),e("td",null,[t(" An active IDS, also called an IPS, performs the functions of an IDS but can also react when security breaches occur. An IPS: "),e("ul",null,[e("li",null,"Can automate responses to malicious or suspicious traffic"),e("li",null,[t(" Can terminate sessions (using the "),e("strong",{class:"fw-bold"}," TCP-RST "),t(" command) or restart other processes on the system. ")]),e("li",null," Performs behaviors that can be seen by anyone watching the network. Usually these actions are necessary to block malicious activities or discover the identity of an intruder. Updating filters and performing reverse lookups are common behaviors of an active IDS. ")])])])])],-1),e("p",null,"Using both of these devices in a network provides the best network detection and protection. If a malicious packet makes it past the IPS, the IDS serves as a backup and alerts the security operations team.",-1),e("p",null,"The IDS also records and logs everything (this can be viewed in the follow-up).",-1),e("p",null,"The steps a IDS/IPS takes when monitoring traffic are:",-1),e("ul",null,[e("li",null," A sensor passes data from the source to the analyzer. "),e("li",null,[t(" The engine, or analyzer, analyzes the sensor data and events, generates alerts, and logs all activity. An "),e("i",{class:"fs-italicize"}," alert "),t(" is a message indicating an event of interest (such as a possible attack) ")]),e("li",null," The IDS/IPS labels traffic based on its interpretation of whether or not the traffic poses a threat, as described in the following table. ")],-1),e("table",null,[e("thead",null,[e("tr",null,[e("th",{class_:"firstTableHeader",scope:"col",class:"fw-bold"}," State "),e("th",{scope:"col",class:"fw-bold"}," Description ")])]),e("tbody",null,[e("tr",null,[e("td",null," Positive "),e("td",null," A positive traffic assessment means that the system detected an attack and the appropriate alarms and notifications were generated or the correct actions were performed to prevent or stop the attack. ")]),e("tr",null,[e("td",null," False positive "),e("td",null," A false positive traffic assessment means that the system identified harmless traffic as offensive and generated an alarm or stopped the traffic. ")]),e("tr",null,[e("td",null," Negative "),e("td",null," A negative traffic assessment means that the system deemed the traffic harmless and let it pass. ")]),e("tr",null,[e("td",null," False negative "),e("td",null," A false negative traffic assessment means that harmful traffic was allowed to pass without any alerts being generated or any actions being taken to prevent or stop it. This is the worst possible scenario. ")])])],-1),e("h3",{id:"detection-methods",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#detection-methods"},[e("span",null,"Detection Methods")])],-1),e("p",null,"Both systems monitor data packets for malicious or unauthorized traffic. The below table shows the different methods they can use to distinguish attacks and threats from normal traffic:",-1),e("table",null,[e("thead",null,[e("tr",null,[e("th",{class_:"firstTableHeader",scope:"col",class:"fw-bold"}," Detection Method "),e("th",{scope:"col",class:"fw-bold"}," Description ")])]),e("tbody",null,[e("tr",null,[e("td",null," Signature-based "),e("td",null,[t(" Signature-based detection, also referred to as pattern matching, dictionary recognition, or misuse-detection (MD-IDS), looks for patterns in network traffic and compares them to known attack patterns called signatures. Similar to how viruses have a unique fingerprint that antivirus programs use to detect their presence, malicious packets have a unique fingerprint that the IDS can use to do the same. These fingerprints are referred to as signatures. "),e("ul",null,[e("li",null," Signatures are written and updated by the IDS vendors. "),e("li",null," Signature-based detection cannot detect unknown attacks; they can only detect attacks identified by published signature files. For this reason, it is important to update signature files on a regular basis. "),e("li",null," Signature-based detection usually causes more false negatives than heuristic-based detection. ")])])]),e("tr",null,[e("td",null," Heuristic-based "),e("td",null,[t(" Heuristic-based detection, also referred to as behavior, anomaly, or statistical-based detection, first defines a baseline of normal network traffic and then monitors it. It looks for anything that falls outside that baseline. "),e("ul",null,[e("li",null," Clipping levels, or thresholds, are defined and used to identify deviations from the baseline. "),e("li",null," When the threshold is reached, an alert is generated or action is taken. "),e("li",null," Heuristic-based systems can recognize and respond to some unknown attacks (attacks that do not have a corresponding signature file). "),e("li",null," This detection method usually causes more false positives than signature-based detection. ")])])])])],-1),e("h3",{id:"device-implementation",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#device-implementation"},[e("span",null,"Device Implementation")])],-1),e("p",null,"An IDS/IPS can be implemented as a host-based or network-based device. The below table describes each implementation:",-1),e("table",null,[e("thead",null,[e("tr",null,[e("th",{class_:"firstTableHeader",scope:"col",class:"fw-bold"}," Implementation Method "),e("th",{scope:"col",class:"fw-bold"}," Description ")])]),e("tbody",null,[e("tr",null,[e("td",null," Host-based "),e("td",null,[t(" A "),e("i",{class:"fs-italicize"}," host-based "),t(" IDS (HIDS) is a program installed on the host system itself that monitors all traffic coming into the host. A host-based IDS: "),e("br"),e("ul",null,[e("li",null," Is used to detect attacks that are unique to the services and applications on that system. It can monitor application activity and modifications as well as local system files, logon audit files, and kernel audit files. "),e("li",null," Is typically unaware of other devices on the network but can be detected and could be the target of an attack itself. "),e("li",null," May rely on auditing and logging capabilities of the operating system. "),e("li",null," Can analyze encrypted traffic (because services running on the host decrypt the traffic) ")]),e("p",null," Antivirus software is the most common form of a host-based IDS "),e("p",null," One issue with host-based IDSs is that the software must be installed and configured on each system being protected. This can lead to excessive administrative effort. Also, if the host-system is compromised, the log reports on that system become unreliable because the attacker may have modified the log files. ")])]),e("tr",null,[e("td",null," Network-based "),e("td",null,[t(" A "),e("i",{class:"fs-italicize"}," network-based IDS "),t(" (NIDS) is a dedicated device installed on the network. It analyzes all traffic on the network in real time. There are two options when installing an NIDS: "),e("ul",null,[e("li",null,[t(" The first option is to install the NIDS out of band. This means it is installed outside the flow of traffic. "),e("ul",null,[e("li",null," The IDS is usually connected with a network tap, such as a switch. This allows it to monitor network traffic without being in the way. ")])]),e("li",null,[t(" The other option is to install the NIDS as an "),e("i",{class:"fs-italicize"}," inline "),t(" device. This means it is installed in the flow of traffic and all traffic goes through the NIDS. It is then analyzed and either allowed to continue on or is stopped. ")])]),e("p",null," Some other things to be aware of when implementing a NIDS are: "),e("ul",null,[e("li",null," An NIDS is typically unaware of individual hosts on the network. It cannot be detected by attacking systems. "),e("li",null," An NIDS is particularly well suited for detecting and blocking port scanning and DoS attacks. "),e("li",null," An NIDS is unable to analyze encrypted traffic "),e("li",null,[t(" An NIDS should be placed at all critical junctions within a network, including backbones and critical choke points, such as: "),e("ul",null,[e("li",null," Inside the DMZ "),e("li",null," Between the firewall and the internal LAN "),e("li",null," Near any critical information assets "),e("li",null,[t(" If using a switch on the network, the NIDS must be placed on a special port called a "),e("i",{class:"fs-italicize"}," spanning "),t(" or "),e("i",{class:"fs-italicize"}," diagnostic "),t(" port that directly connects to the backbone of the switch. This way, the NIDS can see all traffic on that segment. ")])])]),e("li",null," A control center should be set up to receive all IDS data. This is where all decision-making should take place in regards to NIDS communications. "),e("li",null," A application-aware NIDS can analyze network packets to detect malicious payloads targeted at Application layer services (such as a web server). ")])])])])],-1),n('<h2 id="_11-3-3-use-squil-and-squert" tabindex="-1"><a class="header-anchor" href="#_11-3-3-use-squil-and-squert"><span>11.3.3 Use Squil and Squert</span></a></h2><h3 id="squil-and-squert-00-00-00-10" tabindex="-1"><a class="header-anchor" href="#squil-and-squert-00-00-00-10"><span>Squil and Squert 00:00-00:10</span></a></h3><p>Security Onion provides two tools to manage and respond to alerts produced by Zeek and Snort. The first tool is called Sguil.</p><h3 id="squil-00-10-01-34" tabindex="-1"><a class="header-anchor" href="#squil-00-10-01-34"><span>Squil 00:10-01:34</span></a></h3><p>We access Sguil using the link on the Security Onion desktop. During the setup of Security Onion, you are asked to create a user for Sguil. We created a Security Operations Center (SOC) user that we will use in this example to login.</p><p>The next screen asks which network adapters we want Sguil to monitor. In this case, we choose both network adaptors. The enp0s8 is the Security Onion VM&#39;s network interface in our lab environment. It is set in promiscuous mode to listen to all packets.</p><p>Because it is in promiscuous mode it will process all packets that it sees, even if they are not addressed to the Security Onion VM. The Open Source HIDS SECurity interface (OSSEC) is used to monitor the VM itself through Wuzah which was formerly known as OSSEC.</p><p>Sguil organizes the events into groups it believes to be related events. For example, we can right-click the count (CNT) column or view the correlated events. This list opens in a new tab and shows the individual events.</p><p>In either the RealTime Events tab or the Event tab, notice that when we click Show packet data, the IP headers, TCP or UDP headers, and the packet data are dissected for review. If we want to see an event in more detail, we can right-click the alert ID and pivot to one of the other tools available.</p><h3 id="transcript-tool-01-34-02-02" tabindex="-1"><a class="header-anchor" href="#transcript-tool-01-34-02-02"><span>Transcript Tool 01:34-02:02</span></a></h3><p>The first of these tools is the Transcript tool. It provides a readable version of the packets in a plain text format. If we close the transcript window we can right-click again and choose the Packet analysis tool, Wireshark.</p><p>Similar to the view that we have in Sguil, Wireshark decodes the packet headers for deeper analysis. Wireshark also gives you the ability to see the packets in sequence to review timings of an attack, along with other information that the packets can provide a security analyst.</p><h3 id="networkminer-02-02-03-15" tabindex="-1"><a class="header-anchor" href="#networkminer-02-02-03-15"><span>NetworkMiner 02:02-03:15</span></a></h3><p>The last pivot from Sguil that we want to look at is NetworkMiner. NetworkMiner decodes the packet captures at a higher level than Wireshark. You see here that information about the hosts involved, as well as any files that were transferred unencrypted. For example, if we click the Escalated events tab, we can use NetworkMiner to look at an event that we escalated earlier.</p><p>We can expand the information about the host 172.28.24.5, which is the victim. One detail that it shows is that the host is running Apache version 2.4.41 on Ubuntu Linux. This information is gathered by NetworkMiner looking at the banner information sent by the server in the packets.</p><p>Next, we can click on the Files tab to look at the files that NetworkMiner found in the packets. In this case, it found an HTML file that was transferred to our attacker. Like Sguil, right-clicking gives you ways to pivot using this file.</p><p>You may want to calculate the file hash to be able to compare it with known bad files through tools like Virus Total. You will especially want to do this with executable files. If you believe the file is safe to open, you can choose to open the file or open the folder where it is stored for examination. In this case, the file is a standard Apache Not Found error page.</p><h3 id="squert-03-15-04-41" tabindex="-1"><a class="header-anchor" href="#squert-03-15-04-41"><span>Squert 03:15-04:41</span></a></h3><p>Squert is the web-based equivalent to Sguil. It is found inside of Kibana which can be opened from the Security Onion desktop. You may have to accept the risk of the self-signed TLS certificate to proceed. Like Sguil you will need to use the account you created during the Security Onion setup. In this case, it is the SOC user. You can open Squert by clicking it in the left navigation bar.</p><p>Depending on when the event that you are looking for occurred, you may need to change the time interval from the default. We&#39;ll change it to look at data from yesterday, when we think an attack occurred.</p><p>Clicking on certain fields gives you multiple options to search the text in various web tools. Clicking the left-most column of an event gives you more information about the signature that matched for the traffic. We&#39;ll click the signature name and choose the option ::Signature so that we filter only by that signature.</p><p>On the left side, we&#39;ll click Grouping to turn it off and click refresh to see all the events with that signature.</p><p>This view looks very similar to what we saw in Sguil. Left-clicking the ID for an event takes us to a web-based packet analysis tool called capME! The result is similar to the transcript feature of Sguil.</p><p>You can also click the link to the raw PCAP file to open the capture in Wireshark.</p><p>Likewise, if you go to Applications &gt; Other and then NetworkMiner, you can open the PCAP file in NetworkMiner.</p><h3 id="summary-04-41-04-51" tabindex="-1"><a class="header-anchor" href="#summary-04-41-04-51"><span>Summary 04:41-04:51</span></a></h3><p>That&#39;s it for this demo. In this demo we used two tools, Squil and Sqert to view alerts.</p><h2 id="_11-3-4-implement-intrusion-detection-and-prevention" tabindex="-1"><a class="header-anchor" href="#_11-3-4-implement-intrusion-detection-and-prevention"><span>11.3.4 Implement Intrusion Detection and Prevention</span></a></h2><h3 id="implement-intrusion-detection-and-prevention-00-00-00-17" tabindex="-1"><a class="header-anchor" href="#implement-intrusion-detection-and-prevention-00-00-00-17"><span>Implement Intrusion Detection and Prevention 00:00-00:17</span></a></h3><p>Intrusion detection and prevention is an important task that is required to protect todays networks. In this demonstration, we&#39;ll configured intrusion detection and prevention using Snort on a pfSense security appliance.</p><h3 id="choose-an-intrusion-detection-and-prevention-product-00-17-01-30" tabindex="-1"><a class="header-anchor" href="#choose-an-intrusion-detection-and-prevention-product-00-17-01-30"><span>Choose an Intrusion Detection and Prevention Product 00:17-01:30</span></a></h3><p>There are several products available that can do both intrusion detection and intrusion prevention. Some cost money and some are free.</p><p>One of the most popular products is Snort. Snort is a free, open source network intrusion detection system (IDS) and intrusion prevention system (IPS).</p><p>Although Snort is open source and free, it does have some paid plans that you can subscribe to and receive updates to rules faster. In this demo, we&#39;ll configure Snort on our pfSense security appliance.</p><p>Before we configure Snort, let&#39;s quickly look at the website. As we scroll down, you see that you can manually download Snort for various operating systems and distributions. Snort is available for Fedora, Centos, FreeBSD and Windows.</p><p>In the second step, you must get what is called an Oinkcode. We will do that in a minute but let&#39;s keep scrolling down this page. Step 3 is to get updates. We&#39;ll cover that later in the demo.</p><p>Now as a review what we just talked about, Snort is an open source intrusion prevention system capable of real-time traffic analysis and packet logging.</p><p>Snort is the most widely deployed IPS in the world. There have been over 5 million downloads and over 600 thousand registered users.</p><h3 id="install-snort-01-30-02-27" tabindex="-1"><a class="header-anchor" href="#install-snort-01-30-02-27"><span>Install Snort 01:30-02:27</span></a></h3><p>To use Snort, you must first get an Oinkcode. We&#39;ll go to our account. Here is a link that says Oinkcode. We already have a code generated, so we can proceed. We will use the Oinkcode later.</p><p>Now let&#39;s go to pfSense and install Snort.</p><p>We&#39;ve already logged into pfSense and we&#39;re on the Dashboard. Installing Snort on pfSense is quite easy. It is done with the Package Manager that is located under the System tab. Once on the Package Manager page, you click Available Packages.</p><p>Now let&#39;s do a search for ‘Snort&#39;. We have one result, so we&#39;ll come down and click the Install link. Now you can make sure you have the right package. We do; so let&#39;s click Confirm to start the installation.</p><p>Now we wait for a few minutes while Snort is installed. When it does, the color changes from red to green and it says that the installation successfully completed. Down here on the bottom, a message says &quot;Success&quot;.</p><h3 id="configure-snort-02-27-05-10" tabindex="-1"><a class="header-anchor" href="#configure-snort-02-27-05-10"><span>Configure Snort 02:27-05:10</span></a></h3><p>Now that Snort is installed, we need to set it up. Let&#39;s do that by going to Services and then down to Snort. Be aware that this menu item for Snort was not there until we installed it. If you don&#39;t have this menu, Snort probably is not installed.</p><p>We will start by going to Global Settings. Under Snort Subscriber Rules, we check the Enable Snort VRT box. VRT is an acronym for Vulnerability Research Team.</p><p>Below that, next to Snort Oinkmaster Code, we paste in the code. Remember, we got the Oinkcode from the Snort website that we were at in the beginning of the demo. We copied the code to the clipboard and will use a keyboard shortcut to paste it in here.</p><p>Next, we Enable Snort GPLv2. The Community Snort Rules fall under the GNU General Public License Version 2, which encourages the development and distribution of open source software. This ruleset is 30 days behind the Snort Subscriber Rule Set. It does not contain zero-day threats under the limited provision of the Snort Subscriber Rule Set License.</p><p>Now let&#39;s check Enable ET Open (ET is the acronym for Emerging Threats). This downloads the Emerging Threats Open rules. The ET Open Ruleset is an anti-malware IDS/IPS ruleset that enables users with cost constraints to enhance their existing network-based malware detection.</p><p>We do not pay for the Emerging Threat Pro rules, so we won&#39;t check that box.</p><p>Let&#39;s skip down here under Sourcefire OpenAppID Detectors. Let&#39;s check the Enable OpenAppID box. Below that, check the box next to Enable RULES Open AppID. OpenAppID is an application-focused detection language and processing module for Snort. When you use OpenAppID with pfSense, the system can successfully detect (if configured to do so) and block over 2600 different services like Facebook, Netflix, Twitter, and Reddit.</p><p>For our Rules Update Settings, we set the Update Interval to 1 Day. For our Update time, we set it to 2:00 AM. Let&#39;s check the Hide Deprecated Rules Categories box. This removes old and outdated rules.</p><p>Under General Settings &gt; Remove Blocked hosts Interval, we change that to 1 Hour. Now you might think that we should block hosts forever if they are malicious, but the problem is that often these are coming from spoofed IP addresses or from addresses that may be used by legitimate users very soon. So, we will block only for 1 hour.</p><p>We&#39;ll check the box for Startup/Shutdown Logging. We want to know who and when Snort is being started and stopped by.</p><p>That wraps up everything for this page. We&#39;ll click Save.</p><p>Assign Rules to Wide Area Network (WAN) Interface 05:10-06:05 Now that we have the rules figured out, we need to assign these rules to the WAN interface. We&#39;ll go to the Snort Interfaces tab. Then come down here to the right and click the Add link.</p><p>Under General Settings, we want to make sure that Enable Interface is checked. We see that it is. Make sure you have WAN selected under Interface. This is the traffic we want to inspect. For Description, we enter WAN. We want to keep it obvious and simple here.</p><p>Under Alert Settings, we check the box to Send Alerts to System Log. This will send alerts to the firewall log.</p><p>We check the Block Offenders box. If an offender creates a Snort alert, they will be blocked. For the IP to Block, we block the Source IP address.</p><p>There is nothing more we want to do here. We&#39;ll come down and click Save.</p><p>Now we want to check the box to enable the WAN interface. Under Snort Status, click Runto start Snort.</p><h3 id="summary-06-05-06-18" tabindex="-1"><a class="header-anchor" href="#summary-06-05-06-18"><span>Summary 06:05-06:18</span></a></h3><p>That&#39;s it for this demo. In this demo we configured intrusion detection and prevention using Snort on our pfSense security appliance.</p>',64)]))}const h=a(l,[["render",r],["__file","11.03.IntrusionDetection.html.vue"]]),u=JSON.parse('{"path":"/11/11.03.IntrusionDetection.html","title":"Section 11.3 Intrusion Detection","lang":"zh-CN","frontmatter":{"lang":"zh-CN","title":"Section 11.3 Intrusion Detection","description":"some description"},"headers":[{"level":2,"title":"11.3.1 Intrusion Detection","slug":"_11-3-1-intrusion-detection","link":"#_11-3-1-intrusion-detection","children":[{"level":3,"title":"Intrusion Detection 00:00-00:24","slug":"intrusion-detection-00-00-00-24","link":"#intrusion-detection-00-00-00-24","children":[]},{"level":3,"title":"Intrusion Detection and Intrusion Prevention Systems 00:24-00:32","slug":"intrusion-detection-and-intrusion-prevention-systems-00-24-00-32","link":"#intrusion-detection-and-intrusion-prevention-systems-00-24-00-32","children":[]},{"level":3,"title":"Intrusion Detection System (IDS) 00:32-00:49","slug":"intrusion-detection-system-ids-00-32-00-49","link":"#intrusion-detection-system-ids-00-32-00-49","children":[]},{"level":3,"title":"Intrusion Prevention System (IPS) 00:49-01:35","slug":"intrusion-prevention-system-ips-00-49-01-35","link":"#intrusion-prevention-system-ips-00-49-01-35","children":[]},{"level":3,"title":"Detection Methods 01:35-02:42","slug":"detection-methods-01-35-02-42","link":"#detection-methods-01-35-02-42","children":[]},{"level":3,"title":"IDS/IPS Implementation 02:42-03:38","slug":"ids-ips-implementation-02-42-03-38","link":"#ids-ips-implementation-02-42-03-38","children":[]},{"level":3,"title":"Out-of-Band 03:38-03:55","slug":"out-of-band-03-38-03-55","link":"#out-of-band-03-38-03-55","children":[]},{"level":3,"title":"Inline 03:55-04:21","slug":"inline-03-55-04-21","link":"#inline-03-55-04-21","children":[]},{"level":3,"title":"Summary 04:21-04:57","slug":"summary-04-21-04-57","link":"#summary-04-21-04-57","children":[]}]},{"level":2,"title":"11.3.2 IDS Facts","slug":"_11-3-2-ids-facts","link":"#_11-3-2-ids-facts","children":[{"level":3,"title":"Differences between IDSs and IPSs","slug":"differences-between-idss-and-ipss","link":"#differences-between-idss-and-ipss","children":[]},{"level":3,"title":"Detection Methods","slug":"detection-methods","link":"#detection-methods","children":[]},{"level":3,"title":"Device Implementation","slug":"device-implementation","link":"#device-implementation","children":[]}]},{"level":2,"title":"11.3.3 Use Squil and Squert","slug":"_11-3-3-use-squil-and-squert","link":"#_11-3-3-use-squil-and-squert","children":[{"level":3,"title":"Squil and Squert 00:00-00:10","slug":"squil-and-squert-00-00-00-10","link":"#squil-and-squert-00-00-00-10","children":[]},{"level":3,"title":"Squil 00:10-01:34","slug":"squil-00-10-01-34","link":"#squil-00-10-01-34","children":[]},{"level":3,"title":"Transcript Tool 01:34-02:02","slug":"transcript-tool-01-34-02-02","link":"#transcript-tool-01-34-02-02","children":[]},{"level":3,"title":"NetworkMiner 02:02-03:15","slug":"networkminer-02-02-03-15","link":"#networkminer-02-02-03-15","children":[]},{"level":3,"title":"Squert 03:15-04:41","slug":"squert-03-15-04-41","link":"#squert-03-15-04-41","children":[]},{"level":3,"title":"Summary 04:41-04:51","slug":"summary-04-41-04-51","link":"#summary-04-41-04-51","children":[]}]},{"level":2,"title":"11.3.4 Implement Intrusion Detection and Prevention","slug":"_11-3-4-implement-intrusion-detection-and-prevention","link":"#_11-3-4-implement-intrusion-detection-and-prevention","children":[{"level":3,"title":"Implement Intrusion Detection and Prevention 00:00-00:17","slug":"implement-intrusion-detection-and-prevention-00-00-00-17","link":"#implement-intrusion-detection-and-prevention-00-00-00-17","children":[]},{"level":3,"title":"Choose an Intrusion Detection and Prevention Product 00:17-01:30","slug":"choose-an-intrusion-detection-and-prevention-product-00-17-01-30","link":"#choose-an-intrusion-detection-and-prevention-product-00-17-01-30","children":[]},{"level":3,"title":"Install Snort 01:30-02:27","slug":"install-snort-01-30-02-27","link":"#install-snort-01-30-02-27","children":[]},{"level":3,"title":"Configure Snort 02:27-05:10","slug":"configure-snort-02-27-05-10","link":"#configure-snort-02-27-05-10","children":[]},{"level":3,"title":"Summary 06:05-06:18","slug":"summary-06-05-06-18","link":"#summary-06-05-06-18","children":[]}]}],"git":{"updatedTime":1736231937000},"filePathRelative":"11/11.03.IntrusionDetection.md"}');export{h as comp,u as data};
